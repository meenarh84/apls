function wS(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in n)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function ES(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function TS(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var nx={exports:{}},su={},ix={exports:{}},ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ba=Symbol.for("react.element"),IS=Symbol.for("react.portal"),SS=Symbol.for("react.fragment"),AS=Symbol.for("react.strict_mode"),bS=Symbol.for("react.profiler"),CS=Symbol.for("react.provider"),kS=Symbol.for("react.context"),PS=Symbol.for("react.forward_ref"),RS=Symbol.for("react.suspense"),DS=Symbol.for("react.memo"),NS=Symbol.for("react.lazy"),Wg=Symbol.iterator;function VS(n){return n===null||typeof n!="object"?null:(n=Wg&&n[Wg]||n["@@iterator"],typeof n=="function"?n:null)}var rx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sx=Object.assign,ox={};function zs(n,e,t){this.props=n,this.context=e,this.refs=ox,this.updater=t||rx}zs.prototype.isReactComponent={};zs.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};zs.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function ax(){}ax.prototype=zs.prototype;function Bp(n,e,t){this.props=n,this.context=e,this.refs=ox,this.updater=t||rx}var Up=Bp.prototype=new ax;Up.constructor=Bp;sx(Up,zs.prototype);Up.isPureReactComponent=!0;var Xg=Array.isArray,lx=Object.prototype.hasOwnProperty,zp={current:null},cx={key:!0,ref:!0,__self:!0,__source:!0};function ux(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)lx.call(e,i)&&!cx.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Ba,type:n,key:s,ref:o,props:r,_owner:zp.current}}function MS(n,e){return{$$typeof:Ba,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function $p(n){return typeof n=="object"&&n!==null&&n.$$typeof===Ba}function OS(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Yg=/\/+/g;function xh(n,e){return typeof n=="object"&&n!==null&&n.key!=null?OS(""+n.key):e.toString(36)}function Hl(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Ba:case IS:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+xh(o,0):i,Xg(r)?(t="",n!=null&&(t=n.replace(Yg,"$&/")+"/"),Hl(r,e,t,"",function(u){return u})):r!=null&&($p(r)&&(r=MS(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Yg,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",Xg(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+xh(s,a);o+=Hl(s,e,t,l,r)}else if(l=VS(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+xh(s,a++),o+=Hl(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function El(n,e,t){if(n==null)return n;var i=[],r=0;return Hl(n,i,"","",function(s){return e.call(t,s,r++)}),i}function LS(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var wt={current:null},Gl={transition:null},FS={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:Gl,ReactCurrentOwner:zp};function hx(){throw Error("act(...) is not supported in production builds of React.")}ne.Children={map:El,forEach:function(n,e,t){El(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return El(n,function(){e++}),e},toArray:function(n){return El(n,function(e){return e})||[]},only:function(n){if(!$p(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ne.Component=zs;ne.Fragment=SS;ne.Profiler=bS;ne.PureComponent=Bp;ne.StrictMode=AS;ne.Suspense=RS;ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FS;ne.act=hx;ne.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=sx({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=zp.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)lx.call(e,l)&&!cx.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:Ba,type:n.type,key:r,ref:s,props:i,_owner:o}};ne.createContext=function(n){return n={$$typeof:kS,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:CS,_context:n},n.Consumer=n};ne.createElement=ux;ne.createFactory=function(n){var e=ux.bind(null,n);return e.type=n,e};ne.createRef=function(){return{current:null}};ne.forwardRef=function(n){return{$$typeof:PS,render:n}};ne.isValidElement=$p;ne.lazy=function(n){return{$$typeof:NS,_payload:{_status:-1,_result:n},_init:LS}};ne.memo=function(n,e){return{$$typeof:DS,type:n,compare:e===void 0?null:e}};ne.startTransition=function(n){var e=Gl.transition;Gl.transition={};try{n()}finally{Gl.transition=e}};ne.unstable_act=hx;ne.useCallback=function(n,e){return wt.current.useCallback(n,e)};ne.useContext=function(n){return wt.current.useContext(n)};ne.useDebugValue=function(){};ne.useDeferredValue=function(n){return wt.current.useDeferredValue(n)};ne.useEffect=function(n,e){return wt.current.useEffect(n,e)};ne.useId=function(){return wt.current.useId()};ne.useImperativeHandle=function(n,e,t){return wt.current.useImperativeHandle(n,e,t)};ne.useInsertionEffect=function(n,e){return wt.current.useInsertionEffect(n,e)};ne.useLayoutEffect=function(n,e){return wt.current.useLayoutEffect(n,e)};ne.useMemo=function(n,e){return wt.current.useMemo(n,e)};ne.useReducer=function(n,e,t){return wt.current.useReducer(n,e,t)};ne.useRef=function(n){return wt.current.useRef(n)};ne.useState=function(n){return wt.current.useState(n)};ne.useSyncExternalStore=function(n,e,t){return wt.current.useSyncExternalStore(n,e,t)};ne.useTransition=function(){return wt.current.useTransition()};ne.version="18.3.1";ix.exports=ne;var $=ix.exports;const dx=ES($),jS=wS({__proto__:null,default:dx},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BS=$,US=Symbol.for("react.element"),zS=Symbol.for("react.fragment"),$S=Object.prototype.hasOwnProperty,qS=BS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HS={key:!0,ref:!0,__self:!0,__source:!0};function px(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)$S.call(e,i)&&!HS.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:US,type:n,key:s,ref:o,props:r,_owner:qS.current}}su.Fragment=zS;su.jsx=px;su.jsxs=px;nx.exports=su;var F=nx.exports,dd={},fx={exports:{}},jt={},mx={exports:{}},gx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(G,J){var te=G.length;G.push(J);e:for(;0<te;){var Se=te-1>>>1,pe=G[Se];if(0<r(pe,J))G[Se]=J,G[te]=pe,te=Se;else break e}}function t(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var J=G[0],te=G.pop();if(te!==J){G[0]=te;e:for(var Se=0,pe=G.length,Ve=pe>>>1;Se<Ve;){var En=2*(Se+1)-1,Tn=G[En],In=En+1,Sn=G[In];if(0>r(Tn,te))In<pe&&0>r(Sn,Tn)?(G[Se]=Sn,G[In]=te,Se=In):(G[Se]=Tn,G[En]=te,Se=En);else if(In<pe&&0>r(Sn,te))G[Se]=Sn,G[In]=te,Se=In;else break e}}return J}function r(G,J){var te=G.sortIndex-J.sortIndex;return te!==0?te:G.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,f=3,v=!1,I=!1,b=!1,T=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(G){for(var J=t(u);J!==null;){if(J.callback===null)i(u);else if(J.startTime<=G)i(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=t(u)}}function k(G){if(b=!1,w(G),!I)if(t(l)!==null)I=!0,Zs(N);else{var J=t(u);J!==null&&wn(k,J.startTime-G)}}function N(G,J){I=!1,b&&(b=!1,y(x),x=-1),v=!0;var te=f;try{for(w(J),p=t(l);p!==null&&(!(p.expirationTime>J)||G&&!P());){var Se=p.callback;if(typeof Se=="function"){p.callback=null,f=p.priorityLevel;var pe=Se(p.expirationTime<=J);J=n.unstable_now(),typeof pe=="function"?p.callback=pe:p===t(l)&&i(l),w(J)}else i(l);p=t(l)}if(p!==null)var Ve=!0;else{var En=t(u);En!==null&&wn(k,En.startTime-J),Ve=!1}return Ve}finally{p=null,f=te,v=!1}}var M=!1,E=null,x=-1,S=5,A=-1;function P(){return!(n.unstable_now()-A<S)}function R(){if(E!==null){var G=n.unstable_now();A=G;var J=!0;try{J=E(!0,G)}finally{J?C():(M=!1,E=null)}}else M=!1}var C;if(typeof g=="function")C=function(){g(R)};else if(typeof MessageChannel<"u"){var Ut=new MessageChannel,Ui=Ut.port2;Ut.port1.onmessage=R,C=function(){Ui.postMessage(null)}}else C=function(){T(R,0)};function Zs(G){E=G,M||(M=!0,C())}function wn(G,J){x=T(function(){G(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){I||v||(I=!0,Zs(N))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(f){case 1:case 2:case 3:var J=3;break;default:J=f}var te=f;f=J;try{return G()}finally{f=te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var te=f;f=G;try{return J()}finally{f=te}},n.unstable_scheduleCallback=function(G,J,te){var Se=n.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Se+te:Se):te=Se,G){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=te+pe,G={id:h++,callback:J,priorityLevel:G,startTime:te,expirationTime:pe,sortIndex:-1},te>Se?(G.sortIndex=te,e(u,G),t(l)===null&&G===t(u)&&(b?(y(x),x=-1):b=!0,wn(k,te-Se))):(G.sortIndex=pe,e(l,G),I||v||(I=!0,Zs(N))),G},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(G){var J=f;return function(){var te=f;f=J;try{return G.apply(this,arguments)}finally{f=te}}}})(gx);mx.exports=gx;var GS=mx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KS=$,Lt=GS;function U(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vx=new Set,ra={};function Ar(n,e){_s(n,e),_s(n+"Capture",e)}function _s(n,e){for(ra[n]=e,n=0;n<e.length;n++)vx.add(e[n])}var On=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pd=Object.prototype.hasOwnProperty,QS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jg={},Zg={};function WS(n){return pd.call(Zg,n)?!0:pd.call(Jg,n)?!1:QS.test(n)?Zg[n]=!0:(Jg[n]=!0,!1)}function XS(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function YS(n,e,t,i){if(e===null||typeof e>"u"||XS(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){it[n]=new Et(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];it[e]=new Et(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){it[n]=new Et(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){it[n]=new Et(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){it[n]=new Et(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){it[n]=new Et(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){it[n]=new Et(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){it[n]=new Et(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){it[n]=new Et(n,5,!1,n.toLowerCase(),null,!1,!1)});var qp=/[\-:]([a-z])/g;function Hp(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(qp,Hp);it[e]=new Et(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(qp,Hp);it[e]=new Et(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(qp,Hp);it[e]=new Et(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){it[n]=new Et(n,1,!1,n.toLowerCase(),null,!1,!1)});it.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){it[n]=new Et(n,1,!1,n.toLowerCase(),null,!0,!0)});function Gp(n,e,t,i){var r=it.hasOwnProperty(e)?it[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YS(e,t,r,i)&&(t=null),i||r===null?WS(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var zn=KS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tl=Symbol.for("react.element"),Jr=Symbol.for("react.portal"),Zr=Symbol.for("react.fragment"),Kp=Symbol.for("react.strict_mode"),fd=Symbol.for("react.profiler"),yx=Symbol.for("react.provider"),_x=Symbol.for("react.context"),Qp=Symbol.for("react.forward_ref"),md=Symbol.for("react.suspense"),gd=Symbol.for("react.suspense_list"),Wp=Symbol.for("react.memo"),Zn=Symbol.for("react.lazy"),xx=Symbol.for("react.offscreen"),ev=Symbol.iterator;function mo(n){return n===null||typeof n!="object"?null:(n=ev&&n[ev]||n["@@iterator"],typeof n=="function"?n:null)}var ke=Object.assign,wh;function Do(n){if(wh===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);wh=e&&e[1]||""}return`
`+wh+n}var Eh=!1;function Th(n,e){if(!n||Eh)return"";Eh=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Eh=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Do(n):""}function JS(n){switch(n.tag){case 5:return Do(n.type);case 16:return Do("Lazy");case 13:return Do("Suspense");case 19:return Do("SuspenseList");case 0:case 2:case 15:return n=Th(n.type,!1),n;case 11:return n=Th(n.type.render,!1),n;case 1:return n=Th(n.type,!0),n;default:return""}}function vd(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Zr:return"Fragment";case Jr:return"Portal";case fd:return"Profiler";case Kp:return"StrictMode";case md:return"Suspense";case gd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case _x:return(n.displayName||"Context")+".Consumer";case yx:return(n._context.displayName||"Context")+".Provider";case Qp:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Wp:return e=n.displayName||null,e!==null?e:vd(n.type)||"Memo";case Zn:e=n._payload,n=n._init;try{return vd(n(e))}catch{}}return null}function ZS(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vd(e);case 8:return e===Kp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wi(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function wx(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function e1(n){var e=wx(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Il(n){n._valueTracker||(n._valueTracker=e1(n))}function Ex(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=wx(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function mc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function yd(n,e){var t=e.checked;return ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function tv(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=wi(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tx(n,e){e=e.checked,e!=null&&Gp(n,"checked",e,!1)}function _d(n,e){Tx(n,e);var t=wi(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?xd(n,e.type,t):e.hasOwnProperty("defaultValue")&&xd(n,e.type,wi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function nv(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function xd(n,e,t){(e!=="number"||mc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var No=Array.isArray;function us(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+wi(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function wd(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return ke({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function iv(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(U(92));if(No(t)){if(1<t.length)throw Error(U(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:wi(t)}}function Ix(n,e){var t=wi(e.value),i=wi(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function rv(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Sx(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ed(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Sx(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Sl,Ax=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sl.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function sa(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},t1=["Webkit","ms","Moz","O"];Object.keys(zo).forEach(function(n){t1.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),zo[e]=zo[n]})});function bx(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||zo.hasOwnProperty(n)&&zo[n]?(""+e).trim():e+"px"}function Cx(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=bx(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var n1=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Td(n,e){if(e){if(n1[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Id(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sd=null;function Xp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ad=null,hs=null,ds=null;function sv(n){if(n=$a(n)){if(typeof Ad!="function")throw Error(U(280));var e=n.stateNode;e&&(e=uu(e),Ad(n.stateNode,n.type,e))}}function kx(n){hs?ds?ds.push(n):ds=[n]:hs=n}function Px(){if(hs){var n=hs,e=ds;if(ds=hs=null,sv(n),e)for(n=0;n<e.length;n++)sv(e[n])}}function Rx(n,e){return n(e)}function Dx(){}var Ih=!1;function Nx(n,e,t){if(Ih)return n(e,t);Ih=!0;try{return Rx(n,e,t)}finally{Ih=!1,(hs!==null||ds!==null)&&(Dx(),Px())}}function oa(n,e){var t=n.stateNode;if(t===null)return null;var i=uu(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(U(231,e,typeof t));return t}var bd=!1;if(On)try{var go={};Object.defineProperty(go,"passive",{get:function(){bd=!0}}),window.addEventListener("test",go,go),window.removeEventListener("test",go,go)}catch{bd=!1}function i1(n,e,t,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var $o=!1,gc=null,vc=!1,Cd=null,r1={onError:function(n){$o=!0,gc=n}};function s1(n,e,t,i,r,s,o,a,l){$o=!1,gc=null,i1.apply(r1,arguments)}function o1(n,e,t,i,r,s,o,a,l){if(s1.apply(this,arguments),$o){if($o){var u=gc;$o=!1,gc=null}else throw Error(U(198));vc||(vc=!0,Cd=u)}}function br(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Vx(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function ov(n){if(br(n)!==n)throw Error(U(188))}function a1(n){var e=n.alternate;if(!e){if(e=br(n),e===null)throw Error(U(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return ov(r),n;if(s===i)return ov(r),e;s=s.sibling}throw Error(U(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(U(189))}}if(t.alternate!==i)throw Error(U(190))}if(t.tag!==3)throw Error(U(188));return t.stateNode.current===t?n:e}function Mx(n){return n=a1(n),n!==null?Ox(n):null}function Ox(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Ox(n);if(e!==null)return e;n=n.sibling}return null}var Lx=Lt.unstable_scheduleCallback,av=Lt.unstable_cancelCallback,l1=Lt.unstable_shouldYield,c1=Lt.unstable_requestPaint,Me=Lt.unstable_now,u1=Lt.unstable_getCurrentPriorityLevel,Yp=Lt.unstable_ImmediatePriority,Fx=Lt.unstable_UserBlockingPriority,yc=Lt.unstable_NormalPriority,h1=Lt.unstable_LowPriority,jx=Lt.unstable_IdlePriority,ou=null,fn=null;function d1(n){if(fn&&typeof fn.onCommitFiberRoot=="function")try{fn.onCommitFiberRoot(ou,n,void 0,(n.current.flags&128)===128)}catch{}}var nn=Math.clz32?Math.clz32:m1,p1=Math.log,f1=Math.LN2;function m1(n){return n>>>=0,n===0?32:31-(p1(n)/f1|0)|0}var Al=64,bl=4194304;function Vo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function _c(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=Vo(a):(s&=o,s!==0&&(i=Vo(s)))}else o=t&~r,o!==0?i=Vo(o):s!==0&&(i=Vo(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-nn(e),r=1<<t,i|=n[t],e&=~r;return i}function g1(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v1(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-nn(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=g1(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function kd(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Bx(){var n=Al;return Al<<=1,!(Al&4194240)&&(Al=64),n}function Sh(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ua(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-nn(e),n[e]=t}function y1(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-nn(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function Jp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-nn(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var he=0;function Ux(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var zx,Zp,$x,qx,Hx,Pd=!1,Cl=[],ui=null,hi=null,di=null,aa=new Map,la=new Map,ni=[],_1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lv(n,e){switch(n){case"focusin":case"focusout":ui=null;break;case"dragenter":case"dragleave":hi=null;break;case"mouseover":case"mouseout":di=null;break;case"pointerover":case"pointerout":aa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":la.delete(e.pointerId)}}function vo(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=$a(e),e!==null&&Zp(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function x1(n,e,t,i,r){switch(e){case"focusin":return ui=vo(ui,n,e,t,i,r),!0;case"dragenter":return hi=vo(hi,n,e,t,i,r),!0;case"mouseover":return di=vo(di,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return aa.set(s,vo(aa.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,la.set(s,vo(la.get(s)||null,n,e,t,i,r)),!0}return!1}function Gx(n){var e=nr(n.target);if(e!==null){var t=br(e);if(t!==null){if(e=t.tag,e===13){if(e=Vx(t),e!==null){n.blockedOn=e,Hx(n.priority,function(){$x(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Kl(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Rd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Sd=i,t.target.dispatchEvent(i),Sd=null}else return e=$a(t),e!==null&&Zp(e),n.blockedOn=t,!1;e.shift()}return!0}function cv(n,e,t){Kl(n)&&t.delete(e)}function w1(){Pd=!1,ui!==null&&Kl(ui)&&(ui=null),hi!==null&&Kl(hi)&&(hi=null),di!==null&&Kl(di)&&(di=null),aa.forEach(cv),la.forEach(cv)}function yo(n,e){n.blockedOn===e&&(n.blockedOn=null,Pd||(Pd=!0,Lt.unstable_scheduleCallback(Lt.unstable_NormalPriority,w1)))}function ca(n){function e(r){return yo(r,n)}if(0<Cl.length){yo(Cl[0],n);for(var t=1;t<Cl.length;t++){var i=Cl[t];i.blockedOn===n&&(i.blockedOn=null)}}for(ui!==null&&yo(ui,n),hi!==null&&yo(hi,n),di!==null&&yo(di,n),aa.forEach(e),la.forEach(e),t=0;t<ni.length;t++)i=ni[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<ni.length&&(t=ni[0],t.blockedOn===null);)Gx(t),t.blockedOn===null&&ni.shift()}var ps=zn.ReactCurrentBatchConfig,xc=!0;function E1(n,e,t,i){var r=he,s=ps.transition;ps.transition=null;try{he=1,ef(n,e,t,i)}finally{he=r,ps.transition=s}}function T1(n,e,t,i){var r=he,s=ps.transition;ps.transition=null;try{he=4,ef(n,e,t,i)}finally{he=r,ps.transition=s}}function ef(n,e,t,i){if(xc){var r=Rd(n,e,t,i);if(r===null)Mh(n,e,i,wc,t),lv(n,i);else if(x1(r,n,e,t,i))i.stopPropagation();else if(lv(n,i),e&4&&-1<_1.indexOf(n)){for(;r!==null;){var s=$a(r);if(s!==null&&zx(s),s=Rd(n,e,t,i),s===null&&Mh(n,e,i,wc,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else Mh(n,e,i,null,t)}}var wc=null;function Rd(n,e,t,i){if(wc=null,n=Xp(i),n=nr(n),n!==null)if(e=br(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Vx(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return wc=n,null}function Kx(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(u1()){case Yp:return 1;case Fx:return 4;case yc:case h1:return 16;case jx:return 536870912;default:return 16}default:return 16}}var oi=null,tf=null,Ql=null;function Qx(){if(Ql)return Ql;var n,e=tf,t=e.length,i,r="value"in oi?oi.value:oi.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Ql=r.slice(n,1<i?1-i:void 0)}function Wl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function kl(){return!0}function uv(){return!1}function Bt(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?kl:uv,this.isPropagationStopped=uv,this}return ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=kl)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=kl)},persist:function(){},isPersistent:kl}),e}var $s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nf=Bt($s),za=ke({},$s,{view:0,detail:0}),I1=Bt(za),Ah,bh,_o,au=ke({},za,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==_o&&(_o&&n.type==="mousemove"?(Ah=n.screenX-_o.screenX,bh=n.screenY-_o.screenY):bh=Ah=0,_o=n),Ah)},movementY:function(n){return"movementY"in n?n.movementY:bh}}),hv=Bt(au),S1=ke({},au,{dataTransfer:0}),A1=Bt(S1),b1=ke({},za,{relatedTarget:0}),Ch=Bt(b1),C1=ke({},$s,{animationName:0,elapsedTime:0,pseudoElement:0}),k1=Bt(C1),P1=ke({},$s,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),R1=Bt(P1),D1=ke({},$s,{data:0}),dv=Bt(D1),N1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},M1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O1(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=M1[n])?!!e[n]:!1}function rf(){return O1}var L1=ke({},za,{key:function(n){if(n.key){var e=N1[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Wl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?V1[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rf,charCode:function(n){return n.type==="keypress"?Wl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Wl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),F1=Bt(L1),j1=ke({},au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pv=Bt(j1),B1=ke({},za,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rf}),U1=Bt(B1),z1=ke({},$s,{propertyName:0,elapsedTime:0,pseudoElement:0}),$1=Bt(z1),q1=ke({},au,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),H1=Bt(q1),G1=[9,13,27,32],sf=On&&"CompositionEvent"in window,qo=null;On&&"documentMode"in document&&(qo=document.documentMode);var K1=On&&"TextEvent"in window&&!qo,Wx=On&&(!sf||qo&&8<qo&&11>=qo),fv=" ",mv=!1;function Xx(n,e){switch(n){case"keyup":return G1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yx(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var es=!1;function Q1(n,e){switch(n){case"compositionend":return Yx(e);case"keypress":return e.which!==32?null:(mv=!0,fv);case"textInput":return n=e.data,n===fv&&mv?null:n;default:return null}}function W1(n,e){if(es)return n==="compositionend"||!sf&&Xx(n,e)?(n=Qx(),Ql=tf=oi=null,es=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Wx&&e.locale!=="ko"?null:e.data;default:return null}}var X1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!X1[n.type]:e==="textarea"}function Jx(n,e,t,i){kx(i),e=Ec(e,"onChange"),0<e.length&&(t=new nf("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var Ho=null,ua=null;function Y1(n){cw(n,0)}function lu(n){var e=is(n);if(Ex(e))return n}function J1(n,e){if(n==="change")return e}var Zx=!1;if(On){var kh;if(On){var Ph="oninput"in document;if(!Ph){var vv=document.createElement("div");vv.setAttribute("oninput","return;"),Ph=typeof vv.oninput=="function"}kh=Ph}else kh=!1;Zx=kh&&(!document.documentMode||9<document.documentMode)}function yv(){Ho&&(Ho.detachEvent("onpropertychange",ew),ua=Ho=null)}function ew(n){if(n.propertyName==="value"&&lu(ua)){var e=[];Jx(e,ua,n,Xp(n)),Nx(Y1,e)}}function Z1(n,e,t){n==="focusin"?(yv(),Ho=e,ua=t,Ho.attachEvent("onpropertychange",ew)):n==="focusout"&&yv()}function eA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return lu(ua)}function tA(n,e){if(n==="click")return lu(e)}function nA(n,e){if(n==="input"||n==="change")return lu(e)}function iA(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var sn=typeof Object.is=="function"?Object.is:iA;function ha(n,e){if(sn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!pd.call(e,r)||!sn(n[r],e[r]))return!1}return!0}function _v(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function xv(n,e){var t=_v(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=_v(t)}}function tw(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?tw(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function nw(){for(var n=window,e=mc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=mc(n.document)}return e}function of(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function rA(n){var e=nw(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&tw(t.ownerDocument.documentElement,t)){if(i!==null&&of(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=xv(t,s);var o=xv(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var sA=On&&"documentMode"in document&&11>=document.documentMode,ts=null,Dd=null,Go=null,Nd=!1;function wv(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Nd||ts==null||ts!==mc(i)||(i=ts,"selectionStart"in i&&of(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Go&&ha(Go,i)||(Go=i,i=Ec(Dd,"onSelect"),0<i.length&&(e=new nf("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=ts)))}function Pl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var ns={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},Rh={},iw={};On&&(iw=document.createElement("div").style,"AnimationEvent"in window||(delete ns.animationend.animation,delete ns.animationiteration.animation,delete ns.animationstart.animation),"TransitionEvent"in window||delete ns.transitionend.transition);function cu(n){if(Rh[n])return Rh[n];if(!ns[n])return n;var e=ns[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in iw)return Rh[n]=e[t];return n}var rw=cu("animationend"),sw=cu("animationiteration"),ow=cu("animationstart"),aw=cu("transitionend"),lw=new Map,Ev="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(n,e){lw.set(n,e),Ar(e,[n])}for(var Dh=0;Dh<Ev.length;Dh++){var Nh=Ev[Dh],oA=Nh.toLowerCase(),aA=Nh[0].toUpperCase()+Nh.slice(1);Ni(oA,"on"+aA)}Ni(rw,"onAnimationEnd");Ni(sw,"onAnimationIteration");Ni(ow,"onAnimationStart");Ni("dblclick","onDoubleClick");Ni("focusin","onFocus");Ni("focusout","onBlur");Ni(aw,"onTransitionEnd");_s("onMouseEnter",["mouseout","mouseover"]);_s("onMouseLeave",["mouseout","mouseover"]);_s("onPointerEnter",["pointerout","pointerover"]);_s("onPointerLeave",["pointerout","pointerover"]);Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mo));function Tv(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,o1(i,e,void 0,n),n.currentTarget=null}function cw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Tv(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Tv(r,a,u),s=l}}}if(vc)throw n=Cd,vc=!1,Cd=null,n}function ye(n,e){var t=e[Fd];t===void 0&&(t=e[Fd]=new Set);var i=n+"__bubble";t.has(i)||(uw(e,n,2,!1),t.add(i))}function Vh(n,e,t){var i=0;e&&(i|=4),uw(t,n,i,e)}var Rl="_reactListening"+Math.random().toString(36).slice(2);function da(n){if(!n[Rl]){n[Rl]=!0,vx.forEach(function(t){t!=="selectionchange"&&(lA.has(t)||Vh(t,!1,n),Vh(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Rl]||(e[Rl]=!0,Vh("selectionchange",!1,e))}}function uw(n,e,t,i){switch(Kx(e)){case 1:var r=E1;break;case 4:r=T1;break;default:r=ef}t=r.bind(null,e,t,n),r=void 0,!bd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function Mh(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=nr(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}Nx(function(){var u=s,h=Xp(t),p=[];e:{var f=lw.get(n);if(f!==void 0){var v=nf,I=n;switch(n){case"keypress":if(Wl(t)===0)break e;case"keydown":case"keyup":v=F1;break;case"focusin":I="focus",v=Ch;break;case"focusout":I="blur",v=Ch;break;case"beforeblur":case"afterblur":v=Ch;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=hv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=A1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=U1;break;case rw:case sw:case ow:v=k1;break;case aw:v=$1;break;case"scroll":v=I1;break;case"wheel":v=H1;break;case"copy":case"cut":case"paste":v=R1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=pv}var b=(e&4)!==0,T=!b&&n==="scroll",y=b?f!==null?f+"Capture":null:f;b=[];for(var g=u,w;g!==null;){w=g;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,y!==null&&(k=oa(g,y),k!=null&&b.push(pa(g,k,w)))),T)break;g=g.return}0<b.length&&(f=new v(f,I,null,t,h),p.push({event:f,listeners:b}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",v=n==="mouseout"||n==="pointerout",f&&t!==Sd&&(I=t.relatedTarget||t.fromElement)&&(nr(I)||I[Ln]))break e;if((v||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,v?(I=t.relatedTarget||t.toElement,v=u,I=I?nr(I):null,I!==null&&(T=br(I),I!==T||I.tag!==5&&I.tag!==6)&&(I=null)):(v=null,I=u),v!==I)){if(b=hv,k="onMouseLeave",y="onMouseEnter",g="mouse",(n==="pointerout"||n==="pointerover")&&(b=pv,k="onPointerLeave",y="onPointerEnter",g="pointer"),T=v==null?f:is(v),w=I==null?f:is(I),f=new b(k,g+"leave",v,t,h),f.target=T,f.relatedTarget=w,k=null,nr(h)===u&&(b=new b(y,g+"enter",I,t,h),b.target=w,b.relatedTarget=T,k=b),T=k,v&&I)t:{for(b=v,y=I,g=0,w=b;w;w=Br(w))g++;for(w=0,k=y;k;k=Br(k))w++;for(;0<g-w;)b=Br(b),g--;for(;0<w-g;)y=Br(y),w--;for(;g--;){if(b===y||y!==null&&b===y.alternate)break t;b=Br(b),y=Br(y)}b=null}else b=null;v!==null&&Iv(p,f,v,b,!1),I!==null&&T!==null&&Iv(p,T,I,b,!0)}}e:{if(f=u?is(u):window,v=f.nodeName&&f.nodeName.toLowerCase(),v==="select"||v==="input"&&f.type==="file")var N=J1;else if(gv(f))if(Zx)N=nA;else{N=eA;var M=Z1}else(v=f.nodeName)&&v.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=tA);if(N&&(N=N(n,u))){Jx(p,N,t,h);break e}M&&M(n,f,u),n==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&xd(f,"number",f.value)}switch(M=u?is(u):window,n){case"focusin":(gv(M)||M.contentEditable==="true")&&(ts=M,Dd=u,Go=null);break;case"focusout":Go=Dd=ts=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,wv(p,t,h);break;case"selectionchange":if(sA)break;case"keydown":case"keyup":wv(p,t,h)}var E;if(sf)e:{switch(n){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else es?Xx(n,t)&&(x="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(x="onCompositionStart");x&&(Wx&&t.locale!=="ko"&&(es||x!=="onCompositionStart"?x==="onCompositionEnd"&&es&&(E=Qx()):(oi=h,tf="value"in oi?oi.value:oi.textContent,es=!0)),M=Ec(u,x),0<M.length&&(x=new dv(x,n,null,t,h),p.push({event:x,listeners:M}),E?x.data=E:(E=Yx(t),E!==null&&(x.data=E)))),(E=K1?Q1(n,t):W1(n,t))&&(u=Ec(u,"onBeforeInput"),0<u.length&&(h=new dv("onBeforeInput","beforeinput",null,t,h),p.push({event:h,listeners:u}),h.data=E))}cw(p,e)})}function pa(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ec(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=oa(n,t),s!=null&&i.unshift(pa(n,s,r)),s=oa(n,e),s!=null&&i.push(pa(n,s,r))),n=n.return}return i}function Br(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Iv(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=oa(t,s),l!=null&&o.unshift(pa(t,l,a))):r||(l=oa(t,s),l!=null&&o.push(pa(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var cA=/\r\n?/g,uA=/\u0000|\uFFFD/g;function Sv(n){return(typeof n=="string"?n:""+n).replace(cA,`
`).replace(uA,"")}function Dl(n,e,t){if(e=Sv(e),Sv(n)!==e&&t)throw Error(U(425))}function Tc(){}var Vd=null,Md=null;function Od(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ld=typeof setTimeout=="function"?setTimeout:void 0,hA=typeof clearTimeout=="function"?clearTimeout:void 0,Av=typeof Promise=="function"?Promise:void 0,dA=typeof queueMicrotask=="function"?queueMicrotask:typeof Av<"u"?function(n){return Av.resolve(null).then(n).catch(pA)}:Ld;function pA(n){setTimeout(function(){throw n})}function Oh(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),ca(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);ca(e)}function pi(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function bv(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var qs=Math.random().toString(36).slice(2),cn="__reactFiber$"+qs,fa="__reactProps$"+qs,Ln="__reactContainer$"+qs,Fd="__reactEvents$"+qs,fA="__reactListeners$"+qs,mA="__reactHandles$"+qs;function nr(n){var e=n[cn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ln]||t[cn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=bv(n);n!==null;){if(t=n[cn])return t;n=bv(n)}return e}n=t,t=n.parentNode}return null}function $a(n){return n=n[cn]||n[Ln],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function is(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(U(33))}function uu(n){return n[fa]||null}var jd=[],rs=-1;function Vi(n){return{current:n}}function xe(n){0>rs||(n.current=jd[rs],jd[rs]=null,rs--)}function me(n,e){rs++,jd[rs]=n.current,n.current=e}var Ei={},ht=Vi(Ei),kt=Vi(!1),ur=Ei;function xs(n,e){var t=n.type.contextTypes;if(!t)return Ei;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Pt(n){return n=n.childContextTypes,n!=null}function Ic(){xe(kt),xe(ht)}function Cv(n,e,t){if(ht.current!==Ei)throw Error(U(168));me(ht,e),me(kt,t)}function hw(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(U(108,ZS(n)||"Unknown",r));return ke({},t,i)}function Sc(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ei,ur=ht.current,me(ht,n),me(kt,kt.current),!0}function kv(n,e,t){var i=n.stateNode;if(!i)throw Error(U(169));t?(n=hw(n,e,ur),i.__reactInternalMemoizedMergedChildContext=n,xe(kt),xe(ht),me(ht,n)):xe(kt),me(kt,t)}var Pn=null,hu=!1,Lh=!1;function dw(n){Pn===null?Pn=[n]:Pn.push(n)}function gA(n){hu=!0,dw(n)}function Mi(){if(!Lh&&Pn!==null){Lh=!0;var n=0,e=he;try{var t=Pn;for(he=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Pn=null,hu=!1}catch(r){throw Pn!==null&&(Pn=Pn.slice(n+1)),Lx(Yp,Mi),r}finally{he=e,Lh=!1}}return null}var ss=[],os=0,Ac=null,bc=0,zt=[],$t=0,hr=null,Rn=1,Dn="";function Ki(n,e){ss[os++]=bc,ss[os++]=Ac,Ac=n,bc=e}function pw(n,e,t){zt[$t++]=Rn,zt[$t++]=Dn,zt[$t++]=hr,hr=n;var i=Rn;n=Dn;var r=32-nn(i)-1;i&=~(1<<r),t+=1;var s=32-nn(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Rn=1<<32-nn(e)+r|t<<r|i,Dn=s+n}else Rn=1<<s|t<<r|i,Dn=n}function af(n){n.return!==null&&(Ki(n,1),pw(n,1,0))}function lf(n){for(;n===Ac;)Ac=ss[--os],ss[os]=null,bc=ss[--os],ss[os]=null;for(;n===hr;)hr=zt[--$t],zt[$t]=null,Dn=zt[--$t],zt[$t]=null,Rn=zt[--$t],zt[$t]=null}var Ot=null,Mt=null,we=!1,tn=null;function fw(n,e){var t=qt(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Pv(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ot=n,Mt=pi(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ot=n,Mt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=hr!==null?{id:Rn,overflow:Dn}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=qt(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ot=n,Mt=null,!0):!1;default:return!1}}function Bd(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Ud(n){if(we){var e=Mt;if(e){var t=e;if(!Pv(n,e)){if(Bd(n))throw Error(U(418));e=pi(t.nextSibling);var i=Ot;e&&Pv(n,e)?fw(i,t):(n.flags=n.flags&-4097|2,we=!1,Ot=n)}}else{if(Bd(n))throw Error(U(418));n.flags=n.flags&-4097|2,we=!1,Ot=n}}}function Rv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ot=n}function Nl(n){if(n!==Ot)return!1;if(!we)return Rv(n),we=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Od(n.type,n.memoizedProps)),e&&(e=Mt)){if(Bd(n))throw mw(),Error(U(418));for(;e;)fw(n,e),e=pi(e.nextSibling)}if(Rv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(U(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Mt=pi(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Mt=null}}else Mt=Ot?pi(n.stateNode.nextSibling):null;return!0}function mw(){for(var n=Mt;n;)n=pi(n.nextSibling)}function ws(){Mt=Ot=null,we=!1}function cf(n){tn===null?tn=[n]:tn.push(n)}var vA=zn.ReactCurrentBatchConfig;function xo(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(U(309));var i=t.stateNode}if(!i)throw Error(U(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(U(284));if(!t._owner)throw Error(U(290,n))}return n}function Vl(n,e){throw n=Object.prototype.toString.call(e),Error(U(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Dv(n){var e=n._init;return e(n._payload)}function gw(n){function e(y,g){if(n){var w=y.deletions;w===null?(y.deletions=[g],y.flags|=16):w.push(g)}}function t(y,g){if(!n)return null;for(;g!==null;)e(y,g),g=g.sibling;return null}function i(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function r(y,g){return y=vi(y,g),y.index=0,y.sibling=null,y}function s(y,g,w){return y.index=w,n?(w=y.alternate,w!==null?(w=w.index,w<g?(y.flags|=2,g):w):(y.flags|=2,g)):(y.flags|=1048576,g)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,g,w,k){return g===null||g.tag!==6?(g=qh(w,y.mode,k),g.return=y,g):(g=r(g,w),g.return=y,g)}function l(y,g,w,k){var N=w.type;return N===Zr?h(y,g,w.props.children,k,w.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zn&&Dv(N)===g.type)?(k=r(g,w.props),k.ref=xo(y,g,w),k.return=y,k):(k=nc(w.type,w.key,w.props,null,y.mode,k),k.ref=xo(y,g,w),k.return=y,k)}function u(y,g,w,k){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=Hh(w,y.mode,k),g.return=y,g):(g=r(g,w.children||[]),g.return=y,g)}function h(y,g,w,k,N){return g===null||g.tag!==7?(g=lr(w,y.mode,k,N),g.return=y,g):(g=r(g,w),g.return=y,g)}function p(y,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=qh(""+g,y.mode,w),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Tl:return w=nc(g.type,g.key,g.props,null,y.mode,w),w.ref=xo(y,null,g),w.return=y,w;case Jr:return g=Hh(g,y.mode,w),g.return=y,g;case Zn:var k=g._init;return p(y,k(g._payload),w)}if(No(g)||mo(g))return g=lr(g,y.mode,w,null),g.return=y,g;Vl(y,g)}return null}function f(y,g,w,k){var N=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return N!==null?null:a(y,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Tl:return w.key===N?l(y,g,w,k):null;case Jr:return w.key===N?u(y,g,w,k):null;case Zn:return N=w._init,f(y,g,N(w._payload),k)}if(No(w)||mo(w))return N!==null?null:h(y,g,w,k,null);Vl(y,w)}return null}function v(y,g,w,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return y=y.get(w)||null,a(g,y,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Tl:return y=y.get(k.key===null?w:k.key)||null,l(g,y,k,N);case Jr:return y=y.get(k.key===null?w:k.key)||null,u(g,y,k,N);case Zn:var M=k._init;return v(y,g,w,M(k._payload),N)}if(No(k)||mo(k))return y=y.get(w)||null,h(g,y,k,N,null);Vl(g,k)}return null}function I(y,g,w,k){for(var N=null,M=null,E=g,x=g=0,S=null;E!==null&&x<w.length;x++){E.index>x?(S=E,E=null):S=E.sibling;var A=f(y,E,w[x],k);if(A===null){E===null&&(E=S);break}n&&E&&A.alternate===null&&e(y,E),g=s(A,g,x),M===null?N=A:M.sibling=A,M=A,E=S}if(x===w.length)return t(y,E),we&&Ki(y,x),N;if(E===null){for(;x<w.length;x++)E=p(y,w[x],k),E!==null&&(g=s(E,g,x),M===null?N=E:M.sibling=E,M=E);return we&&Ki(y,x),N}for(E=i(y,E);x<w.length;x++)S=v(E,y,x,w[x],k),S!==null&&(n&&S.alternate!==null&&E.delete(S.key===null?x:S.key),g=s(S,g,x),M===null?N=S:M.sibling=S,M=S);return n&&E.forEach(function(P){return e(y,P)}),we&&Ki(y,x),N}function b(y,g,w,k){var N=mo(w);if(typeof N!="function")throw Error(U(150));if(w=N.call(w),w==null)throw Error(U(151));for(var M=N=null,E=g,x=g=0,S=null,A=w.next();E!==null&&!A.done;x++,A=w.next()){E.index>x?(S=E,E=null):S=E.sibling;var P=f(y,E,A.value,k);if(P===null){E===null&&(E=S);break}n&&E&&P.alternate===null&&e(y,E),g=s(P,g,x),M===null?N=P:M.sibling=P,M=P,E=S}if(A.done)return t(y,E),we&&Ki(y,x),N;if(E===null){for(;!A.done;x++,A=w.next())A=p(y,A.value,k),A!==null&&(g=s(A,g,x),M===null?N=A:M.sibling=A,M=A);return we&&Ki(y,x),N}for(E=i(y,E);!A.done;x++,A=w.next())A=v(E,y,x,A.value,k),A!==null&&(n&&A.alternate!==null&&E.delete(A.key===null?x:A.key),g=s(A,g,x),M===null?N=A:M.sibling=A,M=A);return n&&E.forEach(function(R){return e(y,R)}),we&&Ki(y,x),N}function T(y,g,w,k){if(typeof w=="object"&&w!==null&&w.type===Zr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Tl:e:{for(var N=w.key,M=g;M!==null;){if(M.key===N){if(N=w.type,N===Zr){if(M.tag===7){t(y,M.sibling),g=r(M,w.props.children),g.return=y,y=g;break e}}else if(M.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zn&&Dv(N)===M.type){t(y,M.sibling),g=r(M,w.props),g.ref=xo(y,M,w),g.return=y,y=g;break e}t(y,M);break}else e(y,M);M=M.sibling}w.type===Zr?(g=lr(w.props.children,y.mode,k,w.key),g.return=y,y=g):(k=nc(w.type,w.key,w.props,null,y.mode,k),k.ref=xo(y,g,w),k.return=y,y=k)}return o(y);case Jr:e:{for(M=w.key;g!==null;){if(g.key===M)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){t(y,g.sibling),g=r(g,w.children||[]),g.return=y,y=g;break e}else{t(y,g);break}else e(y,g);g=g.sibling}g=Hh(w,y.mode,k),g.return=y,y=g}return o(y);case Zn:return M=w._init,T(y,g,M(w._payload),k)}if(No(w))return I(y,g,w,k);if(mo(w))return b(y,g,w,k);Vl(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(t(y,g.sibling),g=r(g,w),g.return=y,y=g):(t(y,g),g=qh(w,y.mode,k),g.return=y,y=g),o(y)):t(y,g)}return T}var Es=gw(!0),vw=gw(!1),Cc=Vi(null),kc=null,as=null,uf=null;function hf(){uf=as=kc=null}function df(n){var e=Cc.current;xe(Cc),n._currentValue=e}function zd(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function fs(n,e){kc=n,uf=as=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(St=!0),n.firstContext=null)}function Qt(n){var e=n._currentValue;if(uf!==n)if(n={context:n,memoizedValue:e,next:null},as===null){if(kc===null)throw Error(U(308));as=n,kc.dependencies={lanes:0,firstContext:n}}else as=as.next=n;return e}var ir=null;function pf(n){ir===null?ir=[n]:ir.push(n)}function yw(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,pf(e)):(t.next=r.next,r.next=t),e.interleaved=t,Fn(n,i)}function Fn(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ei=!1;function ff(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _w(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Vn(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function fi(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,ae&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Fn(n,t)}return r=i.interleaved,r===null?(e.next=e,pf(i)):(e.next=r.next,r.next=e),i.interleaved=e,Fn(n,t)}function Xl(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Jp(n,t)}}function Nv(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Pc(n,e,t,i){var r=n.updateQueue;ei=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(s!==null){var p=r.baseState;o=0,h=u=l=null,a=s;do{var f=a.lane,v=a.eventTime;if((i&f)===f){h!==null&&(h=h.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=n,b=a;switch(f=e,v=t,b.tag){case 1:if(I=b.payload,typeof I=="function"){p=I.call(v,p,f);break e}p=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=b.payload,f=typeof I=="function"?I.call(v,p,f):I,f==null)break e;p=ke({},p,f);break e;case 2:ei=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=r.effects,f===null?r.effects=[a]:f.push(a))}else v={eventTime:v,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=v,l=p):h=h.next=v,o|=f;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;f=a,a=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(h===null&&(l=p),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);pr|=o,n.lanes=o,n.memoizedState=p}}function Vv(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(U(191,r));r.call(i)}}}var qa={},mn=Vi(qa),ma=Vi(qa),ga=Vi(qa);function rr(n){if(n===qa)throw Error(U(174));return n}function mf(n,e){switch(me(ga,e),me(ma,n),me(mn,qa),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ed(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Ed(e,n)}xe(mn),me(mn,e)}function Ts(){xe(mn),xe(ma),xe(ga)}function xw(n){rr(ga.current);var e=rr(mn.current),t=Ed(e,n.type);e!==t&&(me(ma,n),me(mn,t))}function gf(n){ma.current===n&&(xe(mn),xe(ma))}var Ae=Vi(0);function Rc(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fh=[];function vf(){for(var n=0;n<Fh.length;n++)Fh[n]._workInProgressVersionPrimary=null;Fh.length=0}var Yl=zn.ReactCurrentDispatcher,jh=zn.ReactCurrentBatchConfig,dr=0,be=null,ze=null,Ge=null,Dc=!1,Ko=!1,va=0,yA=0;function at(){throw Error(U(321))}function yf(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!sn(n[t],e[t]))return!1;return!0}function _f(n,e,t,i,r,s){if(dr=s,be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yl.current=n===null||n.memoizedState===null?EA:TA,n=t(i,r),Ko){s=0;do{if(Ko=!1,va=0,25<=s)throw Error(U(301));s+=1,Ge=ze=null,e.updateQueue=null,Yl.current=IA,n=t(i,r)}while(Ko)}if(Yl.current=Nc,e=ze!==null&&ze.next!==null,dr=0,Ge=ze=be=null,Dc=!1,e)throw Error(U(300));return n}function xf(){var n=va!==0;return va=0,n}function ln(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?be.memoizedState=Ge=n:Ge=Ge.next=n,Ge}function Wt(){if(ze===null){var n=be.alternate;n=n!==null?n.memoizedState:null}else n=ze.next;var e=Ge===null?be.memoizedState:Ge.next;if(e!==null)Ge=e,ze=n;else{if(n===null)throw Error(U(310));ze=n,n={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},Ge===null?be.memoizedState=Ge=n:Ge=Ge.next=n}return Ge}function ya(n,e){return typeof e=="function"?e(n):e}function Bh(n){var e=Wt(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var i=ze,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var h=u.lane;if((dr&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,be.lanes|=h,pr|=h}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,sn(i,e.memoizedState)||(St=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,be.lanes|=s,pr|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Uh(n){var e=Wt(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);sn(s,e.memoizedState)||(St=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function ww(){}function Ew(n,e){var t=be,i=Wt(),r=e(),s=!sn(i.memoizedState,r);if(s&&(i.memoizedState=r,St=!0),i=i.queue,wf(Sw.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Ge!==null&&Ge.memoizedState.tag&1){if(t.flags|=2048,_a(9,Iw.bind(null,t,i,r,e),void 0,null),Qe===null)throw Error(U(349));dr&30||Tw(t,e,r)}return r}function Tw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Iw(n,e,t,i){e.value=t,e.getSnapshot=i,Aw(e)&&bw(n)}function Sw(n,e,t){return t(function(){Aw(e)&&bw(n)})}function Aw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!sn(n,t)}catch{return!0}}function bw(n){var e=Fn(n,1);e!==null&&rn(e,n,1,-1)}function Mv(n){var e=ln();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:n},e.queue=n,n=n.dispatch=wA.bind(null,be,n),[e.memoizedState,n]}function _a(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function Cw(){return Wt().memoizedState}function Jl(n,e,t,i){var r=ln();be.flags|=n,r.memoizedState=_a(1|e,t,void 0,i===void 0?null:i)}function du(n,e,t,i){var r=Wt();i=i===void 0?null:i;var s=void 0;if(ze!==null){var o=ze.memoizedState;if(s=o.destroy,i!==null&&yf(i,o.deps)){r.memoizedState=_a(e,t,s,i);return}}be.flags|=n,r.memoizedState=_a(1|e,t,s,i)}function Ov(n,e){return Jl(8390656,8,n,e)}function wf(n,e){return du(2048,8,n,e)}function kw(n,e){return du(4,2,n,e)}function Pw(n,e){return du(4,4,n,e)}function Rw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Dw(n,e,t){return t=t!=null?t.concat([n]):null,du(4,4,Rw.bind(null,e,n),t)}function Ef(){}function Nw(n,e){var t=Wt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&yf(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function Vw(n,e){var t=Wt();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&yf(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function Mw(n,e,t){return dr&21?(sn(t,e)||(t=Bx(),be.lanes|=t,pr|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,St=!0),n.memoizedState=t)}function _A(n,e){var t=he;he=t!==0&&4>t?t:4,n(!0);var i=jh.transition;jh.transition={};try{n(!1),e()}finally{he=t,jh.transition=i}}function Ow(){return Wt().memoizedState}function xA(n,e,t){var i=gi(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},Lw(n))Fw(e,t);else if(t=yw(n,e,t,i),t!==null){var r=vt();rn(t,n,i,r),jw(t,e,i)}}function wA(n,e,t){var i=gi(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(Lw(n))Fw(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,sn(a,o)){var l=e.interleaved;l===null?(r.next=r,pf(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=yw(n,e,r,i),t!==null&&(r=vt(),rn(t,n,i,r),jw(t,e,i))}}function Lw(n){var e=n.alternate;return n===be||e!==null&&e===be}function Fw(n,e){Ko=Dc=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function jw(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,Jp(n,t)}}var Nc={readContext:Qt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},EA={readContext:Qt,useCallback:function(n,e){return ln().memoizedState=[n,e===void 0?null:e],n},useContext:Qt,useEffect:Ov,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Jl(4194308,4,Rw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Jl(4194308,4,n,e)},useInsertionEffect:function(n,e){return Jl(4,2,n,e)},useMemo:function(n,e){var t=ln();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=ln();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=xA.bind(null,be,n),[i.memoizedState,n]},useRef:function(n){var e=ln();return n={current:n},e.memoizedState=n},useState:Mv,useDebugValue:Ef,useDeferredValue:function(n){return ln().memoizedState=n},useTransition:function(){var n=Mv(!1),e=n[0];return n=_A.bind(null,n[1]),ln().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=be,r=ln();if(we){if(t===void 0)throw Error(U(407));t=t()}else{if(t=e(),Qe===null)throw Error(U(349));dr&30||Tw(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,Ov(Sw.bind(null,i,s,n),[n]),i.flags|=2048,_a(9,Iw.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=ln(),e=Qe.identifierPrefix;if(we){var t=Dn,i=Rn;t=(i&~(1<<32-nn(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=va++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=yA++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},TA={readContext:Qt,useCallback:Nw,useContext:Qt,useEffect:wf,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Pw,useMemo:Vw,useReducer:Bh,useRef:Cw,useState:function(){return Bh(ya)},useDebugValue:Ef,useDeferredValue:function(n){var e=Wt();return Mw(e,ze.memoizedState,n)},useTransition:function(){var n=Bh(ya)[0],e=Wt().memoizedState;return[n,e]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Ow,unstable_isNewReconciler:!1},IA={readContext:Qt,useCallback:Nw,useContext:Qt,useEffect:wf,useImperativeHandle:Dw,useInsertionEffect:kw,useLayoutEffect:Pw,useMemo:Vw,useReducer:Uh,useRef:Cw,useState:function(){return Uh(ya)},useDebugValue:Ef,useDeferredValue:function(n){var e=Wt();return ze===null?e.memoizedState=n:Mw(e,ze.memoizedState,n)},useTransition:function(){var n=Uh(ya)[0],e=Wt().memoizedState;return[n,e]},useMutableSource:ww,useSyncExternalStore:Ew,useId:Ow,unstable_isNewReconciler:!1};function Zt(n,e){if(n&&n.defaultProps){e=ke({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function $d(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:ke({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var pu={isMounted:function(n){return(n=n._reactInternals)?br(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=vt(),r=gi(n),s=Vn(i,r);s.payload=e,t!=null&&(s.callback=t),e=fi(n,s,r),e!==null&&(rn(e,n,r,i),Xl(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=vt(),r=gi(n),s=Vn(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=fi(n,s,r),e!==null&&(rn(e,n,r,i),Xl(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=vt(),i=gi(n),r=Vn(t,i);r.tag=2,e!=null&&(r.callback=e),e=fi(n,r,i),e!==null&&(rn(e,n,i,t),Xl(e,n,i))}};function Lv(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!ha(t,i)||!ha(r,s):!0}function Bw(n,e,t){var i=!1,r=Ei,s=e.contextType;return typeof s=="object"&&s!==null?s=Qt(s):(r=Pt(e)?ur:ht.current,i=e.contextTypes,s=(i=i!=null)?xs(n,r):Ei),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pu,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function Fv(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&pu.enqueueReplaceState(e,e.state,null)}function qd(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},ff(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Qt(s):(s=Pt(e)?ur:ht.current,r.context=xs(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&($d(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&pu.enqueueReplaceState(r,r.state,null),Pc(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Is(n,e){try{var t="",i=e;do t+=JS(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function zh(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Hd(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var SA=typeof WeakMap=="function"?WeakMap:Map;function Uw(n,e,t){t=Vn(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Mc||(Mc=!0,tp=i),Hd(n,e)},t}function zw(n,e,t){t=Vn(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){Hd(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Hd(n,e),typeof i!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function jv(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new SA;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=jA.bind(null,n,e,t),e.then(n,n))}function Bv(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Uv(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Vn(-1,1),e.tag=2,fi(t,e,1))),t.lanes|=1),n)}var AA=zn.ReactCurrentOwner,St=!1;function ft(n,e,t,i){e.child=n===null?vw(e,null,t,i):Es(e,n.child,t,i)}function zv(n,e,t,i,r){t=t.render;var s=e.ref;return fs(e,r),i=_f(n,e,t,i,s,r),t=xf(),n!==null&&!St?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,jn(n,e,r)):(we&&t&&af(e),e.flags|=1,ft(n,e,i,r),e.child)}function $v(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!Pf(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,$w(n,e,s,i,r)):(n=nc(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:ha,t(o,i)&&n.ref===e.ref)return jn(n,e,r)}return e.flags|=1,n=vi(s,i),n.ref=e.ref,n.return=e,e.child=n}function $w(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(ha(s,i)&&n.ref===e.ref)if(St=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(St=!0);else return e.lanes=n.lanes,jn(n,e,r)}return Gd(n,e,t,i,r)}function qw(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(cs,Vt),Vt|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,me(cs,Vt),Vt|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,me(cs,Vt),Vt|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,me(cs,Vt),Vt|=i;return ft(n,e,r,t),e.child}function Hw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Gd(n,e,t,i,r){var s=Pt(t)?ur:ht.current;return s=xs(e,s),fs(e,r),t=_f(n,e,t,i,s,r),i=xf(),n!==null&&!St?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,jn(n,e,r)):(we&&i&&af(e),e.flags|=1,ft(n,e,t,r),e.child)}function qv(n,e,t,i,r){if(Pt(t)){var s=!0;Sc(e)}else s=!1;if(fs(e,r),e.stateNode===null)Zl(n,e),Bw(e,t,i),qd(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Qt(u):(u=Pt(t)?ur:ht.current,u=xs(e,u));var h=t.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&Fv(e,o,i,u),ei=!1;var f=e.memoizedState;o.state=f,Pc(e,i,o,r),l=e.memoizedState,a!==i||f!==l||kt.current||ei?(typeof h=="function"&&($d(e,t,h,i),l=e.memoizedState),(a=ei||Lv(e,t,a,i,f,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,_w(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Zt(e.type,a),o.props=u,p=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Qt(l):(l=Pt(t)?ur:ht.current,l=xs(e,l));var v=t.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||f!==l)&&Fv(e,o,i,l),ei=!1,f=e.memoizedState,o.state=f,Pc(e,i,o,r);var I=e.memoizedState;a!==p||f!==I||kt.current||ei?(typeof v=="function"&&($d(e,t,v,i),I=e.memoizedState),(u=ei||Lv(e,t,u,i,f,I,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,I,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,I,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=I),o.props=i,o.state=I,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),i=!1)}return Kd(n,e,t,i,s,r)}function Kd(n,e,t,i,r,s){Hw(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&kv(e,t,!1),jn(n,e,s);i=e.stateNode,AA.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Es(e,n.child,null,s),e.child=Es(e,null,a,s)):ft(n,e,a,s),e.memoizedState=i.state,r&&kv(e,t,!0),e.child}function Gw(n){var e=n.stateNode;e.pendingContext?Cv(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Cv(n,e.context,!1),mf(n,e.containerInfo)}function Hv(n,e,t,i,r){return ws(),cf(r),e.flags|=256,ft(n,e,t,i),e.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function Wd(n){return{baseLanes:n,cachePool:null,transitions:null}}function Kw(n,e,t){var i=e.pendingProps,r=Ae.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),me(Ae,r&1),n===null)return Ud(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gu(o,i,0,null),n=lr(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Wd(t),e.memoizedState=Qd,n):Tf(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return bA(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=vi(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=vi(a,s):(s=lr(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?Wd(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=Qd,i}return s=n.child,n=s.sibling,i=vi(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Tf(n,e){return e=gu({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ml(n,e,t,i){return i!==null&&cf(i),Es(e,n.child,null,t),n=Tf(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function bA(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=zh(Error(U(422))),Ml(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=gu({mode:"visible",children:i.children},r,0,null),s=lr(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Es(e,n.child,null,o),e.child.memoizedState=Wd(o),e.memoizedState=Qd,s);if(!(e.mode&1))return Ml(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(U(419)),i=zh(s,i,void 0),Ml(n,e,o,i)}if(a=(o&n.childLanes)!==0,St||a){if(i=Qe,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Fn(n,r),rn(i,n,r,-1))}return kf(),i=zh(Error(U(421))),Ml(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=BA.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,Mt=pi(r.nextSibling),Ot=e,we=!0,tn=null,n!==null&&(zt[$t++]=Rn,zt[$t++]=Dn,zt[$t++]=hr,Rn=n.id,Dn=n.overflow,hr=e),e=Tf(e,i.children),e.flags|=4096,e)}function Gv(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),zd(n.return,e,t)}function $h(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function Qw(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ft(n,e,i.children,t),i=Ae.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Gv(n,t,e);else if(n.tag===19)Gv(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(me(Ae,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Rc(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),$h(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Rc(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}$h(e,!0,t,null,s);break;case"together":$h(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Zl(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function jn(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),pr|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(U(153));if(e.child!==null){for(n=e.child,t=vi(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=vi(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function CA(n,e,t){switch(e.tag){case 3:Gw(e),ws();break;case 5:xw(e);break;case 1:Pt(e.type)&&Sc(e);break;case 4:mf(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;me(Cc,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(me(Ae,Ae.current&1),e.flags|=128,null):t&e.child.childLanes?Kw(n,e,t):(me(Ae,Ae.current&1),n=jn(n,e,t),n!==null?n.sibling:null);me(Ae,Ae.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return Qw(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),me(Ae,Ae.current),i)break;return null;case 22:case 23:return e.lanes=0,qw(n,e,t)}return jn(n,e,t)}var Ww,Xd,Xw,Yw;Ww=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Xd=function(){};Xw=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,rr(mn.current);var s=null;switch(t){case"input":r=yd(n,r),i=yd(n,i),s=[];break;case"select":r=ke({},r,{value:void 0}),i=ke({},i,{value:void 0}),s=[];break;case"textarea":r=wd(n,r),i=wd(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Tc)}Td(t,i);var o;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ra.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ra.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ye("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Yw=function(n,e,t,i){t!==i&&(e.flags|=4)};function wo(n,e){if(!we)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function lt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function kA(n,e,t){var i=e.pendingProps;switch(lf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return Pt(e.type)&&Ic(),lt(e),null;case 3:return i=e.stateNode,Ts(),xe(kt),xe(ht),vf(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Nl(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,tn!==null&&(rp(tn),tn=null))),Xd(n,e),lt(e),null;case 5:gf(e);var r=rr(ga.current);if(t=e.type,n!==null&&e.stateNode!=null)Xw(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(U(166));return lt(e),null}if(n=rr(mn.current),Nl(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[cn]=e,i[fa]=s,n=(e.mode&1)!==0,t){case"dialog":ye("cancel",i),ye("close",i);break;case"iframe":case"object":case"embed":ye("load",i);break;case"video":case"audio":for(r=0;r<Mo.length;r++)ye(Mo[r],i);break;case"source":ye("error",i);break;case"img":case"image":case"link":ye("error",i),ye("load",i);break;case"details":ye("toggle",i);break;case"input":tv(i,s),ye("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},ye("invalid",i);break;case"textarea":iv(i,s),ye("invalid",i)}Td(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Dl(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Dl(i.textContent,a,n),r=["children",""+a]):ra.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ye("scroll",i)}switch(t){case"input":Il(i),nv(i,s,!0);break;case"textarea":Il(i),rv(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Tc)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Sx(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[cn]=e,n[fa]=i,Ww(n,e,!1,!1),e.stateNode=n;e:{switch(o=Id(t,i),t){case"dialog":ye("cancel",n),ye("close",n),r=i;break;case"iframe":case"object":case"embed":ye("load",n),r=i;break;case"video":case"audio":for(r=0;r<Mo.length;r++)ye(Mo[r],n);r=i;break;case"source":ye("error",n),r=i;break;case"img":case"image":case"link":ye("error",n),ye("load",n),r=i;break;case"details":ye("toggle",n),r=i;break;case"input":tv(n,i),r=yd(n,i),ye("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=ke({},i,{value:void 0}),ye("invalid",n);break;case"textarea":iv(n,i),r=wd(n,i),ye("invalid",n);break;default:r=i}Td(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Cx(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ax(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&sa(n,l):typeof l=="number"&&sa(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ra.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ye("scroll",n):l!=null&&Gp(n,s,l,o))}switch(t){case"input":Il(n),nv(n,i,!1);break;case"textarea":Il(n),rv(n);break;case"option":i.value!=null&&n.setAttribute("value",""+wi(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?us(n,!!i.multiple,s,!1):i.defaultValue!=null&&us(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Tc)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(n&&e.stateNode!=null)Yw(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(U(166));if(t=rr(ga.current),rr(mn.current),Nl(e)){if(i=e.stateNode,t=e.memoizedProps,i[cn]=e,(s=i.nodeValue!==t)&&(n=Ot,n!==null))switch(n.tag){case 3:Dl(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Dl(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[cn]=e,e.stateNode=i}return lt(e),null;case 13:if(xe(Ae),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(we&&Mt!==null&&e.mode&1&&!(e.flags&128))mw(),ws(),e.flags|=98560,s=!1;else if(s=Nl(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[cn]=e}else ws(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),s=!1}else tn!==null&&(rp(tn),tn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Ae.current&1?$e===0&&($e=3):kf())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return Ts(),Xd(n,e),n===null&&da(e.stateNode.containerInfo),lt(e),null;case 10:return df(e.type._context),lt(e),null;case 17:return Pt(e.type)&&Ic(),lt(e),null;case 19:if(xe(Ae),s=e.memoizedState,s===null)return lt(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)wo(s,!1);else{if($e!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Rc(n),o!==null){for(e.flags|=128,wo(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return me(Ae,Ae.current&1|2),e.child}n=n.sibling}s.tail!==null&&Me()>Ss&&(e.flags|=128,i=!0,wo(s,!1),e.lanes=4194304)}else{if(!i)if(n=Rc(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),wo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!we)return lt(e),null}else 2*Me()-s.renderingStartTime>Ss&&t!==1073741824&&(e.flags|=128,i=!0,wo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Me(),e.sibling=null,t=Ae.current,me(Ae,i?t&1|2:t&1),e):(lt(e),null);case 22:case 23:return Cf(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Vt&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function PA(n,e){switch(lf(e),e.tag){case 1:return Pt(e.type)&&Ic(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Ts(),xe(kt),xe(ht),vf(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return gf(e),null;case 13:if(xe(Ae),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(U(340));ws()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return xe(Ae),null;case 4:return Ts(),null;case 10:return df(e.type._context),null;case 22:case 23:return Cf(),null;case 24:return null;default:return null}}var Ol=!1,ut=!1,RA=typeof WeakSet=="function"?WeakSet:Set,Q=null;function ls(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Re(n,e,i)}else t.current=null}function Yd(n,e,t){try{t()}catch(i){Re(n,e,i)}}var Kv=!1;function DA(n,e){if(Vd=xc,n=nw(),of(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=n,f=null;t:for(;;){for(var v;p!==t||r!==0&&p.nodeType!==3||(a=o+r),p!==s||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)f=p,p=v;for(;;){if(p===n)break t;if(f===t&&++u===r&&(a=o),f===s&&++h===i&&(l=o),(v=p.nextSibling)!==null)break;p=f,f=p.parentNode}p=v}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Md={focusedElem:n,selectionRange:t},xc=!1,Q=e;Q!==null;)if(e=Q,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Q=n;else for(;Q!==null;){e=Q;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var b=I.memoizedProps,T=I.memoizedState,y=e.stateNode,g=y.getSnapshotBeforeUpdate(e.elementType===e.type?b:Zt(e.type,b),T);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(k){Re(e,e.return,k)}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}return I=Kv,Kv=!1,I}function Qo(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&Yd(e,t,s)}r=r.next}while(r!==i)}}function fu(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function Jd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Jw(n){var e=n.alternate;e!==null&&(n.alternate=null,Jw(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[cn],delete e[fa],delete e[Fd],delete e[fA],delete e[mA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Zw(n){return n.tag===5||n.tag===3||n.tag===4}function Qv(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Zw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Zd(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Tc));else if(i!==4&&(n=n.child,n!==null))for(Zd(n,e,t),n=n.sibling;n!==null;)Zd(n,e,t),n=n.sibling}function ep(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(ep(n,e,t),n=n.sibling;n!==null;)ep(n,e,t),n=n.sibling}var Ze=null,en=!1;function Wn(n,e,t){for(t=t.child;t!==null;)e0(n,e,t),t=t.sibling}function e0(n,e,t){if(fn&&typeof fn.onCommitFiberUnmount=="function")try{fn.onCommitFiberUnmount(ou,t)}catch{}switch(t.tag){case 5:ut||ls(t,e);case 6:var i=Ze,r=en;Ze=null,Wn(n,e,t),Ze=i,en=r,Ze!==null&&(en?(n=Ze,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ze.removeChild(t.stateNode));break;case 18:Ze!==null&&(en?(n=Ze,t=t.stateNode,n.nodeType===8?Oh(n.parentNode,t):n.nodeType===1&&Oh(n,t),ca(n)):Oh(Ze,t.stateNode));break;case 4:i=Ze,r=en,Ze=t.stateNode.containerInfo,en=!0,Wn(n,e,t),Ze=i,en=r;break;case 0:case 11:case 14:case 15:if(!ut&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Yd(t,e,o),r=r.next}while(r!==i)}Wn(n,e,t);break;case 1:if(!ut&&(ls(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Re(t,e,a)}Wn(n,e,t);break;case 21:Wn(n,e,t);break;case 22:t.mode&1?(ut=(i=ut)||t.memoizedState!==null,Wn(n,e,t),ut=i):Wn(n,e,t);break;default:Wn(n,e,t)}}function Wv(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new RA),e.forEach(function(i){var r=UA.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Yt(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ze=a.stateNode,en=!1;break e;case 3:Ze=a.stateNode.containerInfo,en=!0;break e;case 4:Ze=a.stateNode.containerInfo,en=!0;break e}a=a.return}if(Ze===null)throw Error(U(160));e0(s,o,r),Ze=null,en=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Re(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)t0(e,n),e=e.sibling}function t0(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Yt(e,n),an(n),i&4){try{Qo(3,n,n.return),fu(3,n)}catch(b){Re(n,n.return,b)}try{Qo(5,n,n.return)}catch(b){Re(n,n.return,b)}}break;case 1:Yt(e,n),an(n),i&512&&t!==null&&ls(t,t.return);break;case 5:if(Yt(e,n),an(n),i&512&&t!==null&&ls(t,t.return),n.flags&32){var r=n.stateNode;try{sa(r,"")}catch(b){Re(n,n.return,b)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tx(r,s),Id(a,o);var u=Id(a,s);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?Cx(r,p):h==="dangerouslySetInnerHTML"?Ax(r,p):h==="children"?sa(r,p):Gp(r,h,p,u)}switch(a){case"input":_d(r,s);break;case"textarea":Ix(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?us(r,!!s.multiple,v,!1):f!==!!s.multiple&&(s.defaultValue!=null?us(r,!!s.multiple,s.defaultValue,!0):us(r,!!s.multiple,s.multiple?[]:"",!1))}r[fa]=s}catch(b){Re(n,n.return,b)}}break;case 6:if(Yt(e,n),an(n),i&4){if(n.stateNode===null)throw Error(U(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(b){Re(n,n.return,b)}}break;case 3:if(Yt(e,n),an(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{ca(e.containerInfo)}catch(b){Re(n,n.return,b)}break;case 4:Yt(e,n),an(n);break;case 13:Yt(e,n),an(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(Af=Me())),i&4&&Wv(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(ut=(u=ut)||h,Yt(e,n),ut=u):Yt(e,n),an(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(Q=n,h=n.child;h!==null;){for(p=Q=h;Q!==null;){switch(f=Q,v=f.child,f.tag){case 0:case 11:case 14:case 15:Qo(4,f,f.return);break;case 1:ls(f,f.return);var I=f.stateNode;if(typeof I.componentWillUnmount=="function"){i=f,t=f.return;try{e=i,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(b){Re(i,t,b)}}break;case 5:ls(f,f.return);break;case 22:if(f.memoizedState!==null){Yv(p);continue}}v!==null?(v.return=f,Q=v):Yv(p)}h=h.sibling}e:for(h=null,p=n;;){if(p.tag===5){if(h===null){h=p;try{r=p.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=bx("display",o))}catch(b){Re(n,n.return,b)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(b){Re(n,n.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Yt(e,n),an(n),i&4&&Wv(n);break;case 21:break;default:Yt(e,n),an(n)}}function an(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Zw(t)){var i=t;break e}t=t.return}throw Error(U(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(sa(r,""),i.flags&=-33);var s=Qv(n);ep(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Qv(n);Zd(n,a,o);break;default:throw Error(U(161))}}catch(l){Re(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function NA(n,e,t){Q=n,n0(n)}function n0(n,e,t){for(var i=(n.mode&1)!==0;Q!==null;){var r=Q,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Ol;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||ut;a=Ol;var u=ut;if(Ol=o,(ut=l)&&!u)for(Q=r;Q!==null;)o=Q,l=o.child,o.tag===22&&o.memoizedState!==null?Jv(r):l!==null?(l.return=o,Q=l):Jv(r);for(;s!==null;)Q=s,n0(s),s=s.sibling;Q=r,Ol=a,ut=u}Xv(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Q=s):Xv(n)}}function Xv(n){for(;Q!==null;){var e=Q;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||fu(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ut)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Zt(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Vv(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Vv(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&ca(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ut||e.flags&512&&Jd(e)}catch(f){Re(e,e.return,f)}}if(e===n){Q=null;break}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Yv(n){for(;Q!==null;){var e=Q;if(e===n){Q=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Q=t;break}Q=e.return}}function Jv(n){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{fu(4,e)}catch(l){Re(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Re(e,r,l)}}var s=e.return;try{Jd(e)}catch(l){Re(e,s,l)}break;case 5:var o=e.return;try{Jd(e)}catch(l){Re(e,o,l)}}}catch(l){Re(e,e.return,l)}if(e===n){Q=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Q=a;break}Q=e.return}}var VA=Math.ceil,Vc=zn.ReactCurrentDispatcher,If=zn.ReactCurrentOwner,Gt=zn.ReactCurrentBatchConfig,ae=0,Qe=null,je=null,nt=0,Vt=0,cs=Vi(0),$e=0,xa=null,pr=0,mu=0,Sf=0,Wo=null,It=null,Af=0,Ss=1/0,kn=null,Mc=!1,tp=null,mi=null,Ll=!1,ai=null,Oc=0,Xo=0,np=null,ec=-1,tc=0;function vt(){return ae&6?Me():ec!==-1?ec:ec=Me()}function gi(n){return n.mode&1?ae&2&&nt!==0?nt&-nt:vA.transition!==null?(tc===0&&(tc=Bx()),tc):(n=he,n!==0||(n=window.event,n=n===void 0?16:Kx(n.type)),n):1}function rn(n,e,t,i){if(50<Xo)throw Xo=0,np=null,Error(U(185));Ua(n,t,i),(!(ae&2)||n!==Qe)&&(n===Qe&&(!(ae&2)&&(mu|=t),$e===4&&ii(n,nt)),Rt(n,i),t===1&&ae===0&&!(e.mode&1)&&(Ss=Me()+500,hu&&Mi()))}function Rt(n,e){var t=n.callbackNode;v1(n,e);var i=_c(n,n===Qe?nt:0);if(i===0)t!==null&&av(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&av(t),e===1)n.tag===0?gA(Zv.bind(null,n)):dw(Zv.bind(null,n)),dA(function(){!(ae&6)&&Mi()}),t=null;else{switch(Ux(i)){case 1:t=Yp;break;case 4:t=Fx;break;case 16:t=yc;break;case 536870912:t=jx;break;default:t=yc}t=u0(t,i0.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function i0(n,e){if(ec=-1,tc=0,ae&6)throw Error(U(327));var t=n.callbackNode;if(ms()&&n.callbackNode!==t)return null;var i=_c(n,n===Qe?nt:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Lc(n,i);else{e=i;var r=ae;ae|=2;var s=s0();(Qe!==n||nt!==e)&&(kn=null,Ss=Me()+500,ar(n,e));do try{LA();break}catch(a){r0(n,a)}while(!0);hf(),Vc.current=s,ae=r,je!==null?e=0:(Qe=null,nt=0,e=$e)}if(e!==0){if(e===2&&(r=kd(n),r!==0&&(i=r,e=ip(n,r))),e===1)throw t=xa,ar(n,0),ii(n,i),Rt(n,Me()),t;if(e===6)ii(n,i);else{if(r=n.current.alternate,!(i&30)&&!MA(r)&&(e=Lc(n,i),e===2&&(s=kd(n),s!==0&&(i=s,e=ip(n,s))),e===1))throw t=xa,ar(n,0),ii(n,i),Rt(n,Me()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(U(345));case 2:Qi(n,It,kn);break;case 3:if(ii(n,i),(i&130023424)===i&&(e=Af+500-Me(),10<e)){if(_c(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){vt(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Ld(Qi.bind(null,n,It,kn),e);break}Qi(n,It,kn);break;case 4:if(ii(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-nn(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Me()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*VA(i/1960))-i,10<i){n.timeoutHandle=Ld(Qi.bind(null,n,It,kn),i);break}Qi(n,It,kn);break;case 5:Qi(n,It,kn);break;default:throw Error(U(329))}}}return Rt(n,Me()),n.callbackNode===t?i0.bind(null,n):null}function ip(n,e){var t=Wo;return n.current.memoizedState.isDehydrated&&(ar(n,e).flags|=256),n=Lc(n,e),n!==2&&(e=It,It=t,e!==null&&rp(e)),n}function rp(n){It===null?It=n:It.push.apply(It,n)}function MA(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!sn(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(n,e){for(e&=~Sf,e&=~mu,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-nn(e),i=1<<t;n[t]=-1,e&=~i}}function Zv(n){if(ae&6)throw Error(U(327));ms();var e=_c(n,0);if(!(e&1))return Rt(n,Me()),null;var t=Lc(n,e);if(n.tag!==0&&t===2){var i=kd(n);i!==0&&(e=i,t=ip(n,i))}if(t===1)throw t=xa,ar(n,0),ii(n,e),Rt(n,Me()),t;if(t===6)throw Error(U(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Qi(n,It,kn),Rt(n,Me()),null}function bf(n,e){var t=ae;ae|=1;try{return n(e)}finally{ae=t,ae===0&&(Ss=Me()+500,hu&&Mi())}}function fr(n){ai!==null&&ai.tag===0&&!(ae&6)&&ms();var e=ae;ae|=1;var t=Gt.transition,i=he;try{if(Gt.transition=null,he=1,n)return n()}finally{he=i,Gt.transition=t,ae=e,!(ae&6)&&Mi()}}function Cf(){Vt=cs.current,xe(cs)}function ar(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,hA(t)),je!==null)for(t=je.return;t!==null;){var i=t;switch(lf(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Ic();break;case 3:Ts(),xe(kt),xe(ht),vf();break;case 5:gf(i);break;case 4:Ts();break;case 13:xe(Ae);break;case 19:xe(Ae);break;case 10:df(i.type._context);break;case 22:case 23:Cf()}t=t.return}if(Qe=n,je=n=vi(n.current,null),nt=Vt=e,$e=0,xa=null,Sf=mu=pr=0,It=Wo=null,ir!==null){for(e=0;e<ir.length;e++)if(t=ir[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}ir=null}return n}function r0(n,e){do{var t=je;try{if(hf(),Yl.current=Nc,Dc){for(var i=be.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Dc=!1}if(dr=0,Ge=ze=be=null,Ko=!1,va=0,If.current=null,t===null||t.return===null){$e=1,xa=e,je=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=nt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=Bv(o);if(v!==null){v.flags&=-257,Uv(v,o,a,s,e),v.mode&1&&jv(s,u,e),e=v,l=u;var I=e.updateQueue;if(I===null){var b=new Set;b.add(l),e.updateQueue=b}else I.add(l);break e}else{if(!(e&1)){jv(s,u,e),kf();break e}l=Error(U(426))}}else if(we&&a.mode&1){var T=Bv(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Uv(T,o,a,s,e),cf(Is(l,a));break e}}s=l=Is(l,a),$e!==4&&($e=2),Wo===null?Wo=[s]:Wo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=Uw(s,l,e);Nv(s,y);break e;case 1:a=l;var g=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(mi===null||!mi.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=zw(s,a,e);Nv(s,k);break e}}s=s.return}while(s!==null)}a0(t)}catch(N){e=N,je===t&&t!==null&&(je=t=t.return);continue}break}while(!0)}function s0(){var n=Vc.current;return Vc.current=Nc,n===null?Nc:n}function kf(){($e===0||$e===3||$e===2)&&($e=4),Qe===null||!(pr&268435455)&&!(mu&268435455)||ii(Qe,nt)}function Lc(n,e){var t=ae;ae|=2;var i=s0();(Qe!==n||nt!==e)&&(kn=null,ar(n,e));do try{OA();break}catch(r){r0(n,r)}while(!0);if(hf(),ae=t,Vc.current=i,je!==null)throw Error(U(261));return Qe=null,nt=0,$e}function OA(){for(;je!==null;)o0(je)}function LA(){for(;je!==null&&!l1();)o0(je)}function o0(n){var e=c0(n.alternate,n,Vt);n.memoizedProps=n.pendingProps,e===null?a0(n):je=e,If.current=null}function a0(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=PA(t,e),t!==null){t.flags&=32767,je=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{$e=6,je=null;return}}else if(t=kA(t,e,Vt),t!==null){je=t;return}if(e=e.sibling,e!==null){je=e;return}je=e=n}while(e!==null);$e===0&&($e=5)}function Qi(n,e,t){var i=he,r=Gt.transition;try{Gt.transition=null,he=1,FA(n,e,t,i)}finally{Gt.transition=r,he=i}return null}function FA(n,e,t,i){do ms();while(ai!==null);if(ae&6)throw Error(U(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(U(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(y1(n,s),n===Qe&&(je=Qe=null,nt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ll||(Ll=!0,u0(yc,function(){return ms(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Gt.transition,Gt.transition=null;var o=he;he=1;var a=ae;ae|=4,If.current=null,DA(n,t),t0(t,n),rA(Md),xc=!!Vd,Md=Vd=null,n.current=t,NA(t),c1(),ae=a,he=o,Gt.transition=s}else n.current=t;if(Ll&&(Ll=!1,ai=n,Oc=r),s=n.pendingLanes,s===0&&(mi=null),d1(t.stateNode),Rt(n,Me()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Mc)throw Mc=!1,n=tp,tp=null,n;return Oc&1&&n.tag!==0&&ms(),s=n.pendingLanes,s&1?n===np?Xo++:(Xo=0,np=n):Xo=0,Mi(),null}function ms(){if(ai!==null){var n=Ux(Oc),e=Gt.transition,t=he;try{if(Gt.transition=null,he=16>n?16:n,ai===null)var i=!1;else{if(n=ai,ai=null,Oc=0,ae&6)throw Error(U(331));var r=ae;for(ae|=4,Q=n.current;Q!==null;){var s=Q,o=s.child;if(Q.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Q=u;Q!==null;){var h=Q;switch(h.tag){case 0:case 11:case 15:Qo(8,h,s)}var p=h.child;if(p!==null)p.return=h,Q=p;else for(;Q!==null;){h=Q;var f=h.sibling,v=h.return;if(Jw(h),h===u){Q=null;break}if(f!==null){f.return=v,Q=f;break}Q=v}}}var I=s.alternate;if(I!==null){var b=I.child;if(b!==null){I.child=null;do{var T=b.sibling;b.sibling=null,b=T}while(b!==null)}}Q=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Q=o;else e:for(;Q!==null;){if(s=Q,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Qo(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Q=y;break e}Q=s.return}}var g=n.current;for(Q=g;Q!==null;){o=Q;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Q=w;else e:for(o=g;Q!==null;){if(a=Q,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:fu(9,a)}}catch(N){Re(a,a.return,N)}if(a===o){Q=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,Q=k;break e}Q=a.return}}if(ae=r,Mi(),fn&&typeof fn.onPostCommitFiberRoot=="function")try{fn.onPostCommitFiberRoot(ou,n)}catch{}i=!0}return i}finally{he=t,Gt.transition=e}}return!1}function ey(n,e,t){e=Is(t,e),e=Uw(n,e,1),n=fi(n,e,1),e=vt(),n!==null&&(Ua(n,1,e),Rt(n,e))}function Re(n,e,t){if(n.tag===3)ey(n,n,t);else for(;e!==null;){if(e.tag===3){ey(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(mi===null||!mi.has(i))){n=Is(t,n),n=zw(e,n,1),e=fi(e,n,1),n=vt(),e!==null&&(Ua(e,1,n),Rt(e,n));break}}e=e.return}}function jA(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=vt(),n.pingedLanes|=n.suspendedLanes&t,Qe===n&&(nt&t)===t&&($e===4||$e===3&&(nt&130023424)===nt&&500>Me()-Af?ar(n,0):Sf|=t),Rt(n,e)}function l0(n,e){e===0&&(n.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var t=vt();n=Fn(n,e),n!==null&&(Ua(n,e,t),Rt(n,t))}function BA(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),l0(n,t)}function UA(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(U(314))}i!==null&&i.delete(e),l0(n,t)}var c0;c0=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||kt.current)St=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return St=!1,CA(n,e,t);St=!!(n.flags&131072)}else St=!1,we&&e.flags&1048576&&pw(e,bc,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Zl(n,e),n=e.pendingProps;var r=xs(e,ht.current);fs(e,t),r=_f(null,e,i,n,r,t);var s=xf();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pt(i)?(s=!0,Sc(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ff(e),r.updater=pu,e.stateNode=r,r._reactInternals=e,qd(e,i,n,t),e=Kd(null,e,i,!0,s,t)):(e.tag=0,we&&s&&af(e),ft(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Zl(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=$A(i),n=Zt(i,n),r){case 0:e=Gd(null,e,i,n,t);break e;case 1:e=qv(null,e,i,n,t);break e;case 11:e=zv(null,e,i,n,t);break e;case 14:e=$v(null,e,i,Zt(i.type,n),t);break e}throw Error(U(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Zt(i,r),Gd(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Zt(i,r),qv(n,e,i,r,t);case 3:e:{if(Gw(e),n===null)throw Error(U(387));i=e.pendingProps,s=e.memoizedState,r=s.element,_w(n,e),Pc(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Is(Error(U(423)),e),e=Hv(n,e,i,t,r);break e}else if(i!==r){r=Is(Error(U(424)),e),e=Hv(n,e,i,t,r);break e}else for(Mt=pi(e.stateNode.containerInfo.firstChild),Ot=e,we=!0,tn=null,t=vw(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ws(),i===r){e=jn(n,e,t);break e}ft(n,e,i,t)}e=e.child}return e;case 5:return xw(e),n===null&&Ud(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Od(i,r)?o=null:s!==null&&Od(i,s)&&(e.flags|=32),Hw(n,e),ft(n,e,o,t),e.child;case 6:return n===null&&Ud(e),null;case 13:return Kw(n,e,t);case 4:return mf(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Es(e,null,i,t):ft(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Zt(i,r),zv(n,e,i,r,t);case 7:return ft(n,e,e.pendingProps,t),e.child;case 8:return ft(n,e,e.pendingProps.children,t),e.child;case 12:return ft(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,me(Cc,i._currentValue),i._currentValue=o,s!==null)if(sn(s.value,o)){if(s.children===r.children&&!kt.current){e=jn(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Vn(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),zd(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(U(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),zd(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ft(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,fs(e,t),r=Qt(r),i=i(r),e.flags|=1,ft(n,e,i,t),e.child;case 14:return i=e.type,r=Zt(i,e.pendingProps),r=Zt(i.type,r),$v(n,e,i,r,t);case 15:return $w(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Zt(i,r),Zl(n,e),e.tag=1,Pt(i)?(n=!0,Sc(e)):n=!1,fs(e,t),Bw(e,i,r),qd(e,i,r,t),Kd(null,e,i,!0,n,t);case 19:return Qw(n,e,t);case 22:return qw(n,e,t)}throw Error(U(156,e.tag))};function u0(n,e){return Lx(n,e)}function zA(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(n,e,t,i){return new zA(n,e,t,i)}function Pf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $A(n){if(typeof n=="function")return Pf(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Qp)return 11;if(n===Wp)return 14}return 2}function vi(n,e){var t=n.alternate;return t===null?(t=qt(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function nc(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")Pf(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Zr:return lr(t.children,r,s,e);case Kp:o=8,r|=8;break;case fd:return n=qt(12,t,e,r|2),n.elementType=fd,n.lanes=s,n;case md:return n=qt(13,t,e,r),n.elementType=md,n.lanes=s,n;case gd:return n=qt(19,t,e,r),n.elementType=gd,n.lanes=s,n;case xx:return gu(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case yx:o=10;break e;case _x:o=9;break e;case Qp:o=11;break e;case Wp:o=14;break e;case Zn:o=16,i=null;break e}throw Error(U(130,n==null?n:typeof n,""))}return e=qt(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function lr(n,e,t,i){return n=qt(7,n,i,e),n.lanes=t,n}function gu(n,e,t,i){return n=qt(22,n,i,e),n.elementType=xx,n.lanes=t,n.stateNode={isHidden:!1},n}function qh(n,e,t){return n=qt(6,n,null,e),n.lanes=t,n}function Hh(n,e,t){return e=qt(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function qA(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sh(0),this.expirationTimes=Sh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sh(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Rf(n,e,t,i,r,s,o,a,l){return n=new qA(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=qt(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},ff(s),n}function HA(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jr,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function h0(n){if(!n)return Ei;n=n._reactInternals;e:{if(br(n)!==n||n.tag!==1)throw Error(U(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(n.tag===1){var t=n.type;if(Pt(t))return hw(n,t,e)}return e}function d0(n,e,t,i,r,s,o,a,l){return n=Rf(t,i,!0,n,r,s,o,a,l),n.context=h0(null),t=n.current,i=vt(),r=gi(t),s=Vn(i,r),s.callback=e??null,fi(t,s,r),n.current.lanes=r,Ua(n,r,i),Rt(n,i),n}function vu(n,e,t,i){var r=e.current,s=vt(),o=gi(r);return t=h0(t),e.context===null?e.context=t:e.pendingContext=t,e=Vn(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=fi(r,e,o),n!==null&&(rn(n,r,o,s),Xl(n,r,o)),o}function Fc(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ty(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Df(n,e){ty(n,e),(n=n.alternate)&&ty(n,e)}function GA(){return null}var p0=typeof reportError=="function"?reportError:function(n){console.error(n)};function Nf(n){this._internalRoot=n}yu.prototype.render=Nf.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(U(409));vu(n,e,null,null)};yu.prototype.unmount=Nf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;fr(function(){vu(null,n,null,null)}),e[Ln]=null}};function yu(n){this._internalRoot=n}yu.prototype.unstable_scheduleHydration=function(n){if(n){var e=qx();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ni.length&&e!==0&&e<ni[t].priority;t++);ni.splice(t,0,n),t===0&&Gx(n)}};function Vf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function _u(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ny(){}function KA(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Fc(o);s.call(u)}}var o=d0(e,i,n,0,null,!1,!1,"",ny);return n._reactRootContainer=o,n[Ln]=o.current,da(n.nodeType===8?n.parentNode:n),fr(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Fc(l);a.call(u)}}var l=Rf(n,0,!1,null,null,!1,!1,"",ny);return n._reactRootContainer=l,n[Ln]=l.current,da(n.nodeType===8?n.parentNode:n),fr(function(){vu(e,l,t,i)}),l}function xu(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Fc(o);a.call(l)}}vu(e,o,n,r)}else o=KA(t,e,n,r,i);return Fc(o)}zx=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Vo(e.pendingLanes);t!==0&&(Jp(e,t|1),Rt(e,Me()),!(ae&6)&&(Ss=Me()+500,Mi()))}break;case 13:fr(function(){var i=Fn(n,1);if(i!==null){var r=vt();rn(i,n,1,r)}}),Df(n,1)}};Zp=function(n){if(n.tag===13){var e=Fn(n,134217728);if(e!==null){var t=vt();rn(e,n,134217728,t)}Df(n,134217728)}};$x=function(n){if(n.tag===13){var e=gi(n),t=Fn(n,e);if(t!==null){var i=vt();rn(t,n,e,i)}Df(n,e)}};qx=function(){return he};Hx=function(n,e){var t=he;try{return he=n,e()}finally{he=t}};Ad=function(n,e,t){switch(e){case"input":if(_d(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=uu(i);if(!r)throw Error(U(90));Ex(i),_d(i,r)}}}break;case"textarea":Ix(n,t);break;case"select":e=t.value,e!=null&&us(n,!!t.multiple,e,!1)}};Rx=bf;Dx=fr;var QA={usingClientEntryPoint:!1,Events:[$a,is,uu,kx,Px,bf]},Eo={findFiberByHostInstance:nr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},WA={bundleType:Eo.bundleType,version:Eo.version,rendererPackageName:Eo.rendererPackageName,rendererConfig:Eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Mx(n),n===null?null:n.stateNode},findFiberByHostInstance:Eo.findFiberByHostInstance||GA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fl.isDisabled&&Fl.supportsFiber)try{ou=Fl.inject(WA),fn=Fl}catch{}}jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QA;jt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vf(e))throw Error(U(200));return HA(n,e,null,t)};jt.createRoot=function(n,e){if(!Vf(n))throw Error(U(299));var t=!1,i="",r=p0;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Rf(n,1,!1,null,null,t,!1,i,r),n[Ln]=e.current,da(n.nodeType===8?n.parentNode:n),new Nf(e)};jt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(U(188)):(n=Object.keys(n).join(","),Error(U(268,n)));return n=Mx(e),n=n===null?null:n.stateNode,n};jt.flushSync=function(n){return fr(n)};jt.hydrate=function(n,e,t){if(!_u(e))throw Error(U(200));return xu(null,n,e,!0,t)};jt.hydrateRoot=function(n,e,t){if(!Vf(n))throw Error(U(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=p0;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=d0(e,null,n,1,t??null,r,!1,s,o),n[Ln]=e.current,da(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new yu(e)};jt.render=function(n,e,t){if(!_u(e))throw Error(U(200));return xu(null,n,e,!1,t)};jt.unmountComponentAtNode=function(n){if(!_u(n))throw Error(U(40));return n._reactRootContainer?(fr(function(){xu(null,null,n,!1,function(){n._reactRootContainer=null,n[Ln]=null})}),!0):!1};jt.unstable_batchedUpdates=bf;jt.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!_u(t))throw Error(U(200));if(n==null||n._reactInternals===void 0)throw Error(U(38));return xu(n,e,t,!1,i)};jt.version="18.3.1-next-f1338f8080-20240426";function f0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f0)}catch(n){console.error(n)}}f0(),fx.exports=jt;var XA=fx.exports,iy=XA;dd.createRoot=iy.createRoot,dd.hydrateRoot=iy.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wa(){return wa=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},wa.apply(this,arguments)}var li;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(li||(li={}));const ry="popstate";function YA(n){n===void 0&&(n={});function e(r,s){let{pathname:o="/",search:a="",hash:l=""}=Cr(r.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),sp("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){let o=r.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=r.location.href,u=l.indexOf("#");a=u===-1?l:l.slice(0,u)}return a+"#"+(typeof s=="string"?s:jc(s))}function i(r,s){Mf(r.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return ZA(e,t,i,n)}function Be(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Mf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JA(){return Math.random().toString(36).substr(2,8)}function sy(n,e){return{usr:n.state,key:n.key,idx:e}}function sp(n,e,t,i){return t===void 0&&(t=null),wa({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Cr(e):e,{state:t,key:e&&e.key||i||JA()})}function jc(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Cr(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function ZA(n,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=li.Pop,l=null,u=h();u==null&&(u=0,o.replaceState(wa({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function p(){a=li.Pop;let T=h(),y=T==null?null:T-u;u=T,l&&l({action:a,location:b.location,delta:y})}function f(T,y){a=li.Push;let g=sp(b.location,T,y);t&&t(g,T),u=h()+1;let w=sy(g,u),k=b.createHref(g);try{o.pushState(w,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;r.location.assign(k)}s&&l&&l({action:a,location:b.location,delta:1})}function v(T,y){a=li.Replace;let g=sp(b.location,T,y);t&&t(g,T),u=h();let w=sy(g,u),k=b.createHref(g);o.replaceState(w,"",k),s&&l&&l({action:a,location:b.location,delta:0})}function I(T){let y=r.location.origin!=="null"?r.location.origin:r.location.href,g=typeof T=="string"?T:jc(T);return g=g.replace(/ $/,"%20"),Be(y,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,y)}let b={get action(){return a},get location(){return n(r,o)},listen(T){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(ry,p),l=T,()=>{r.removeEventListener(ry,p),l=null}},createHref(T){return e(r,T)},createURL:I,encodeLocation(T){let y=I(T);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:v,go(T){return o.go(T)}};return b}var oy;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(oy||(oy={}));function eb(n,e,t){t===void 0&&(t="/");let i=typeof e=="string"?Cr(e):e,r=Of(i.pathname||"/",t);if(r==null)return null;let s=m0(n);tb(s);let o=null;for(let a=0;o==null&&a<s.length;++a){let l=pb(r);o=ub(s[a],l)}return o}function m0(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Be(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let u=yi([i,l.relativePath]),h=t.concat(l);s.children&&s.children.length>0&&(Be(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),m0(s.children,e,h,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:lb(u,s.index),routesMeta:h})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of g0(s.path))r(s,o,l)}),e}function g0(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=g0(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function tb(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:cb(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const nb=/^:[\w-]+$/,ib=3,rb=2,sb=1,ob=10,ab=-2,ay=n=>n==="*";function lb(n,e){let t=n.split("/"),i=t.length;return t.some(ay)&&(i+=ab),e&&(i+=rb),t.filter(r=>!ay(r)).reduce((r,s)=>r+(nb.test(s)?ib:s===""?sb:ob),i)}function cb(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function ub(n,e){let{routesMeta:t}=n,i={},r="/",s=[];for(let o=0;o<t.length;++o){let a=t[o],l=o===t.length-1,u=r==="/"?e:e.slice(r.length)||"/",h=hb({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!h)return null;Object.assign(i,h.params);let p=a.route;s.push({params:i,pathname:yi([r,h.pathname]),pathnameBase:vb(yi([r,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(r=yi([r,h.pathnameBase]))}return s}function hb(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=db(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((u,h,p)=>{let{paramName:f,isOptional:v}=h;if(f==="*"){let b=a[p]||"";o=s.slice(0,s.length-b.length).replace(/(.)\/+$/,"$1")}const I=a[p];return v&&!I?u[f]=void 0:u[f]=(I||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:n}}function db(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Mf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function pb(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Of(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function fb(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?Cr(n):n;return{pathname:t?t.startsWith("/")?t:mb(t,e):e,search:yb(i),hash:_b(r)}}function mb(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function Gh(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gb(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function v0(n,e){let t=gb(n);return e?t.map((i,r)=>r===n.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function y0(n,e,t,i){i===void 0&&(i=!1);let r;typeof n=="string"?r=Cr(n):(r=wa({},n),Be(!r.pathname||!r.pathname.includes("?"),Gh("?","pathname","search",r)),Be(!r.pathname||!r.pathname.includes("#"),Gh("#","pathname","hash",r)),Be(!r.search||!r.search.includes("#"),Gh("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=t;else{let p=e.length-1;if(!i&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),p-=1;r.pathname=f.join("/")}a=p>=0?e[p]:"/"}let l=fb(r,a),u=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}const yi=n=>n.join("/").replace(/\/\/+/g,"/"),vb=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),yb=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,_b=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function xb(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const _0=["post","put","patch","delete"];new Set(_0);const wb=["get",..._0];new Set(wb);/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ea(){return Ea=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ea.apply(this,arguments)}const Lf=$.createContext(null),Eb=$.createContext(null),kr=$.createContext(null),wu=$.createContext(null),Oi=$.createContext({outlet:null,matches:[],isDataRoute:!1}),x0=$.createContext(null);function Tb(n,e){let{relative:t}=e===void 0?{}:e;Ha()||Be(!1);let{basename:i,navigator:r}=$.useContext(kr),{hash:s,pathname:o,search:a}=E0(n,{relative:t}),l=o;return i!=="/"&&(l=o==="/"?i:yi([i,o])),r.createHref({pathname:l,search:a,hash:s})}function Ha(){return $.useContext(wu)!=null}function Eu(){return Ha()||Be(!1),$.useContext(wu).location}function w0(n){$.useContext(kr).static||$.useLayoutEffect(n)}function Ff(){let{isDataRoute:n}=$.useContext(Oi);return n?Lb():Ib()}function Ib(){Ha()||Be(!1);let n=$.useContext(Lf),{basename:e,future:t,navigator:i}=$.useContext(kr),{matches:r}=$.useContext(Oi),{pathname:s}=Eu(),o=JSON.stringify(v0(r,t.v7_relativeSplatPath)),a=$.useRef(!1);return w0(()=>{a.current=!0}),$.useCallback(function(u,h){if(h===void 0&&(h={}),!a.current)return;if(typeof u=="number"){i.go(u);return}let p=y0(u,JSON.parse(o),s,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:yi([e,p.pathname])),(h.replace?i.replace:i.push)(p,h.state,h)},[e,i,o,s,n])}function Sb(){let{matches:n}=$.useContext(Oi),e=n[n.length-1];return e?e.params:{}}function E0(n,e){let{relative:t}=e===void 0?{}:e,{future:i}=$.useContext(kr),{matches:r}=$.useContext(Oi),{pathname:s}=Eu(),o=JSON.stringify(v0(r,i.v7_relativeSplatPath));return $.useMemo(()=>y0(n,JSON.parse(o),s,t==="path"),[n,o,s,t])}function Ab(n,e){return bb(n,e)}function bb(n,e,t,i){Ha()||Be(!1);let{navigator:r}=$.useContext(kr),{matches:s}=$.useContext(Oi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Eu(),h;if(e){var p;let T=typeof e=="string"?Cr(e):e;l==="/"||(p=T.pathname)!=null&&p.startsWith(l)||Be(!1),h=T}else h=u;let f=h.pathname||"/",v=f;if(l!=="/"){let T=l.replace(/^\//,"").split("/");v="/"+f.replace(/^\//,"").split("/").slice(T.length).join("/")}let I=eb(n,{pathname:v}),b=Db(I&&I.map(T=>Object.assign({},T,{params:Object.assign({},a,T.params),pathname:yi([l,r.encodeLocation?r.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?l:yi([l,r.encodeLocation?r.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),s,t,i);return e&&b?$.createElement(wu.Provider,{value:{location:Ea({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:li.Pop}},b):b}function Cb(){let n=Ob(),e=xb(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return $.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},e),t?$.createElement("pre",{style:r},t):null,null)}const kb=$.createElement(Cb,null);class Pb extends $.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?$.createElement(Oi.Provider,{value:this.props.routeContext},$.createElement(x0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Rb(n){let{routeContext:e,match:t,children:i}=n,r=$.useContext(Lf);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),$.createElement(Oi.Provider,{value:e},i)}function Db(n,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let o=n,a=(r=t)==null?void 0:r.errors;if(a!=null){let h=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);h>=0||Be(!1),o=o.slice(0,Math.min(o.length,h+1))}let l=!1,u=-1;if(t&&i&&i.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:f,errors:v}=t,I=p.route.loader&&f[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||I){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,p,f)=>{let v,I=!1,b=null,T=null;t&&(v=a&&p.route.id?a[p.route.id]:void 0,b=p.route.errorElement||kb,l&&(u<0&&f===0?(I=!0,T=null):u===f&&(I=!0,T=p.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,f+1)),g=()=>{let w;return v?w=b:I?w=T:p.route.Component?w=$.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=h,$.createElement(Rb,{match:p,routeContext:{outlet:h,matches:y,isDataRoute:t!=null},children:w})};return t&&(p.route.ErrorBoundary||p.route.errorElement||f===0)?$.createElement(Pb,{location:t.location,revalidation:t.revalidation,component:b,error:v,children:g(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):g()},null)}var T0=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(T0||{}),Bc=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Bc||{});function Nb(n){let e=$.useContext(Lf);return e||Be(!1),e}function Vb(n){let e=$.useContext(Eb);return e||Be(!1),e}function Mb(n){let e=$.useContext(Oi);return e||Be(!1),e}function I0(n){let e=Mb(),t=e.matches[e.matches.length-1];return t.route.id||Be(!1),t.route.id}function Ob(){var n;let e=$.useContext(x0),t=Vb(Bc.UseRouteError),i=I0(Bc.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function Lb(){let{router:n}=Nb(T0.UseNavigateStable),e=I0(Bc.UseNavigateStable),t=$.useRef(!1);return w0(()=>{t.current=!0}),$.useCallback(function(r,s){s===void 0&&(s={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,Ea({fromRouteId:e},s)))},[n,e])}function Oo(n){Be(!1)}function Fb(n){let{basename:e="/",children:t=null,location:i,navigationType:r=li.Pop,navigator:s,static:o=!1,future:a}=n;Ha()&&Be(!1);let l=e.replace(/^\/*/,"/"),u=$.useMemo(()=>({basename:l,navigator:s,static:o,future:Ea({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof i=="string"&&(i=Cr(i));let{pathname:h="/",search:p="",hash:f="",state:v=null,key:I="default"}=i,b=$.useMemo(()=>{let T=Of(h,l);return T==null?null:{location:{pathname:T,search:p,hash:f,state:v,key:I},navigationType:r}},[l,h,p,f,v,I,r]);return b==null?null:$.createElement(kr.Provider,{value:u},$.createElement(wu.Provider,{children:t,value:b}))}function jb(n){let{children:e,location:t}=n;return Ab(op(e),t)}new Promise(()=>{});function op(n,e){e===void 0&&(e=[]);let t=[];return $.Children.forEach(n,(i,r)=>{if(!$.isValidElement(i))return;let s=[...e,r];if(i.type===$.Fragment){t.push.apply(t,op(i.props.children,s));return}i.type!==Oo&&Be(!1),!i.props.index||!i.props.children||Be(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=op(i.props.children,s)),t.push(o)}),t}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ap(){return ap=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ap.apply(this,arguments)}function Bb(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function Ub(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zb(n,e){return n.button===0&&(!e||e==="_self")&&!Ub(n)}const $b=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],qb="6";try{window.__reactRouterVersion=qb}catch{}const Hb="startTransition",ly=jS[Hb];function Gb(n){let{basename:e,children:t,future:i,window:r}=n,s=$.useRef();s.current==null&&(s.current=YA({window:r,v5Compat:!0}));let o=s.current,[a,l]=$.useState({action:o.action,location:o.location}),{v7_startTransition:u}=i||{},h=$.useCallback(p=>{u&&ly?ly(()=>l(p)):l(p)},[l,u]);return $.useLayoutEffect(()=>o.listen(h),[o,h]),$.createElement(Fb,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:i})}const Kb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Qb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Uc=$.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:h,unstable_viewTransition:p}=e,f=Bb(e,$b),{basename:v}=$.useContext(kr),I,b=!1;if(typeof u=="string"&&Qb.test(u)&&(I=u,Kb))try{let w=new URL(window.location.href),k=u.startsWith("//")?new URL(w.protocol+u):new URL(u),N=Of(k.pathname,v);k.origin===w.origin&&N!=null?u=N+k.search+k.hash:b=!0}catch{}let T=Tb(u,{relative:r}),y=Wb(u,{replace:o,state:a,target:l,preventScrollReset:h,relative:r,unstable_viewTransition:p});function g(w){i&&i(w),w.defaultPrevented||y(w)}return $.createElement("a",ap({},f,{href:I||T,onClick:b||s?i:g,ref:t,target:l}))});var cy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(cy||(cy={}));var uy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(uy||(uy={}));function Wb(n,e){let{target:t,replace:i,state:r,preventScrollReset:s,relative:o,unstable_viewTransition:a}=e===void 0?{}:e,l=Ff(),u=Eu(),h=E0(n,{relative:o});return $.useCallback(p=>{if(zb(p,t)){p.preventDefault();let f=i!==void 0?i:jc(u)===jc(h);l(n,{replace:f,state:r,preventScrollReset:s,relative:o,unstable_viewTransition:a})}},[u,l,h,i,r,t,n,s,o,a])}function Xb(){return F.jsxs("div",{className:"max-w-md mx-auto text-center p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Passenger Loading System"}),F.jsxs("div",{className:"space-y-4",children:[F.jsx(Uc,{to:"/book",className:"block w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-md transition duration-300",children:"Book a Car"}),F.jsx(Uc,{to:"/check-reservation",className:"block w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md transition duration-300",children:"Check My Reservation"})]})]})}var hy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Yb=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},A0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,h=s>>2,p=(s&3)<<4|a>>4;let f=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(f=64)),i.push(t[h],t[p],t[f],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(S0(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Yb(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const p=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||u==null||p==null)throw new Jb;const f=s<<2|a>>4;if(i.push(f),u!==64){const v=a<<4&240|u>>2;if(i.push(v),p!==64){const I=u<<6&192|p;i.push(I)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Jb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zb=function(n){const e=S0(n);return A0.encodeByteArray(e,!0)},zc=function(n){return Zb(n).replace(/\./g,"")},eC=function(n){try{return A0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function $c(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!tC(t)||(n[t]=$c(n[t],e[t]));return n}function tC(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=()=>nC().__FIREBASE_DEFAULTS__,rC=()=>{if(typeof process>"u"||typeof hy>"u")return;const n=hy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},sC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&eC(n[1]);return e&&JSON.parse(e)},b0=()=>{try{return iC()||rC()||sC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},C0=()=>{var n;return(n=b0())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[zc(JSON.stringify(t)),zc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lC(){var n;const e=(n=b0())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function k0(){return typeof self=="object"&&self.self===self}function P0(){return!lC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function R0(){try{return typeof indexedDB=="object"}catch{return!1}}function cC(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="FirebaseError";class Pr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=uC,Object.setPrototypeOf(this,Pr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tu.prototype.create)}}class Tu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?hC(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Pr(r,a,i)}}function hC(n,e){return n.replace(dC,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const dC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ta(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(py(s)&&py(o)){if(!Ta(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function py(n){return n!==null&&typeof n=="object"}function pC(n,e){const t=new fC(n,e);return t.subscribe.bind(t)}class fC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");mC(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Kh),r.error===void 0&&(r.error=Kh),r.complete===void 0&&(r.complete=Kh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Kh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(n){return n&&n._delegate?n._delegate:n}class mr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new oC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yC(e))try{this.getOrInitializeService({instanceIdentifier:Wi})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wi){return this.instances.has(e)}getOptions(e=Wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:vC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Wi){return this.component?this.component.multipleInstances?e:Wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vC(n){return n===Wi?void 0:n}function yC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf=[];var se;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(se||(se={}));const N0={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},_C=se.INFO,xC={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},wC=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=xC[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bf{constructor(e){this.name=e,this._logLevel=_C,this._logHandler=wC,this._userLogHandler=null,jf.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?N0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}}function EC(n){jf.forEach(e=>{e.setLogLevel(n)})}function TC(n,e){for(const t of jf){let i=null;e&&e.level&&(i=N0[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(r,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(i??r.logLevel)&&n({level:se[s].toLowerCase(),message:a,args:o,type:r.name})}}}const IC=(n,e)=>e.some(t=>n instanceof t);let fy,my;function SC(){return fy||(fy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AC(){return my||(my=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const V0=new WeakMap,lp=new WeakMap,M0=new WeakMap,Qh=new WeakMap,Uf=new WeakMap;function bC(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(_i(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&V0.set(t,n)}).catch(()=>{}),Uf.set(e,n),e}function CC(n){if(lp.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});lp.set(n,e)}let cp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||M0.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _i(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function kC(n){cp=n(cp)}function PC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Wh(this),e,...t);return M0.set(i,e.sort?e.sort():[e]),_i(i)}:AC().includes(n)?function(...e){return n.apply(Wh(this),e),_i(V0.get(this))}:function(...e){return _i(n.apply(Wh(this),e))}}function RC(n){return typeof n=="function"?PC(n):(n instanceof IDBTransaction&&CC(n),IC(n,SC())?new Proxy(n,cp):n)}function _i(n){if(n instanceof IDBRequest)return bC(n);if(Qh.has(n))return Qh.get(n);const e=RC(n);return e!==n&&(Qh.set(n,e),Uf.set(e,n)),e}const Wh=n=>Uf.get(n);function DC(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=_i(o);return i&&o.addEventListener("upgradeneeded",l=>{i(_i(o.result),l.oldVersion,l.newVersion,_i(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const NC=["get","getKey","getAll","getAllKeys","count"],VC=["put","add","delete","clear"],Xh=new Map;function gy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Xh.get(e))return Xh.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=VC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||NC.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&l.done]))[0]};return Xh.set(e,s),s}kC(n=>({...n,get:(e,t,i)=>gy(e,t)||n.get(e,t,i),has:(e,t)=>!!gy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(OC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function OC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hc="@firebase/app",up="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr=new Bf("@firebase/app"),LC="@firebase/app-compat",FC="@firebase/analytics-compat",jC="@firebase/analytics",BC="@firebase/app-check-compat",UC="@firebase/app-check",zC="@firebase/auth",$C="@firebase/auth-compat",qC="@firebase/database",HC="@firebase/database-compat",GC="@firebase/functions",KC="@firebase/functions-compat",QC="@firebase/installations",WC="@firebase/installations-compat",XC="@firebase/messaging",YC="@firebase/messaging-compat",JC="@firebase/performance",ZC="@firebase/performance-compat",ek="@firebase/remote-config",tk="@firebase/remote-config-compat",nk="@firebase/storage",ik="@firebase/storage-compat",rk="@firebase/firestore",sk="@firebase/vertexai-preview",ok="@firebase/firestore-compat",ak="firebase",lk="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]",ck={[Hc]:"fire-core",[LC]:"fire-core-compat",[jC]:"fire-analytics",[FC]:"fire-analytics-compat",[UC]:"fire-app-check",[BC]:"fire-app-check-compat",[zC]:"fire-auth",[$C]:"fire-auth-compat",[qC]:"fire-rtdb",[HC]:"fire-rtdb-compat",[GC]:"fire-fn",[KC]:"fire-fn-compat",[QC]:"fire-iid",[WC]:"fire-iid-compat",[XC]:"fire-fcm",[YC]:"fire-fcm-compat",[JC]:"fire-perf",[ZC]:"fire-perf-compat",[ek]:"fire-rc",[tk]:"fire-rc-compat",[nk]:"fire-gcs",[ik]:"fire-gcs-compat",[rk]:"fire-fst",[ok]:"fire-fst-compat",[sk]:"fire-vertex","fire-js":"fire-js",[ak]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new Map,As=new Map,bs=new Map;function Ia(n,e){try{n.container.addComponent(e)}catch(t){gr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function O0(n,e){n.container.addOrOverwriteComponent(e)}function Cs(n){const e=n.name;if(bs.has(e))return gr.debug(`There were multiple attempts to register component ${e}.`),!1;bs.set(e,n);for(const t of Ii.values())Ia(t,n);for(const t of As.values())Ia(t,n);return!0}function L0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function uk(n,e,t=Ti){L0(n,e).clearInstance(t)}function F0(n){return n.options!==void 0}function hk(n){return n.settings!==void 0}function dk(){bs.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Kt=new Tu("app","Firebase",pk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let j0=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new mr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Kt.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk extends j0{constructor(e,t,i,r){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:i,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,r);else{const a=e;super(a.options,o,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Mn(Hc,up,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){qf(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Kt.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf=lk;function $f(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Ti,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Kt.create("bad-app-name",{appName:String(r)});if(t||(t=C0()),!t)throw Kt.create("no-options");const s=Ii.get(r);if(s){if(Ta(t,s.options)&&Ta(i,s.config))return s;throw Kt.create("duplicate-app",{appName:r})}const o=new D0(r);for(const l of bs.values())o.addComponent(l);const a=new j0(t,i,o);return Ii.set(r,a),a}function mk(n,e){if(k0())throw Kt.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;F0(n)?t=n.options:t=n;const i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const r=u=>[...u].reduce((h,p)=>Math.imul(31,h)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Kt.create("finalization-registry-not-supported",{});const s=""+r(JSON.stringify(i)),o=As.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new D0(s);for(const u of bs.values())a.addComponent(u);const l=new fk(t,e,s,a);return As.set(s,l),l}function gk(n=Ti){const e=Ii.get(n);if(!e&&n===Ti&&C0())return $f();if(!e)throw Kt.create("no-app",{appName:n});return e}function vk(){return Array.from(Ii.values())}async function qf(n){let e=!1;const t=n.name;Ii.has(t)?(e=!0,Ii.delete(t)):As.has(t)&&n.decRefCount()<=0&&(As.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function Mn(n,e,t){var i;let r=(i=ck[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gr.warn(a.join(" "));return}Cs(new mr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function B0(n,e){if(n!==null&&typeof n!="function")throw Kt.create("invalid-log-argument");TC(n,e)}function U0(n){EC(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk="firebase-heartbeat-database",_k=1,Sa="firebase-heartbeat-store";let Yh=null;function z0(){return Yh||(Yh=DC(yk,_k,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Sa)}catch(t){console.warn(t)}}}}).catch(n=>{throw Kt.create("idb-open",{originalErrorMessage:n.message})})),Yh}async function xk(n){try{const t=(await z0()).transaction(Sa),i=await t.objectStore(Sa).get($0(n));return await t.done,i}catch(e){if(e instanceof Pr)gr.warn(e.message);else{const t=Kt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gr.warn(t.message)}}}async function vy(n,e){try{const i=(await z0()).transaction(Sa,"readwrite");await i.objectStore(Sa).put(e,$0(n)),await i.done}catch(t){if(t instanceof Pr)gr.warn(t.message);else{const i=Kt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});gr.warn(i.message)}}}function $0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk=1024,Ek=30*24*60*60*1e3;class Tk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Sk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=yy();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Ek}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=yy(),{heartbeatsToSend:i,unsentEntries:r}=Ik(this._heartbeatsCache.heartbeats),s=zc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function yy(){return new Date().toISOString().substring(0,10)}function Ik(n,e=wk){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),_y(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),_y(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Sk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return R0()?cC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await xk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function _y(n){return zc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(n){Cs(new mr("platform-logger",e=>new MC(e),"PRIVATE")),Cs(new mr("heartbeat",e=>new Tk(e),"PRIVATE")),Mn(Hc,up,n),Mn(Hc,up,"esm2017"),Mn("fire-js","")}Ak("");const bk=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Pr,SDK_VERSION:zf,_DEFAULT_ENTRY_NAME:Ti,_addComponent:Ia,_addOrOverwriteComponent:O0,_apps:Ii,_clearComponents:dk,_components:bs,_getProvider:L0,_isFirebaseApp:F0,_isFirebaseServerApp:hk,_registerComponent:Cs,_removeServiceInstance:uk,_serverApps:As,deleteApp:qf,getApp:gk,getApps:vk,initializeApp:$f,initializeServerApp:mk,onLog:B0,registerVersion:Mn,setLogLevel:U0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,t){this._delegate=e,this.firebase=t,Ia(e,new mr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),qf(this._delegate)))}_getService(e,t=Ti){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Ti){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ia(this._delegate,e)}_addOrOverwriteComponent(e){O0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},xy=new Tu("app-compat","Firebase",kk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(n){const e={},t={__esModule:!0,initializeApp:s,app:r,registerVersion:Mn,setLogLevel:U0,onLog:B0,apps:null,SDK_VERSION:zf,INTERNAL:{registerComponent:a,removeApp:i,useAsService:l,modularAPIs:bk}};t.default=t,Object.defineProperty(t,"apps",{get:o});function i(u){delete e[u]}function r(u){if(u=u||Ti,!dy(e,u))throw xy.create("no-app",{appName:u});return e[u]}r.App=n;function s(u,h={}){const p=$f(u,h);if(dy(e,p.name))return e[p.name];const f=new n(p,t);return e[p.name]=f,f}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const h=u.name,p=h.replace("-compat","");if(Cs(u)&&u.type==="PUBLIC"){const f=(v=r())=>{if(typeof v[p]!="function")throw xy.create("invalid-app-argument",{appName:h});return v[p]()};u.serviceProps!==void 0&&$c(f,u.serviceProps),t[p]=f,n.prototype[p]=function(...v){return this._getService.bind(this,h).apply(this,u.multipleInstances?v:[])}}return u.type==="PUBLIC"?t[p]:null}function l(u,h){return h==="serverAuth"?null:h}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(){const n=Pk(Ck);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:q0,extendNamespace:e,createSubscribe:pC,ErrorFactory:Tu,deepExtend:$c});function e(t){$c(n,t)}return n}const Rk=q0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy=new Bf("@firebase/app-compat"),Dk="@firebase/app-compat",Nk="0.2.35";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vk(n){Mn(Dk,Nk,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(k0()&&self.firebase!==void 0){wy.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&wy.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Iu=Rk;Vk();var Mk="firebase",Ok="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Iu.registerVersion(Mk,Ok,"app-compat");var Ey=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cr,H0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,x){function S(){}S.prototype=x.prototype,E.D=x.prototype,E.prototype=new S,E.prototype.constructor=E,E.C=function(A,P,R){for(var C=Array(arguments.length-2),Ut=2;Ut<arguments.length;Ut++)C[Ut-2]=arguments[Ut];return x.prototype[P].apply(A,C)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,x,S){S||(S=0);var A=Array(16);if(typeof x=="string")for(var P=0;16>P;++P)A[P]=x.charCodeAt(S++)|x.charCodeAt(S++)<<8|x.charCodeAt(S++)<<16|x.charCodeAt(S++)<<24;else for(P=0;16>P;++P)A[P]=x[S++]|x[S++]<<8|x[S++]<<16|x[S++]<<24;x=E.g[0],S=E.g[1],P=E.g[2];var R=E.g[3],C=x+(R^S&(P^R))+A[0]+3614090360&4294967295;x=S+(C<<7&4294967295|C>>>25),C=R+(P^x&(S^P))+A[1]+3905402710&4294967295,R=x+(C<<12&4294967295|C>>>20),C=P+(S^R&(x^S))+A[2]+606105819&4294967295,P=R+(C<<17&4294967295|C>>>15),C=S+(x^P&(R^x))+A[3]+3250441966&4294967295,S=P+(C<<22&4294967295|C>>>10),C=x+(R^S&(P^R))+A[4]+4118548399&4294967295,x=S+(C<<7&4294967295|C>>>25),C=R+(P^x&(S^P))+A[5]+1200080426&4294967295,R=x+(C<<12&4294967295|C>>>20),C=P+(S^R&(x^S))+A[6]+2821735955&4294967295,P=R+(C<<17&4294967295|C>>>15),C=S+(x^P&(R^x))+A[7]+4249261313&4294967295,S=P+(C<<22&4294967295|C>>>10),C=x+(R^S&(P^R))+A[8]+1770035416&4294967295,x=S+(C<<7&4294967295|C>>>25),C=R+(P^x&(S^P))+A[9]+2336552879&4294967295,R=x+(C<<12&4294967295|C>>>20),C=P+(S^R&(x^S))+A[10]+4294925233&4294967295,P=R+(C<<17&4294967295|C>>>15),C=S+(x^P&(R^x))+A[11]+2304563134&4294967295,S=P+(C<<22&4294967295|C>>>10),C=x+(R^S&(P^R))+A[12]+1804603682&4294967295,x=S+(C<<7&4294967295|C>>>25),C=R+(P^x&(S^P))+A[13]+4254626195&4294967295,R=x+(C<<12&4294967295|C>>>20),C=P+(S^R&(x^S))+A[14]+2792965006&4294967295,P=R+(C<<17&4294967295|C>>>15),C=S+(x^P&(R^x))+A[15]+1236535329&4294967295,S=P+(C<<22&4294967295|C>>>10),C=x+(P^R&(S^P))+A[1]+4129170786&4294967295,x=S+(C<<5&4294967295|C>>>27),C=R+(S^P&(x^S))+A[6]+3225465664&4294967295,R=x+(C<<9&4294967295|C>>>23),C=P+(x^S&(R^x))+A[11]+643717713&4294967295,P=R+(C<<14&4294967295|C>>>18),C=S+(R^x&(P^R))+A[0]+3921069994&4294967295,S=P+(C<<20&4294967295|C>>>12),C=x+(P^R&(S^P))+A[5]+3593408605&4294967295,x=S+(C<<5&4294967295|C>>>27),C=R+(S^P&(x^S))+A[10]+38016083&4294967295,R=x+(C<<9&4294967295|C>>>23),C=P+(x^S&(R^x))+A[15]+3634488961&4294967295,P=R+(C<<14&4294967295|C>>>18),C=S+(R^x&(P^R))+A[4]+3889429448&4294967295,S=P+(C<<20&4294967295|C>>>12),C=x+(P^R&(S^P))+A[9]+568446438&4294967295,x=S+(C<<5&4294967295|C>>>27),C=R+(S^P&(x^S))+A[14]+3275163606&4294967295,R=x+(C<<9&4294967295|C>>>23),C=P+(x^S&(R^x))+A[3]+4107603335&4294967295,P=R+(C<<14&4294967295|C>>>18),C=S+(R^x&(P^R))+A[8]+1163531501&4294967295,S=P+(C<<20&4294967295|C>>>12),C=x+(P^R&(S^P))+A[13]+2850285829&4294967295,x=S+(C<<5&4294967295|C>>>27),C=R+(S^P&(x^S))+A[2]+4243563512&4294967295,R=x+(C<<9&4294967295|C>>>23),C=P+(x^S&(R^x))+A[7]+1735328473&4294967295,P=R+(C<<14&4294967295|C>>>18),C=S+(R^x&(P^R))+A[12]+2368359562&4294967295,S=P+(C<<20&4294967295|C>>>12),C=x+(S^P^R)+A[5]+4294588738&4294967295,x=S+(C<<4&4294967295|C>>>28),C=R+(x^S^P)+A[8]+2272392833&4294967295,R=x+(C<<11&4294967295|C>>>21),C=P+(R^x^S)+A[11]+1839030562&4294967295,P=R+(C<<16&4294967295|C>>>16),C=S+(P^R^x)+A[14]+4259657740&4294967295,S=P+(C<<23&4294967295|C>>>9),C=x+(S^P^R)+A[1]+2763975236&4294967295,x=S+(C<<4&4294967295|C>>>28),C=R+(x^S^P)+A[4]+1272893353&4294967295,R=x+(C<<11&4294967295|C>>>21),C=P+(R^x^S)+A[7]+4139469664&4294967295,P=R+(C<<16&4294967295|C>>>16),C=S+(P^R^x)+A[10]+3200236656&4294967295,S=P+(C<<23&4294967295|C>>>9),C=x+(S^P^R)+A[13]+681279174&4294967295,x=S+(C<<4&4294967295|C>>>28),C=R+(x^S^P)+A[0]+3936430074&4294967295,R=x+(C<<11&4294967295|C>>>21),C=P+(R^x^S)+A[3]+3572445317&4294967295,P=R+(C<<16&4294967295|C>>>16),C=S+(P^R^x)+A[6]+76029189&4294967295,S=P+(C<<23&4294967295|C>>>9),C=x+(S^P^R)+A[9]+3654602809&4294967295,x=S+(C<<4&4294967295|C>>>28),C=R+(x^S^P)+A[12]+3873151461&4294967295,R=x+(C<<11&4294967295|C>>>21),C=P+(R^x^S)+A[15]+530742520&4294967295,P=R+(C<<16&4294967295|C>>>16),C=S+(P^R^x)+A[2]+3299628645&4294967295,S=P+(C<<23&4294967295|C>>>9),C=x+(P^(S|~R))+A[0]+4096336452&4294967295,x=S+(C<<6&4294967295|C>>>26),C=R+(S^(x|~P))+A[7]+1126891415&4294967295,R=x+(C<<10&4294967295|C>>>22),C=P+(x^(R|~S))+A[14]+2878612391&4294967295,P=R+(C<<15&4294967295|C>>>17),C=S+(R^(P|~x))+A[5]+4237533241&4294967295,S=P+(C<<21&4294967295|C>>>11),C=x+(P^(S|~R))+A[12]+1700485571&4294967295,x=S+(C<<6&4294967295|C>>>26),C=R+(S^(x|~P))+A[3]+2399980690&4294967295,R=x+(C<<10&4294967295|C>>>22),C=P+(x^(R|~S))+A[10]+4293915773&4294967295,P=R+(C<<15&4294967295|C>>>17),C=S+(R^(P|~x))+A[1]+2240044497&4294967295,S=P+(C<<21&4294967295|C>>>11),C=x+(P^(S|~R))+A[8]+1873313359&4294967295,x=S+(C<<6&4294967295|C>>>26),C=R+(S^(x|~P))+A[15]+4264355552&4294967295,R=x+(C<<10&4294967295|C>>>22),C=P+(x^(R|~S))+A[6]+2734768916&4294967295,P=R+(C<<15&4294967295|C>>>17),C=S+(R^(P|~x))+A[13]+1309151649&4294967295,S=P+(C<<21&4294967295|C>>>11),C=x+(P^(S|~R))+A[4]+4149444226&4294967295,x=S+(C<<6&4294967295|C>>>26),C=R+(S^(x|~P))+A[11]+3174756917&4294967295,R=x+(C<<10&4294967295|C>>>22),C=P+(x^(R|~S))+A[2]+718787259&4294967295,P=R+(C<<15&4294967295|C>>>17),C=S+(R^(P|~x))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+x&4294967295,E.g[1]=E.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,E.g[2]=E.g[2]+P&4294967295,E.g[3]=E.g[3]+R&4294967295}i.prototype.u=function(E,x){x===void 0&&(x=E.length);for(var S=x-this.blockSize,A=this.B,P=this.h,R=0;R<x;){if(P==0)for(;R<=S;)r(this,E,R),R+=this.blockSize;if(typeof E=="string"){for(;R<x;)if(A[P++]=E.charCodeAt(R++),P==this.blockSize){r(this,A),P=0;break}}else for(;R<x;)if(A[P++]=E[R++],P==this.blockSize){r(this,A),P=0;break}}this.h=P,this.o+=x},i.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var x=1;x<E.length-8;++x)E[x]=0;var S=8*this.o;for(x=E.length-8;x<E.length;++x)E[x]=S&255,S/=256;for(this.u(E),E=Array(16),x=S=0;4>x;++x)for(var A=0;32>A;A+=8)E[S++]=this.g[x]>>>A&255;return E};function s(E,x){var S=a;return Object.prototype.hasOwnProperty.call(S,E)?S[E]:S[E]=x(E)}function o(E,x){this.h=x;for(var S=[],A=!0,P=E.length-1;0<=P;P--){var R=E[P]|0;A&&R==x||(S[P]=R,A=!1)}this.g=S}var a={};function l(E){return-128<=E&&128>E?s(E,function(x){return new o([x|0],0>x?-1:0)}):new o([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return T(u(-E));for(var x=[],S=1,A=0;E>=S;A++)x[A]=E/S|0,S*=4294967296;return new o(x,0)}function h(E,x){if(E.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(E.charAt(0)=="-")return T(h(E.substring(1),x));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(x,8)),A=p,P=0;P<E.length;P+=8){var R=Math.min(8,E.length-P),C=parseInt(E.substring(P,P+R),x);8>R?(R=u(Math.pow(x,R)),A=A.j(R).add(u(C))):(A=A.j(S),A=A.add(u(C)))}return A}var p=l(0),f=l(1),v=l(16777216);n=o.prototype,n.m=function(){if(b(this))return-T(this).m();for(var E=0,x=1,S=0;S<this.g.length;S++){var A=this.i(S);E+=(0<=A?A:4294967296+A)*x,x*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(I(this))return"0";if(b(this))return"-"+T(this).toString(E);for(var x=u(Math.pow(E,6)),S=this,A="";;){var P=k(S,x).g;S=y(S,P.j(x));var R=((0<S.g.length?S.g[0]:S.h)>>>0).toString(E);if(S=P,I(S))return R+A;for(;6>R.length;)R="0"+R;A=R+A}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function I(E){if(E.h!=0)return!1;for(var x=0;x<E.g.length;x++)if(E.g[x]!=0)return!1;return!0}function b(E){return E.h==-1}n.l=function(E){return E=y(this,E),b(E)?-1:I(E)?0:1};function T(E){for(var x=E.g.length,S=[],A=0;A<x;A++)S[A]=~E.g[A];return new o(S,~E.h).add(f)}n.abs=function(){return b(this)?T(this):this},n.add=function(E){for(var x=Math.max(this.g.length,E.g.length),S=[],A=0,P=0;P<=x;P++){var R=A+(this.i(P)&65535)+(E.i(P)&65535),C=(R>>>16)+(this.i(P)>>>16)+(E.i(P)>>>16);A=C>>>16,R&=65535,C&=65535,S[P]=C<<16|R}return new o(S,S[S.length-1]&-2147483648?-1:0)};function y(E,x){return E.add(T(x))}n.j=function(E){if(I(this)||I(E))return p;if(b(this))return b(E)?T(this).j(T(E)):T(T(this).j(E));if(b(E))return T(this.j(T(E)));if(0>this.l(v)&&0>E.l(v))return u(this.m()*E.m());for(var x=this.g.length+E.g.length,S=[],A=0;A<2*x;A++)S[A]=0;for(A=0;A<this.g.length;A++)for(var P=0;P<E.g.length;P++){var R=this.i(A)>>>16,C=this.i(A)&65535,Ut=E.i(P)>>>16,Ui=E.i(P)&65535;S[2*A+2*P]+=C*Ui,g(S,2*A+2*P),S[2*A+2*P+1]+=R*Ui,g(S,2*A+2*P+1),S[2*A+2*P+1]+=C*Ut,g(S,2*A+2*P+1),S[2*A+2*P+2]+=R*Ut,g(S,2*A+2*P+2)}for(A=0;A<x;A++)S[A]=S[2*A+1]<<16|S[2*A];for(A=x;A<2*x;A++)S[A]=0;return new o(S,0)};function g(E,x){for(;(E[x]&65535)!=E[x];)E[x+1]+=E[x]>>>16,E[x]&=65535,x++}function w(E,x){this.g=E,this.h=x}function k(E,x){if(I(x))throw Error("division by zero");if(I(E))return new w(p,p);if(b(E))return x=k(T(E),x),new w(T(x.g),T(x.h));if(b(x))return x=k(E,T(x)),new w(T(x.g),x.h);if(30<E.g.length){if(b(E)||b(x))throw Error("slowDivide_ only works with positive integers.");for(var S=f,A=x;0>=A.l(E);)S=N(S),A=N(A);var P=M(S,1),R=M(A,1);for(A=M(A,2),S=M(S,2);!I(A);){var C=R.add(A);0>=C.l(E)&&(P=P.add(S),R=C),A=M(A,1),S=M(S,1)}return x=y(E,P.j(x)),new w(P,x)}for(P=p;0<=E.l(x);){for(S=Math.max(1,Math.floor(E.m()/x.m())),A=Math.ceil(Math.log(S)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),R=u(S),C=R.j(x);b(C)||0<C.l(E);)S-=A,R=u(S),C=R.j(x);I(R)&&(R=f),P=P.add(R),E=y(E,C)}return new w(P,E)}n.A=function(E){return k(this,E).h},n.and=function(E){for(var x=Math.max(this.g.length,E.g.length),S=[],A=0;A<x;A++)S[A]=this.i(A)&E.i(A);return new o(S,this.h&E.h)},n.or=function(E){for(var x=Math.max(this.g.length,E.g.length),S=[],A=0;A<x;A++)S[A]=this.i(A)|E.i(A);return new o(S,this.h|E.h)},n.xor=function(E){for(var x=Math.max(this.g.length,E.g.length),S=[],A=0;A<x;A++)S[A]=this.i(A)^E.i(A);return new o(S,this.h^E.h)};function N(E){for(var x=E.g.length+1,S=[],A=0;A<x;A++)S[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(S,E.h)}function M(E,x){var S=x>>5;x%=32;for(var A=E.g.length-S,P=[],R=0;R<A;R++)P[R]=0<x?E.i(R+S)>>>x|E.i(R+S+1)<<32-x:E.i(R+S);return new o(P,E.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,H0=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,cr=o}).apply(typeof Ey<"u"?Ey:typeof self<"u"?self:typeof window<"u"?window:{});var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var G0,K0,Lo,Q0,ic,hp,W0,X0,Y0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,m){return c==Array.prototype||c==Object.prototype||(c[d]=m.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof jl=="object"&&jl];for(var d=0;d<c.length;++d){var m=c[d];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=t(this);function r(c,d){if(d)e:{var m=i;c=c.split(".");for(var _=0;_<c.length-1;_++){var D=c[_];if(!(D in m))break e;m=m[D]}c=c[c.length-1],_=m[c],d=d(_),d!=_&&d!=null&&e(m,c,{configurable:!0,writable:!0,value:d})}}function s(c,d){c instanceof String&&(c+="");var m=0,_=!1,D={next:function(){if(!_&&m<c.length){var L=m++;return{value:d(L,c[L]),done:!1}}return _=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}r("Array.prototype.values",function(c){return c||function(){return s(this,function(d,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function u(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function h(c,d,m){return c.call.apply(c.bind,arguments)}function p(c,d,m){if(!c)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,_),c.apply(d,D)}}return function(){return c.apply(d,arguments)}}function f(c,d,m){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,f.apply(null,arguments)}function v(c,d){var m=Array.prototype.slice.call(arguments,1);return function(){var _=m.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function I(c,d){function m(){}m.prototype=d.prototype,c.aa=d.prototype,c.prototype=new m,c.prototype.constructor=c,c.Qb=function(_,D,L){for(var z=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)z[fe-2]=arguments[fe];return d.prototype[D].apply(_,z)}}function b(c){const d=c.length;if(0<d){const m=Array(d);for(let _=0;_<d;_++)m[_]=c[_];return m}return[]}function T(c,d){for(let m=1;m<arguments.length;m++){const _=arguments[m];if(l(_)){const D=c.length||0,L=_.length||0;c.length=D+L;for(let z=0;z<L;z++)c[D+z]=_[z]}else c.push(_)}}class y{constructor(d,m){this.i=d,this.j=m,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function g(c){return/^[\s\xa0]*$/.test(c)}function w(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function k(c){return k[" "](c),c}k[" "]=function(){};var N=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function M(c,d,m){for(const _ in c)d.call(m,c[_],_,c)}function E(c,d){for(const m in c)d.call(void 0,c[m],m,c)}function x(c){const d={};for(const m in c)d[m]=c[m];return d}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(c,d){let m,_;for(let D=1;D<arguments.length;D++){_=arguments[D];for(m in _)c[m]=_[m];for(let L=0;L<S.length;L++)m=S[L],Object.prototype.hasOwnProperty.call(_,m)&&(c[m]=_[m])}}function P(c){var d=1;c=c.split(":");const m=[];for(;0<d&&c.length;)m.push(c.shift()),d--;return c.length&&m.push(c.join(":")),m}function R(c){a.setTimeout(()=>{throw c},0)}function C(){var c=J;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class Ut{constructor(){this.h=this.g=null}add(d,m){const _=Ui.get();_.set(d,m),this.h?this.h.next=_:this.g=_,this.h=_}}var Ui=new y(()=>new Zs,c=>c.reset());class Zs{constructor(){this.next=this.g=this.h=null}set(d,m){this.h=d,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let wn,G=!1,J=new Ut,te=()=>{const c=a.Promise.resolve(void 0);wn=()=>{c.then(Se)}};var Se=()=>{for(var c;c=C();){try{c.h.call(c.g)}catch(m){R(m)}var d=Ui;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}G=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ve(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}Ve.prototype.h=function(){this.defaultPrevented=!0};var En=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const m=()=>{};a.addEventListener("test",m,d),a.removeEventListener("test",m,d)}catch{}return c}();function Tn(c,d){if(Ve.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var m=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(N){e:{try{k(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else m=="mouseover"?d=c.fromElement:m=="mouseout"&&(d=c.toElement);this.relatedTarget=d,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:In[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Tn.aa.h.call(this)}}I(Tn,Ve);var In={2:"touch",3:"pen",4:"mouse"};Tn.prototype.h=function(){Tn.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Sn="closure_listenable_"+(1e6*Math.random()|0),qI=0;function HI(c,d,m,_,D){this.listener=c,this.proxy=null,this.src=d,this.type=m,this.capture=!!_,this.ha=D,this.key=++qI,this.da=this.fa=!1}function sl(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ol(c){this.src=c,this.g={},this.h=0}ol.prototype.add=function(c,d,m,_,D){var L=c.toString();c=this.g[L],c||(c=this.g[L]=[],this.h++);var z=Ju(c,d,_,D);return-1<z?(d=c[z],m||(d.fa=!1)):(d=new HI(d,this.src,L,!!_,D),d.fa=m,c.push(d)),d};function Yu(c,d){var m=d.type;if(m in c.g){var _=c.g[m],D=Array.prototype.indexOf.call(_,d,void 0),L;(L=0<=D)&&Array.prototype.splice.call(_,D,1),L&&(sl(d),c.g[m].length==0&&(delete c.g[m],c.h--))}}function Ju(c,d,m,_){for(var D=0;D<c.length;++D){var L=c[D];if(!L.da&&L.listener==d&&L.capture==!!m&&L.ha==_)return D}return-1}var Zu="closure_lm_"+(1e6*Math.random()|0),eh={};function Xm(c,d,m,_,D){if(Array.isArray(d)){for(var L=0;L<d.length;L++)Xm(c,d[L],m,_,D);return null}return m=Zm(m),c&&c[Sn]?c.K(d,m,u(_)?!!_.capture:!!_,D):GI(c,d,m,!1,_,D)}function GI(c,d,m,_,D,L){if(!d)throw Error("Invalid event type");var z=u(D)?!!D.capture:!!D,fe=nh(c);if(fe||(c[Zu]=fe=new ol(c)),m=fe.add(d,m,_,z,L),m.proxy)return m;if(_=KI(),m.proxy=_,_.src=c,_.listener=m,c.addEventListener)En||(D=z),D===void 0&&(D=!1),c.addEventListener(d.toString(),_,D);else if(c.attachEvent)c.attachEvent(Jm(d.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return m}function KI(){function c(m){return d.call(c.src,c.listener,m)}const d=QI;return c}function Ym(c,d,m,_,D){if(Array.isArray(d))for(var L=0;L<d.length;L++)Ym(c,d[L],m,_,D);else _=u(_)?!!_.capture:!!_,m=Zm(m),c&&c[Sn]?(c=c.i,d=String(d).toString(),d in c.g&&(L=c.g[d],m=Ju(L,m,_,D),-1<m&&(sl(L[m]),Array.prototype.splice.call(L,m,1),L.length==0&&(delete c.g[d],c.h--)))):c&&(c=nh(c))&&(d=c.g[d.toString()],c=-1,d&&(c=Ju(d,m,_,D)),(m=-1<c?d[c]:null)&&th(m))}function th(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[Sn])Yu(d.i,c);else{var m=c.type,_=c.proxy;d.removeEventListener?d.removeEventListener(m,_,c.capture):d.detachEvent?d.detachEvent(Jm(m),_):d.addListener&&d.removeListener&&d.removeListener(_),(m=nh(d))?(Yu(m,c),m.h==0&&(m.src=null,d[Zu]=null)):sl(c)}}}function Jm(c){return c in eh?eh[c]:eh[c]="on"+c}function QI(c,d){if(c.da)c=!0;else{d=new Tn(d,this);var m=c.listener,_=c.ha||c.src;c.fa&&th(c),c=m.call(_,d)}return c}function nh(c){return c=c[Zu],c instanceof ol?c:null}var ih="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zm(c){return typeof c=="function"?c:(c[ih]||(c[ih]=function(d){return c.handleEvent(d)}),c[ih])}function rt(){pe.call(this),this.i=new ol(this),this.M=this,this.F=null}I(rt,pe),rt.prototype[Sn]=!0,rt.prototype.removeEventListener=function(c,d,m,_){Ym(this,c,d,m,_)};function dt(c,d){var m,_=c.F;if(_)for(m=[];_;_=_.F)m.push(_);if(c=c.M,_=d.type||d,typeof d=="string")d=new Ve(d,c);else if(d instanceof Ve)d.target=d.target||c;else{var D=d;d=new Ve(_,c),A(d,D)}if(D=!0,m)for(var L=m.length-1;0<=L;L--){var z=d.g=m[L];D=al(z,_,!0,d)&&D}if(z=d.g=c,D=al(z,_,!0,d)&&D,D=al(z,_,!1,d)&&D,m)for(L=0;L<m.length;L++)z=d.g=m[L],D=al(z,_,!1,d)&&D}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var m=c.g[d],_=0;_<m.length;_++)sl(m[_]);delete c.g[d],c.h--}}this.F=null},rt.prototype.K=function(c,d,m,_){return this.i.add(String(c),d,!1,m,_)},rt.prototype.L=function(c,d,m,_){return this.i.add(String(c),d,!0,m,_)};function al(c,d,m,_){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,L=0;L<d.length;++L){var z=d[L];if(z&&!z.da&&z.capture==m){var fe=z.listener,Je=z.ha||z.src;z.fa&&Yu(c.i,z),D=fe.call(Je,_)!==!1&&D}}return D&&!_.defaultPrevented}function eg(c,d,m){if(typeof c=="function")m&&(c=f(c,m));else if(c&&typeof c.handleEvent=="function")c=f(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function tg(c){c.g=eg(()=>{c.g=null,c.i&&(c.i=!1,tg(c))},c.l);const d=c.h;c.h=null,c.m.apply(null,d)}class WI extends pe{constructor(d,m){super(),this.m=d,this.l=m,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:tg(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eo(c){pe.call(this),this.h=c,this.g={}}I(eo,pe);var ng=[];function ig(c){M(c.g,function(d,m){this.g.hasOwnProperty(m)&&th(d)},c),c.g={}}eo.prototype.N=function(){eo.aa.N.call(this),ig(this)},eo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rh=a.JSON.stringify,XI=a.JSON.parse,YI=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function sh(){}sh.prototype.h=null;function rg(c){return c.h||(c.h=c.i())}function sg(){}var to={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function oh(){Ve.call(this,"d")}I(oh,Ve);function ah(){Ve.call(this,"c")}I(ah,Ve);var zi={},og=null;function ll(){return og=og||new rt}zi.La="serverreachability";function ag(c){Ve.call(this,zi.La,c)}I(ag,Ve);function no(c){const d=ll();dt(d,new ag(d))}zi.STAT_EVENT="statevent";function lg(c,d){Ve.call(this,zi.STAT_EVENT,c),this.stat=d}I(lg,Ve);function pt(c){const d=ll();dt(d,new lg(d,c))}zi.Ma="timingevent";function cg(c,d){Ve.call(this,zi.Ma,c),this.size=d}I(cg,Ve);function io(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function ro(){this.g=!0}ro.prototype.xa=function(){this.g=!1};function JI(c,d,m,_,D,L){c.info(function(){if(c.g)if(L)for(var z="",fe=L.split("&"),Je=0;Je<fe.length;Je++){var ce=fe[Je].split("=");if(1<ce.length){var st=ce[0];ce=ce[1];var ot=st.split("_");z=2<=ot.length&&ot[1]=="type"?z+(st+"="+ce+"&"):z+(st+"=redacted&")}}else z=null;else z=L;return"XMLHTTP REQ ("+_+") [attempt "+D+"]: "+d+`
`+m+`
`+z})}function ZI(c,d,m,_,D,L,z){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+D+"]: "+d+`
`+m+`
`+L+" "+z})}function Or(c,d,m,_){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+tS(c,m)+(_?" "+_:"")})}function eS(c,d){c.info(function(){return"TIMEOUT: "+d})}ro.prototype.info=function(){};function tS(c,d){if(!c.g)return d;if(!d)return null;try{var m=JSON.parse(d);if(m){for(c=0;c<m.length;c++)if(Array.isArray(m[c])){var _=m[c];if(!(2>_.length)){var D=_[1];if(Array.isArray(D)&&!(1>D.length)){var L=D[0];if(L!="noop"&&L!="stop"&&L!="close")for(var z=1;z<D.length;z++)D[z]=""}}}}return rh(m)}catch{return d}}var cl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ug={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},lh;function ul(){}I(ul,sh),ul.prototype.g=function(){return new XMLHttpRequest},ul.prototype.i=function(){return{}},lh=new ul;function Gn(c,d,m,_){this.j=c,this.i=d,this.l=m,this.R=_||1,this.U=new eo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new hg}function hg(){this.i=null,this.g="",this.h=!1}var dg={},ch={};function uh(c,d,m){c.L=1,c.v=fl(An(d)),c.m=m,c.P=!0,pg(c,null)}function pg(c,d){c.F=Date.now(),hl(c),c.A=An(c.v);var m=c.A,_=c.R;Array.isArray(_)||(_=[String(_)]),bg(m.i,"t",_),c.C=0,m=c.j.J,c.h=new hg,c.g=Hg(c.j,m?d:null,!c.m),0<c.O&&(c.M=new WI(f(c.Y,c,c.g),c.O)),d=c.U,m=c.g,_=c.ca;var D="readystatechange";Array.isArray(D)||(D&&(ng[0]=D.toString()),D=ng);for(var L=0;L<D.length;L++){var z=Xm(m,D[L],_||d.handleEvent,!1,d.h||d);if(!z)break;d.g[z.key]=z}d=c.H?x(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),no(),JI(c.i,c.u,c.A,c.l,c.R,c.m)}Gn.prototype.ca=function(c){c=c.target;const d=this.M;d&&bn(c)==3?d.j():this.Y(c)},Gn.prototype.Y=function(c){try{if(c==this.g)e:{const ot=bn(this.g);var d=this.g.Ba();const jr=this.g.Z();if(!(3>ot)&&(ot!=3||this.g&&(this.h.h||this.g.oa()||Vg(this.g)))){this.J||ot!=4||d==7||(d==8||0>=jr?no(3):no(2)),hh(this);var m=this.g.Z();this.X=m;t:if(fg(this)){var _=Vg(this.g);c="";var D=_.length,L=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$i(this),so(this);var z="";break t}this.h.i=new a.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,c+=this.h.i.decode(_[d],{stream:!(L&&d==D-1)});_.length=0,this.h.g+=c,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=m==200,ZI(this.i,this.u,this.A,this.l,this.R,ot,m),this.o){if(this.T&&!this.K){t:{if(this.g){var fe,Je=this.g;if((fe=Je.g?Je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!g(fe)){var ce=fe;break t}}ce=null}if(m=ce)Or(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dh(this,m);else{this.o=!1,this.s=3,pt(12),$i(this),so(this);break e}}if(this.P){m=!0;let Xt;for(;!this.J&&this.C<z.length;)if(Xt=nS(this,z),Xt==ch){ot==4&&(this.s=4,pt(14),m=!1),Or(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==dg){this.s=4,pt(15),Or(this.i,this.l,z,"[Invalid Chunk]"),m=!1;break}else Or(this.i,this.l,Xt,null),dh(this,Xt);if(fg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||z.length!=0||this.h.h||(this.s=1,pt(16),m=!1),this.o=this.o&&m,!m)Or(this.i,this.l,z,"[Invalid Chunked Response]"),$i(this),so(this);else if(0<z.length&&!this.W){this.W=!0;var st=this.j;st.g==this&&st.ba&&!st.M&&(st.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),yh(st),st.M=!0,pt(11))}}else Or(this.i,this.l,z,null),dh(this,z);ot==4&&$i(this),this.o&&!this.J&&(ot==4?Ug(this.j,this):(this.o=!1,hl(this)))}else _S(this.g),m==400&&0<z.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),$i(this),so(this)}}}catch{}finally{}};function fg(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function nS(c,d){var m=c.C,_=d.indexOf(`
`,m);return _==-1?ch:(m=Number(d.substring(m,_)),isNaN(m)?dg:(_+=1,_+m>d.length?ch:(d=d.slice(_,_+m),c.C=_+m,d)))}Gn.prototype.cancel=function(){this.J=!0,$i(this)};function hl(c){c.S=Date.now()+c.I,mg(c,c.I)}function mg(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=io(f(c.ba,c),d)}function hh(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Gn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(eS(this.i,this.A),this.L!=2&&(no(),pt(17)),$i(this),this.s=2,so(this)):mg(this,this.S-c)};function so(c){c.j.G==0||c.J||Ug(c.j,c)}function $i(c){hh(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,ig(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function dh(c,d){try{var m=c.j;if(m.G!=0&&(m.g==c||ph(m.h,c))){if(!c.K&&ph(m.h,c)&&m.G==3){try{var _=m.Da.g.parse(d)}catch{_=null}if(Array.isArray(_)&&_.length==3){var D=_;if(D[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<c.F)_l(m),vl(m);else break e;vh(m),pt(18)}}else m.za=D[1],0<m.za-m.T&&37500>D[2]&&m.F&&m.v==0&&!m.C&&(m.C=io(f(m.Za,m),6e3));if(1>=yg(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Hi(m,11)}else if((c.K||m.g==c)&&_l(m),!g(d))for(D=m.Da.g.parse(d),d=0;d<D.length;d++){let ce=D[d];if(m.T=ce[0],ce=ce[1],m.G==2)if(ce[0]=="c"){m.K=ce[1],m.ia=ce[2];const st=ce[3];st!=null&&(m.la=st,m.j.info("VER="+m.la));const ot=ce[4];ot!=null&&(m.Aa=ot,m.j.info("SVER="+m.Aa));const jr=ce[5];jr!=null&&typeof jr=="number"&&0<jr&&(_=1.5*jr,m.L=_,m.j.info("backChannelRequestTimeoutMs_="+_)),_=m;const Xt=c.g;if(Xt){const wl=Xt.g?Xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wl){var L=_.h;L.g||wl.indexOf("spdy")==-1&&wl.indexOf("quic")==-1&&wl.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(fh(L,L.h),L.h=null))}if(_.D){const _h=Xt.g?Xt.g.getResponseHeader("X-HTTP-Session-Id"):null;_h&&(_.ya=_h,ve(_.I,_.D,_h))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-c.F,m.j.info("Handshake RTT: "+m.R+"ms")),_=m;var z=c;if(_.qa=qg(_,_.J?_.ia:null,_.W),z.K){_g(_.h,z);var fe=z,Je=_.L;Je&&(fe.I=Je),fe.B&&(hh(fe),hl(fe)),_.g=z}else jg(_);0<m.i.length&&yl(m)}else ce[0]!="stop"&&ce[0]!="close"||Hi(m,7);else m.G==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?Hi(m,7):gh(m):ce[0]!="noop"&&m.l&&m.l.ta(ce),m.v=0)}}no(4)}catch{}}var iS=class{constructor(c,d){this.g=c,this.map=d}};function gg(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function vg(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function yg(c){return c.h?1:c.g?c.g.size:0}function ph(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function fh(c,d){c.g?c.g.add(d):c.h=d}function _g(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}gg.prototype.cancel=function(){if(this.i=xg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function xg(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(const m of c.g.values())d=d.concat(m.D);return d}return b(c.i)}function rS(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var d=[],m=c.length,_=0;_<m;_++)d.push(c[_]);return d}d=[],m=0;for(_ in c)d[m++]=c[_];return d}function sS(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var d=[];c=c.length;for(var m=0;m<c;m++)d.push(m);return d}d=[],m=0;for(const _ in c)d[m++]=_;return d}}}function wg(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var m=sS(c),_=rS(c),D=_.length,L=0;L<D;L++)d.call(void 0,_[L],m&&m[L],c)}var Eg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oS(c,d){if(c){c=c.split("&");for(var m=0;m<c.length;m++){var _=c[m].indexOf("="),D=null;if(0<=_){var L=c[m].substring(0,_);D=c[m].substring(_+1)}else L=c[m];d(L,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function qi(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof qi){this.h=c.h,dl(this,c.j),this.o=c.o,this.g=c.g,pl(this,c.s),this.l=c.l;var d=c.i,m=new lo;m.i=d.i,d.g&&(m.g=new Map(d.g),m.h=d.h),Tg(this,m),this.m=c.m}else c&&(d=String(c).match(Eg))?(this.h=!1,dl(this,d[1]||"",!0),this.o=oo(d[2]||""),this.g=oo(d[3]||"",!0),pl(this,d[4]),this.l=oo(d[5]||"",!0),Tg(this,d[6]||"",!0),this.m=oo(d[7]||"")):(this.h=!1,this.i=new lo(null,this.h))}qi.prototype.toString=function(){var c=[],d=this.j;d&&c.push(ao(d,Ig,!0),":");var m=this.g;return(m||d=="file")&&(c.push("//"),(d=this.o)&&c.push(ao(d,Ig,!0),"@"),c.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&c.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&c.push("/"),c.push(ao(m,m.charAt(0)=="/"?cS:lS,!0))),(m=this.i.toString())&&c.push("?",m),(m=this.m)&&c.push("#",ao(m,hS)),c.join("")};function An(c){return new qi(c)}function dl(c,d,m){c.j=m?oo(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function pl(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function Tg(c,d,m){d instanceof lo?(c.i=d,dS(c.i,c.h)):(m||(d=ao(d,uS)),c.i=new lo(d,c.h))}function ve(c,d,m){c.i.set(d,m)}function fl(c){return ve(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function oo(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ao(c,d,m){return typeof c=="string"?(c=encodeURI(c).replace(d,aS),m&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function aS(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Ig=/[#\/\?@]/g,lS=/[#\?:]/g,cS=/[#\?]/g,uS=/[#\?@]/g,hS=/#/g;function lo(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function Kn(c){c.g||(c.g=new Map,c.h=0,c.i&&oS(c.i,function(d,m){c.add(decodeURIComponent(d.replace(/\+/g," ")),m)}))}n=lo.prototype,n.add=function(c,d){Kn(this),this.i=null,c=Lr(this,c);var m=this.g.get(c);return m||this.g.set(c,m=[]),m.push(d),this.h+=1,this};function Sg(c,d){Kn(c),d=Lr(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function Ag(c,d){return Kn(c),d=Lr(c,d),c.g.has(d)}n.forEach=function(c,d){Kn(this),this.g.forEach(function(m,_){m.forEach(function(D){c.call(d,D,_,this)},this)},this)},n.na=function(){Kn(this);const c=Array.from(this.g.values()),d=Array.from(this.g.keys()),m=[];for(let _=0;_<d.length;_++){const D=c[_];for(let L=0;L<D.length;L++)m.push(d[_])}return m},n.V=function(c){Kn(this);let d=[];if(typeof c=="string")Ag(this,c)&&(d=d.concat(this.g.get(Lr(this,c))));else{c=Array.from(this.g.values());for(let m=0;m<c.length;m++)d=d.concat(c[m])}return d},n.set=function(c,d){return Kn(this),this.i=null,c=Lr(this,c),Ag(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},n.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function bg(c,d,m){Sg(c,d),0<m.length&&(c.i=null,c.g.set(Lr(c,d),b(m)),c.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],d=Array.from(this.g.keys());for(var m=0;m<d.length;m++){var _=d[m];const L=encodeURIComponent(String(_)),z=this.V(_);for(_=0;_<z.length;_++){var D=L;z[_]!==""&&(D+="="+encodeURIComponent(String(z[_]))),c.push(D)}}return this.i=c.join("&")};function Lr(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function dS(c,d){d&&!c.j&&(Kn(c),c.i=null,c.g.forEach(function(m,_){var D=_.toLowerCase();_!=D&&(Sg(this,_),bg(this,D,m))},c)),c.j=d}function pS(c,d){const m=new ro;if(a.Image){const _=new Image;_.onload=v(Qn,m,"TestLoadImage: loaded",!0,d,_),_.onerror=v(Qn,m,"TestLoadImage: error",!1,d,_),_.onabort=v(Qn,m,"TestLoadImage: abort",!1,d,_),_.ontimeout=v(Qn,m,"TestLoadImage: timeout",!1,d,_),a.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else d(!1)}function fS(c,d){const m=new ro,_=new AbortController,D=setTimeout(()=>{_.abort(),Qn(m,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:_.signal}).then(L=>{clearTimeout(D),L.ok?Qn(m,"TestPingServer: ok",!0,d):Qn(m,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),Qn(m,"TestPingServer: error",!1,d)})}function Qn(c,d,m,_,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),_(m)}catch{}}function mS(){this.g=new YI}function gS(c,d,m){const _=m||"";try{wg(c,function(D,L){let z=D;u(D)&&(z=rh(D)),d.push(_+L+"="+encodeURIComponent(z))})}catch(D){throw d.push(_+"type="+encodeURIComponent("_badmap")),D}}function co(c){this.l=c.Ub||null,this.j=c.eb||!1}I(co,sh),co.prototype.g=function(){return new ml(this.l,this.j)},co.prototype.i=function(c){return function(){return c}}({});function ml(c,d){rt.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(ml,rt),n=ml.prototype,n.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,ho(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uo(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ho(this)),this.g&&(this.readyState=3,ho(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cg(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cg(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?uo(this):ho(this),this.readyState==3&&Cg(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,uo(this))},n.Qa=function(c){this.g&&(this.response=c,uo(this))},n.ga=function(){this.g&&uo(this)};function uo(c){c.readyState=4,c.l=null,c.j=null,c.v=null,ho(c)}n.setRequestHeader=function(c,d){this.u.append(c,d)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],d=this.h.entries();for(var m=d.next();!m.done;)m=m.value,c.push(m[0]+": "+m[1]),m=d.next();return c.join(`\r
`)};function ho(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ml.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function kg(c){let d="";return M(c,function(m,_){d+=_,d+=":",d+=m,d+=`\r
`}),d}function mh(c,d,m){e:{for(_ in m){var _=!1;break e}_=!0}_||(m=kg(m),typeof c=="string"?m!=null&&encodeURIComponent(String(m)):ve(c,d,m))}function Pe(c){rt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(Pe,rt);var vS=/^https?$/i,yS=["POST","PUT"];n=Pe.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,d,m,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():lh.g(),this.v=this.o?rg(this.o):rg(lh),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(L){Pg(this,L);return}if(c=m||"",m=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var D in _)m.set(D,_[D]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const L of _.keys())m.set(L,_.get(L));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(m.keys()).find(L=>L.toLowerCase()=="content-type"),D=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(yS,d,void 0))||_||D||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,z]of m)this.g.setRequestHeader(L,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ng(this),this.u=!0,this.g.send(c),this.u=!1}catch(L){Pg(this,L)}};function Pg(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,Rg(c),gl(c)}function Rg(c){c.A||(c.A=!0,dt(c,"complete"),dt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,dt(this,"complete"),dt(this,"abort"),gl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gl(this,!0)),Pe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Dg(this):this.bb())},n.bb=function(){Dg(this)};function Dg(c){if(c.h&&typeof o<"u"&&(!c.v[1]||bn(c)!=4||c.Z()!=2)){if(c.u&&bn(c)==4)eg(c.Ea,0,c);else if(dt(c,"readystatechange"),bn(c)==4){c.h=!1;try{const z=c.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var m;if(!(m=d)){var _;if(_=z===0){var D=String(c.D).match(Eg)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),_=!vS.test(D?D.toLowerCase():"")}m=_}if(m)dt(c,"complete"),dt(c,"success");else{c.m=6;try{var L=2<bn(c)?c.g.statusText:""}catch{L=""}c.l=L+" ["+c.Z()+"]",Rg(c)}}finally{gl(c)}}}}function gl(c,d){if(c.g){Ng(c);const m=c.g,_=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||dt(c,"ready");try{m.onreadystatechange=_}catch{}}}function Ng(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function bn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),XI(d)}};function Vg(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function _S(c){const d={};c=(c.g&&2<=bn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(g(c[_]))continue;var m=P(c[_]);const D=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const L=d[D]||[];d[D]=L,L.push(m)}E(d,function(_){return _.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function po(c,d,m){return m&&m.internalChannelParams&&m.internalChannelParams[c]||d}function Mg(c){this.Aa=0,this.i=[],this.j=new ro,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=po("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=po("baseRetryDelayMs",5e3,c),this.cb=po("retryDelaySeedMs",1e4,c),this.Wa=po("forwardChannelMaxRetries",2,c),this.wa=po("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new gg(c&&c.concurrentRequestLimit),this.Da=new mS,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Mg.prototype,n.la=8,n.G=1,n.connect=function(c,d,m,_){pt(0),this.W=c,this.H=d||{},m&&_!==void 0&&(this.H.OSID=m,this.H.OAID=_),this.F=this.X,this.I=qg(this,null,this.W),yl(this)};function gh(c){if(Og(c),c.G==3){var d=c.U++,m=An(c.I);if(ve(m,"SID",c.K),ve(m,"RID",d),ve(m,"TYPE","terminate"),fo(c,m),d=new Gn(c,c.j,d),d.L=2,d.v=fl(An(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=d.v,m=!0),m||(d.g=Hg(d.j,null),d.g.ea(d.v)),d.F=Date.now(),hl(d)}$g(c)}function vl(c){c.g&&(yh(c),c.g.cancel(),c.g=null)}function Og(c){vl(c),c.u&&(a.clearTimeout(c.u),c.u=null),_l(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function yl(c){if(!vg(c.h)&&!c.s){c.s=!0;var d=c.Ga;wn||te(),G||(wn(),G=!0),J.add(d,c),c.B=0}}function xS(c,d){return yg(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=io(f(c.Ga,c,d),zg(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const D=new Gn(this,this.j,c);let L=this.o;if(this.S&&(L?(L=x(L),A(L,this.S)):L=this.S),this.m!==null||this.O||(D.H=L,L=null),this.P)e:{for(var d=0,m=0;m<this.i.length;m++){t:{var _=this.i[m];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(d+=_,4096<d){d=m;break e}if(d===4096||m===this.i.length-1){d=m+1;break e}}d=1e3}else d=1e3;d=Fg(this,D,d),m=An(this.I),ve(m,"RID",c),ve(m,"CVER",22),this.D&&ve(m,"X-HTTP-Session-Id",this.D),fo(this,m),L&&(this.O?d="headers="+encodeURIComponent(String(kg(L)))+"&"+d:this.m&&mh(m,this.m,L)),fh(this.h,D),this.Ua&&ve(m,"TYPE","init"),this.P?(ve(m,"$req",d),ve(m,"SID","null"),D.T=!0,uh(D,m,null)):uh(D,m,d),this.G=2}}else this.G==3&&(c?Lg(this,c):this.i.length==0||vg(this.h)||Lg(this))};function Lg(c,d){var m;d?m=d.l:m=c.U++;const _=An(c.I);ve(_,"SID",c.K),ve(_,"RID",m),ve(_,"AID",c.T),fo(c,_),c.m&&c.o&&mh(_,c.m,c.o),m=new Gn(c,c.j,m,c.B+1),c.m===null&&(m.H=c.o),d&&(c.i=d.D.concat(c.i)),d=Fg(c,m,1e3),m.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),fh(c.h,m),uh(m,_,d)}function fo(c,d){c.H&&M(c.H,function(m,_){ve(d,_,m)}),c.l&&wg({},function(m,_){ve(d,_,m)})}function Fg(c,d,m){m=Math.min(c.i.length,m);var _=c.l?f(c.l.Na,c.l,c):null;e:{var D=c.i;let L=-1;for(;;){const z=["count="+m];L==-1?0<m?(L=D[0].g,z.push("ofs="+L)):L=0:z.push("ofs="+L);let fe=!0;for(let Je=0;Je<m;Je++){let ce=D[Je].g;const st=D[Je].map;if(ce-=L,0>ce)L=Math.max(0,D[Je].g-100),fe=!1;else try{gS(st,z,"req"+ce+"_")}catch{_&&_(st)}}if(fe){_=z.join("&");break e}}}return c=c.i.splice(0,m),d.D=c,_}function jg(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;wn||te(),G||(wn(),G=!0),J.add(d,c),c.v=0}}function vh(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=io(f(c.Fa,c),zg(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,Bg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=io(f(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),vl(this),Bg(this))};function yh(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Bg(c){c.g=new Gn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=An(c.qa);ve(d,"RID","rpc"),ve(d,"SID",c.K),ve(d,"AID",c.T),ve(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&ve(d,"TO",c.ja),ve(d,"TYPE","xmlhttp"),fo(c,d),c.m&&c.o&&mh(d,c.m,c.o),c.L&&(c.g.I=c.L);var m=c.g;c=c.ia,m.L=1,m.v=fl(An(d)),m.m=null,m.P=!0,pg(m,c)}n.Za=function(){this.C!=null&&(this.C=null,vl(this),vh(this),pt(19))};function _l(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Ug(c,d){var m=null;if(c.g==d){_l(c),yh(c),c.g=null;var _=2}else if(ph(c.h,d))m=d.D,_g(c.h,d),_=1;else return;if(c.G!=0){if(d.o)if(_==1){m=d.m?d.m.length:0,d=Date.now()-d.F;var D=c.B;_=ll(),dt(_,new cg(_,m)),yl(c)}else jg(c);else if(D=d.s,D==3||D==0&&0<d.X||!(_==1&&xS(c,d)||_==2&&vh(c)))switch(m&&0<m.length&&(d=c.h,d.i=d.i.concat(m)),D){case 1:Hi(c,5);break;case 4:Hi(c,10);break;case 3:Hi(c,6);break;default:Hi(c,2)}}}function zg(c,d){let m=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(m*=2),m*d}function Hi(c,d){if(c.j.info("Error code "+d),d==2){var m=f(c.fb,c),_=c.Xa;const D=!_;_=new qi(_||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||dl(_,"https"),fl(_),D?pS(_.toString(),m):fS(_.toString(),m)}else pt(2);c.G=0,c.l&&c.l.sa(d),$g(c),Og(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function $g(c){if(c.G=0,c.ka=[],c.l){const d=xg(c.h);(d.length!=0||c.i.length!=0)&&(T(c.ka,d),T(c.ka,c.i),c.h.i.length=0,b(c.i),c.i.length=0),c.l.ra()}}function qg(c,d,m){var _=m instanceof qi?An(m):new qi(m);if(_.g!="")d&&(_.g=d+"."+_.g),pl(_,_.s);else{var D=a.location;_=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var L=new qi(null);_&&dl(L,_),d&&(L.g=d),D&&pl(L,D),m&&(L.l=m),_=L}return m=c.D,d=c.ya,m&&d&&ve(_,m,d),ve(_,"VER",c.la),fo(c,_),_}function Hg(c,d,m){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new Pe(new co({eb:m})):new Pe(c.pa),d.Ha(c.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gg(){}n=Gg.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function xl(){}xl.prototype.g=function(c,d){return new Nt(c,d)};function Nt(c,d){rt.call(this),this.g=new Mg(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!g(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!g(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new Fr(this)}I(Nt,rt),Nt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nt.prototype.close=function(){gh(this.g)},Nt.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var m={};m.__data__=c,c=m}else this.u&&(m={},m.__data__=rh(c),c=m);d.i.push(new iS(d.Ya++,c)),d.G==3&&yl(d)},Nt.prototype.N=function(){this.g.l=null,delete this.j,gh(this.g),delete this.g,Nt.aa.N.call(this)};function Kg(c){oh.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(const m in d){c=m;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}I(Kg,oh);function Qg(){ah.call(this),this.status=1}I(Qg,ah);function Fr(c){this.g=c}I(Fr,Gg),Fr.prototype.ua=function(){dt(this.g,"a")},Fr.prototype.ta=function(c){dt(this.g,new Kg(c))},Fr.prototype.sa=function(c){dt(this.g,new Qg)},Fr.prototype.ra=function(){dt(this.g,"b")},xl.prototype.createWebChannel=xl.prototype.g,Nt.prototype.send=Nt.prototype.o,Nt.prototype.open=Nt.prototype.m,Nt.prototype.close=Nt.prototype.close,Y0=function(){return new xl},X0=function(){return ll()},W0=zi,hp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cl.NO_ERROR=0,cl.TIMEOUT=8,cl.HTTP_ERROR=6,ic=cl,ug.COMPLETE="complete",Q0=ug,sg.EventType=to,to.OPEN="a",to.CLOSE="b",to.ERROR="c",to.MESSAGE="d",rt.prototype.listen=rt.prototype.K,Lo=sg,K0=co,Pe.prototype.listenOnce=Pe.prototype.L,Pe.prototype.getLastError=Pe.prototype.Ka,Pe.prototype.getLastErrorCode=Pe.prototype.Ba,Pe.prototype.getStatus=Pe.prototype.Z,Pe.prototype.getResponseJson=Pe.prototype.Oa,Pe.prototype.getResponseText=Pe.prototype.oa,Pe.prototype.send=Pe.prototype.ea,Pe.prototype.setWithCredentials=Pe.prototype.Ha,G0=Pe}).apply(typeof jl<"u"?jl:typeof self<"u"?self:typeof window<"u"?window:{});const Ty="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ke.UNAUTHENTICATED=new Ke(null),Ke.GOOGLE_CREDENTIALS=new Ke("google-credentials-uid"),Ke.FIRST_PARTY=new Ke("first-party-uid"),Ke.MOCK_USER=new Ke("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hs="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new Bf("@firebase/firestore");function Kr(){return Si.logLevel}function Lk(n){Si.setLogLevel(n)}function B(n,...e){if(Si.logLevel<=se.DEBUG){const t=e.map(Hf);Si.debug(`Firestore (${Hs}): ${n}`,...t)}}function Oe(n,...e){if(Si.logLevel<=se.ERROR){const t=e.map(Hf);Si.error(`Firestore (${Hs}): ${n}`,...t)}}function on(n,...e){if(Si.logLevel<=se.WARN){const t=e.map(Hf);Si.warn(`Firestore (${Hs}): ${n}`,...t)}}function Hf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(n="Unexpected state"){const e=`FIRESTORE (${Hs}) INTERNAL ASSERTION FAILED: `+n;throw Oe(e),new Error(e)}function W(n,e){n||K()}function Fk(n,e){n||K()}function H(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends Pr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ke.UNAUTHENTICATED))}shutdown(){}}class Bk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Uk{constructor(e){this.t=e,this.currentUser=Ke.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let i=this.i;const r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new We;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new We,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new We)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(W(typeof i.accessToken=="string"),new J0(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return W(e===null||typeof e=="string"),new Ke(e)}}class zk{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Ke.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class $k{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new zk(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ke.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class qk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Hk{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const i=s=>{s.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(W(typeof t.token=="string"),this.R=t.token,new qk(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=Gk(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}}function Z(n,e){return n<e?-1:n>e?1:0}function ks(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function eE(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new j(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new j(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new j(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ie.fromMillis(Date.now())}static fromDate(e){return Ie.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ie(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Ie(0,0))}static max(){return new X(new Ie(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t,i){t===void 0?t=0:t>e.length&&K(),i===void 0?i=e.length-t:i>e.length-t&&K(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Aa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Aa?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ie extends Aa{construct(e,t,i){return new ie(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new j(O.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new ie(t)}static emptyPath(){return new ie([])}}const Kk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ee extends Aa{construct(e,t,i){return new Ee(e,t,i)}static isValidIdentifier(e){return Kk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ee.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ee(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new j(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new j(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new j(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new j(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ee(t)}static emptyPath(){return new Ee([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.path=e}static fromPath(e){return new q(ie.fromString(e))}static fromName(e){return new q(ie.fromString(e).popFirst(5))}static empty(){return new q(ie.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ie.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ie.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new q(new ie(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function dp(n){return n.fields.find(e=>e.kind===2)}function Xi(n){return n.fields.filter(e=>e.kind!==2)}Gc.UNKNOWN_ID=-1;class rc{constructor(e,t){this.fieldPath=e,this.kind=t}}class ba{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ba(0,Ft.min())}}function tE(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=X.fromTimestamp(i===1e9?new Ie(t+1,0):new Ie(t,i));return new Ft(r,q.empty(),e)}function nE(n){return new Ft(n.readTime,n.key,-1)}class Ft{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ft(X.min(),q.empty(),-1)}static max(){return new Ft(X.max(),q.empty(),-1)}}function Gf(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=q.comparator(n.documentKey,e.documentKey),t!==0?t:Z(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Li(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==iE)throw n;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,i)=>{t(e)})}static reject(e){return new V((t,i)=>{i(e)})}static waitFor(e){return new V((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=V.resolve(!1);for(const i of e)t=t.next(r=>r?V.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new V((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===s&&i(o)},h=>r(h))}})}static doWhile(e,t){return new V((i,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new We,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Yo(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=Kf(i.target.error);this.V.reject(new Yo(e,r))}}static open(e,t,i,r){try{return new Su(t,e.transaction(r,i))}catch(s){throw new Yo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(B("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Wk(t)}}class gn{constructor(e,t,i){this.name=e,this.version=t,this.p=i,gn.S(qc())===12.2&&Oe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return B("SimpleDb","Removing database:",e),Yi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!R0())return!1;if(gn.C())return!0;const e=qc(),t=gn.S(e),i=0<t&&t<10,r=sE(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}async M(e){return this.db||(B("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;t(o)},r.onblocked=()=>{i(new Yo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new j(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new j(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Yo(e,o))},r.onupgradeneeded=s=>{B("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,r.transaction,s.oldVersion,this.version).next(()=>{B("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Su.open(this.db,e,s?"readonly":"readwrite",i),l=r(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),V.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(B("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function sE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class Qk{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Yi(this.B.delete())}}class Yo extends j{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fi(n){return n.name==="IndexedDbTransactionError"}class Wk{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(B("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(B("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Yi(i)}add(e){return B("SimpleDb","ADD",this.store.name,e,e),Yi(this.store.add(e))}get(e){return Yi(this.store.get(e)).next(t=>(t===void 0&&(t=null),B("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return B("SimpleDb","DELETE",this.store.name,e),Yi(this.store.delete(e))}count(){return B("SimpleDb","COUNT",this.store.name),Yi(this.store.count())}U(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const s=r.getAll(i.range);return new V((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(i),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new V((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}j(e,t){B("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.H=!1;const r=this.cursor(i);return this.W(r,(s,o,a)=>a.delete())}J(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.W(r,t)}Y(e){const t=this.cursor({});return new V((i,r)=>{t.onerror=s=>{const o=Kf(s.target.error);r(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():i()}):i()}})}W(e,t){const i=[];return new V((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const l=new Qk(a),u=t(a.primaryKey,a.value,l);if(u instanceof V){const h=u.catch(p=>(l.done(),V.reject(p)));i.push(h)}l.isDone?r():l.K===null?a.continue():a.continue(l.K)}}).next(()=>V.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Yi(n){return new V((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=Kf(i.target.error);t(r)}})}let Iy=!1;function Kf(n){const e=gn.S(qc());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new j("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Iy||(Iy=!0,setTimeout(()=>{throw i},0)),i}}return n}class Xk{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){B("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{B("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Fi(t)?B("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Li(t)}await this.X(6e4)})}}class Yk{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const i=new Set;let r=t,s=!0;return V.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!i.has(o))return B("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,r).next(a=>{r-=a,i.add(o)});s=!1})).next(()=>t-r)}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(r,s)).next(a=>(B("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let i=e;return t.changes.forEach((r,s)=>{const o=nE(s);Gf(o,i)>0&&(i=o)}),new Ft(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}At.oe=-1;function Ga(n){return n==null}function Ca(n){return n===0&&1/n==-1/0}function oE(n){return typeof n=="number"&&Number.isInteger(n)&&!Ca(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Sy(e)),e=Jk(n.get(t),e);return Sy(e)}function Jk(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Sy(n){return n+""}function un(n){const e=n.length;if(W(e>=2),e===2)return W(n.charAt(0)===""&&n.charAt(1)===""),ie.emptyPath();const t=e-2,i=[];let r="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&K(),n.charAt(o+1)){case"":const a=n.substring(s,o);let l;r.length===0?l=a:(r+=a,l=r,r=""),i.push(l);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:K()}s=o+2}return new ie(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(n,e){return[n,yt(e)]}function aE(n,e,t){return[n,yt(e),t]}const Zk={},eP=["prefixPath","collectionGroup","readTime","documentId"],tP=["prefixPath","collectionGroup","documentId"],nP=["collectionGroup","readTime","prefixPath","documentId"],iP=["canonicalId","targetId"],rP=["targetId","path"],sP=["path","targetId"],oP=["collectionId","parent"],aP=["indexId","uid"],lP=["uid","sequenceNumber"],cP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uP=["indexId","uid","orderedDocumentKey"],hP=["userId","collectionPath","documentId"],dP=["userId","collectionPath","largestBatchId"],pP=["userId","collectionGroup","largestBatchId"],lE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],fP=[...lE,"documentOverlays"],cE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],uE=cE,hE=[...uE,"indexConfiguration","indexState","indexEntries"],mP=hE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp extends rE{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Xe(n,e){const t=H(n);return gn.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Rr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e,t){this.comparator=e,this.root=t||et.EMPTY}insert(e,t){return new ge(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,et.BLACK,null,null))}remove(e){return new ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,et.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bl(this.root,e,this.comparator,!0)}}class Bl{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class et{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??et.RED,this.left=r??et.EMPTY,this.right=s??et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new et(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return et.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();const e=this.left.check();if(e!==this.right.check())throw K();return e+(this.isRed()?0:1)}}et.EMPTY=null,et.RED=!0,et.BLACK=!1;et.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(e,t,i,r,s){return this}insert(e,t,i){return new et(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.comparator=e,this.data=new ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Cy(this.data.getIterator())}getIteratorFrom(e){return new Cy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof de)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new de(this.comparator);return t.data=e,t}}class Cy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ur(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.fields=e,e.sort(Ee.comparator)}static empty(){return new bt([])}unionWith(e){let t=new de(Ee.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new bt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ks(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pE("Invalid base64 string: "+s):s}}(e);return new qe(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new qe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qe.EMPTY_BYTE_STRING=new qe("");const vP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bn(n){if(W(!!n),typeof n=="string"){let e=0;const t=vP.exec(n);if(W(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:De(n.seconds),nanos:De(n.nanos)}}function De(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ai(n){return typeof n=="string"?qe.fromBase64String(n):qe.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Qf(n){const e=n.mapValue.fields.__previous_value__;return Au(e)?Qf(e):e}function ka(n){const e=Bn(n.mapValue.fields.__local_write_time__.timestampValue);return new Ie(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,t,i,r,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class bi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new bi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof bi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},oc={nullValue:"NULL_VALUE"};function vr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Au(n)?4:fE(n)?9007199254740991:10:K()}function yn(n,e){if(n===e)return!0;const t=vr(n);if(t!==vr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ka(n).isEqual(ka(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Bn(r.timestampValue),a=Bn(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Ai(r.bytesValue).isEqual(Ai(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return De(r.geoPointValue.latitude)===De(s.geoPointValue.latitude)&&De(r.geoPointValue.longitude)===De(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return De(r.integerValue)===De(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=De(r.doubleValue),a=De(s.doubleValue);return o===a?Ca(o)===Ca(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ks(n.arrayValue.values||[],e.arrayValue.values||[],yn);case 10:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(by(o)!==by(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!yn(o[l],a[l])))return!1;return!0}(n,e);default:return K()}}function Pa(n,e){return(n.values||[]).find(t=>yn(t,e))!==void 0}function Ci(n,e){if(n===e)return 0;const t=vr(n),i=vr(e);if(t!==i)return Z(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=De(s.integerValue||s.doubleValue),l=De(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return ky(n.timestampValue,e.timestampValue);case 4:return ky(ka(n),ka(e));case 5:return Z(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Ai(s),l=Ai(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=Z(a[u],l[u]);if(h!==0)return h}return Z(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Z(De(s.latitude),De(o.latitude));return a!==0?a:Z(De(s.longitude),De(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],l=o.values||[];for(let u=0;u<a.length&&u<l.length;++u){const h=Ci(a[u],l[u]);if(h)return h}return Z(a.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===ci.mapValue&&o===ci.mapValue)return 0;if(s===ci.mapValue)return 1;if(o===ci.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let p=0;p<l.length&&p<h.length;++p){const f=Z(l[p],h[p]);if(f!==0)return f;const v=Ci(a[l[p]],u[h[p]]);if(v!==0)return v}return Z(l.length,h.length)}(n.mapValue,e.mapValue);default:throw K()}}function ky(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Z(n,e);const t=Bn(n),i=Bn(e),r=Z(t.seconds,i.seconds);return r!==0?r:Z(t.nanos,i.nanos)}function Ps(n){return fp(n)}function fp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Bn(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ai(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return q.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=fp(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${fp(t.fields[o])}`;return r+"}"}(n.mapValue):K()}function yr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mp(n){return!!n&&"integerValue"in n}function Ra(n){return!!n&&"arrayValue"in n}function Py(n){return!!n&&"nullValue"in n}function Ry(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ac(n){return!!n&&"mapValue"in n}function Jo(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Rr(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Jo(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Jo(n.arrayValue.values[t]);return e}return Object.assign({},n)}function fE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function _P(n){return"nullValue"in n?oc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yr(bi.empty(),q.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:K()}function xP(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yr(bi.empty(),q.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?ci:K()}function Dy(n,e){const t=Ci(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Ny(n,e){const t=Ci(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.value=e}static empty(){return new tt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ac(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jo(t)}setAll(e){let t=Ee.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Jo(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());ac(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];ac(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Rr(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new tt(Jo(this.value))}}function mE(n){const e=[];return Rr(n.fields,(t,i)=>{const r=new Ee([t]);if(ac(i)){const s=mE(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new bt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new _e(e,0,X.min(),X.min(),X.min(),tt.empty(),0)}static newFoundDocument(e,t,i,r){return new _e(e,1,t,X.min(),i,r,0)}static newNoDocument(e,t){return new _e(e,2,t,X.min(),X.min(),tt.empty(),0)}static newUnknownDocument(e,t){return new _e(e,3,t,X.min(),X.min(),tt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _e&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,t){this.position=e,this.inclusive=t}}function Vy(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=q.comparator(q.fromName(o.referenceValue),t.key):i=Ci(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function My(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!yn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t="asc"){this.field=e,this.dir=t}}function wP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{}class re extends gE{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new EP(e,t,i):t==="array-contains"?new SP(e,i):t==="in"?new EE(e,i):t==="not-in"?new AP(e,i):t==="array-contains-any"?new bP(e,i):new re(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new TP(e,i):new IP(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ci(t,this.value)):t!==null&&vr(this.value)===vr(t)&&this.matchesComparison(Ci(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ue extends gE{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ue(e,t)}matches(e){return Rs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Rs(n){return n.op==="and"}function gp(n){return n.op==="or"}function Wf(n){return vE(n)&&Rs(n)}function vE(n){for(const e of n.filters)if(e instanceof ue)return!1;return!0}function vp(n){if(n instanceof re)return n.field.canonicalString()+n.op.toString()+Ps(n.value);if(Wf(n))return n.filters.map(e=>vp(e)).join(",");{const e=n.filters.map(t=>vp(t)).join(",");return`${n.op}(${e})`}}function yE(n,e){return n instanceof re?function(i,r){return r instanceof re&&i.op===r.op&&i.field.isEqual(r.field)&&yn(i.value,r.value)}(n,e):n instanceof ue?function(i,r){return r instanceof ue&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&yE(o,r.filters[a]),!0):!1}(n,e):void K()}function _E(n,e){const t=n.filters.concat(e);return ue.create(t,n.op)}function xE(n){return n instanceof re?function(t){return`${t.field.canonicalString()} ${t.op} ${Ps(t.value)}`}(n):n instanceof ue?function(t){return t.op.toString()+" {"+t.getFilters().map(xE).join(" ,")+"}"}(n):"Filter"}class EP extends re{constructor(e,t,i){super(e,t,i),this.key=q.fromName(i.referenceValue)}matches(e){const t=q.comparator(e.key,this.key);return this.matchesComparison(t)}}class TP extends re{constructor(e,t){super(e,"in",t),this.keys=wE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class IP extends re{constructor(e,t){super(e,"not-in",t),this.keys=wE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function wE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>q.fromName(i.referenceValue))}class SP extends re{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ra(t)&&Pa(t.arrayValue,this.value)}}class EE extends re{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Pa(this.value.arrayValue,t)}}class AP extends re{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Pa(this.value.arrayValue,t)}}class bP extends re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ra(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Pa(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function yp(n,e=null,t=[],i=[],r=null,s=null,o=null){return new CP(n,e,t,i,r,s,o)}function _r(n){const e=H(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>vp(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),Ga(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Ps(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Ps(i)).join(",")),e.ue=t}return e.ue}function Ka(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!My(n.startAt,e.startAt)&&My(n.endAt,e.endAt)}function Kc(n){return q.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Qc(n,e){return n.filters.filter(t=>t instanceof re&&t.field.isEqual(e))}function Oy(n,e,t){let i=oc,r=!0;for(const s of Qc(n,e)){let o=oc,a=!0;switch(s.op){case"<":case"<=":o=_P(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=oc}Dy({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Dy({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function Ly(n,e,t){let i=ci,r=!0;for(const s of Qc(n,e)){let o=ci,a=!0;switch(s.op){case">=":case">":o=xP(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ci}Ny({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Ny({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function TE(n,e,t,i,r,s,o,a){return new $n(n,e,t,i,r,s,o,a)}function Gs(n){return new $n(n)}function Fy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Xf(n){return n.collectionGroup!==null}function gs(n){const e=H(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new de(Ee.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Da(s,i))}),t.has(Ee.keyField().canonicalString())||e.ce.push(new Da(Ee.keyField(),i))}return e.ce}function _t(n){const e=H(n);return e.le||(e.le=kP(e,gs(n))),e.le}function kP(n,e){if(n.limitType==="F")return yp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Da(r.field,s)});const t=n.endAt?new ki(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ki(n.startAt.position,n.startAt.inclusive):null;return yp(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function _p(n,e){const t=n.filters.concat([e]);return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Wc(n,e,t){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qa(n,e){return Ka(_t(n),_t(e))&&n.limitType===e.limitType}function IE(n){return`${_r(_t(n))}|lt:${n.limitType}`}function Qr(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>xE(r)).join(", ")}]`),Ga(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Ps(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Ps(r)).join(",")),`Target(${i})`}(_t(n))}; limitType=${n.limitType})`}function Wa(n,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):q.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(const s of gs(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,a,l){const u=Vy(o,a,l);return o.inclusive?u<=0:u<0}(i.startAt,gs(i),r)||i.endAt&&!function(o,a,l){const u=Vy(o,a,l);return o.inclusive?u>=0:u>0}(i.endAt,gs(i),r))}(n,e)}function SE(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function AE(n){return(e,t)=>{let i=!1;for(const r of gs(n)){const s=PP(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function PP(n,e,t){const i=n.field.isKeyField()?q.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Ci(l,u):K()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return K()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Rr(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return dE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new ge(q.comparator);function Ct(){return RP}const bE=new ge(q.comparator);function Fo(...n){let e=bE;for(const t of n)e=e.insert(t.key,t);return e}function CE(n){let e=bE;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function hn(){return Zo()}function kE(){return Zo()}function Zo(){return new ji(n=>n.toString(),(n,e)=>n.isEqual(e))}const DP=new ge(q.comparator),NP=new de(q.comparator);function ee(...n){let e=NP;for(const t of n)e=e.add(t);return e}const VP=new de(Z);function Yf(){return VP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ca(e)?"-0":e}}function RE(n){return{integerValue:""+n}}function DE(n,e){return oE(e)?RE(e):PE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this._=void 0}}function MP(n,e,t){return n instanceof Ds?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Au(s)&&(s=Qf(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof xr?VE(n,e):n instanceof wr?ME(n,e):function(r,s){const o=NE(r,s),a=jy(o)+jy(r.Pe);return mp(o)&&mp(r.Pe)?RE(a):PE(r.serializer,a)}(n,e)}function OP(n,e,t){return n instanceof xr?VE(n,e):n instanceof wr?ME(n,e):t}function NE(n,e){return n instanceof Ns?function(i){return mp(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}class Ds extends bu{}class xr extends bu{constructor(e){super(),this.elements=e}}function VE(n,e){const t=OE(e);for(const i of n.elements)t.some(r=>yn(r,i))||t.push(i);return{arrayValue:{values:t}}}class wr extends bu{constructor(e){super(),this.elements=e}}function ME(n,e){let t=OE(e);for(const i of n.elements)t=t.filter(r=>!yn(r,i));return{arrayValue:{values:t}}}class Ns extends bu{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function jy(n){return De(n.integerValue||n.doubleValue)}function OE(n){return Ra(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e,t){this.field=e,this.transform=t}}function LP(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof xr&&r instanceof xr||i instanceof wr&&r instanceof wr?ks(i.elements,r.elements,yn):i instanceof Ns&&r instanceof Ns?yn(i.Pe,r.Pe):i instanceof Ds&&r instanceof Ds}(n.transform,e.transform)}class FP{constructor(e,t){this.version=e,this.transformResults=t}}class Te{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Te}static exists(e){return new Te(void 0,e)}static updateTime(e){return new Te(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Cu{}function LE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qs(n.key,Te.none()):new Ks(n.key,n.data,Te.none());{const t=n.data,i=tt.empty();let r=new de(Ee.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new qn(n.key,i,new bt(r.toArray()),Te.none())}}function jP(n,e,t){n instanceof Ks?function(r,s,o){const a=r.value.clone(),l=Uy(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof qn?function(r,s,o){if(!lc(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Uy(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(FE(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ea(n,e,t,i){return n instanceof Ks?function(s,o,a,l){if(!lc(s.precondition,o))return a;const u=s.value.clone(),h=zy(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof qn?function(s,o,a,l){if(!lc(s.precondition,o))return a;const u=zy(s.fieldTransforms,l,o),h=o.data;return h.setAll(FE(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,i):function(s,o,a){return lc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function BP(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=NE(i.transform,r||null);s!=null&&(t===null&&(t=tt.empty()),t.set(i.field,s))}return t||null}function By(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&ks(i,r,(s,o)=>LP(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ks extends Cu{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class qn extends Cu{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function FE(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function Uy(n,e,t){const i=new Map;W(n.length===t.length);for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,OP(o,a,t[r]))}return i}function zy(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,MP(s,o,e))}return i}class Qs extends Cu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Jf extends Cu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&jP(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ea(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ea(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=kE();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=LE(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(X.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ee())}isEqual(e){return this.batchId===e.batchId&&ks(this.mutations,e.mutations,(t,i)=>By(t,i))&&ks(this.baseMutations,e.baseMutations,(t,i)=>By(t,i))}}class em{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){W(e.mutations.length===i.length);let r=function(){return DP}();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new em(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe,oe;function jE(n){switch(n){default:return K();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function BE(n){if(n===void 0)return Oe("GRPC error has no .code"),O.UNKNOWN;switch(n){case Fe.OK:return O.OK;case Fe.CANCELLED:return O.CANCELLED;case Fe.UNKNOWN:return O.UNKNOWN;case Fe.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case Fe.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case Fe.INTERNAL:return O.INTERNAL;case Fe.UNAVAILABLE:return O.UNAVAILABLE;case Fe.UNAUTHENTICATED:return O.UNAUTHENTICATED;case Fe.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case Fe.NOT_FOUND:return O.NOT_FOUND;case Fe.ALREADY_EXISTS:return O.ALREADY_EXISTS;case Fe.PERMISSION_DENIED:return O.PERMISSION_DENIED;case Fe.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case Fe.ABORTED:return O.ABORTED;case Fe.OUT_OF_RANGE:return O.OUT_OF_RANGE;case Fe.UNIMPLEMENTED:return O.UNIMPLEMENTED;case Fe.DATA_LOSS:return O.DATA_LOSS;default:return K()}}(oe=Fe||(Fe={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=new cr([4294967295,4294967295],0);function $y(n){const e=UE().encode(n),t=new H0;return t.update(e),new Uint8Array(t.digest())}function qy(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new cr([t,i],0),new cr([r,s],0)]}class nm{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new jo(`Invalid padding: ${t}`);if(i<0)throw new jo(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new jo(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new jo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=cr.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(cr.fromNumber(i)));return r.compare(zP)===1&&(r=new cr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=$y(e),[i,r]=qy(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new nm(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=$y(e),[i,r]=qy(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class jo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Ja.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ya(X.min(),r,new ge(Z),Ct(),ee())}}class Ja{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ja(i,t,ee(),ee(),ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}}class zE{constructor(e,t){this.targetId=e,this.me=t}}class $E{constructor(e,t,i=qe.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class Hy{constructor(){this.fe=0,this.ge=Ky(),this.pe=qe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=ee(),t=ee(),i=ee();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:K()}}),new Ja(this.pe,this.ye,e,t,i)}ve(){this.we=!1,this.ge=Ky()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,W(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class $P{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ct(),this.qe=Gy(),this.Qe=new ge(Z)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.ve(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:K()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){const t=e.targetId,i=e.me.count,r=this.Je(t);if(r){const s=r.target;if(Kc(s))if(i===0){const o=new q(s.path);this.Ue(t,o,_e.newNoDocument(o,X.min()))}else W(i===1);else{const o=this.Ye(t);if(o!==i){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Ai(i).toUint8Array()}catch(l){if(l instanceof pE)return on("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new nm(o,r,s)}catch(l){return on(l instanceof jo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let r=0;return i.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),r++)}),r}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Kc(a.target)){const l=new q(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,_e.newNoDocument(l,e))}s.be&&(t.set(o,s.Ce()),s.ve())}});let i=ee();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const r=new Ya(e,t,this.Qe,this.ke,i);return this.ke=Ct(),this.qe=Gy(),this.Qe=new ge(Z),r}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Hy,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new de(Z),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||B("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hy),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Gy(){return new ge(q.comparator)}function Ky(){return new ge(q.comparator)}const qP={asc:"ASCENDING",desc:"DESCENDING"},HP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GP={and:"AND",or:"OR"};class KP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xp(n,e){return n.useProto3Json||Ga(e)?e:{value:e}}function Vs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QP(n,e){return Vs(n,e.toTimestamp())}function Le(n){return W(!!n),X.fromTimestamp(function(t){const i=Bn(t);return new Ie(i.seconds,i.nanos)}(n))}function im(n,e){return wp(n,e).canonicalString()}function wp(n,e){const t=function(r){return new ie(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function HE(n){const e=ie.fromString(n);return W(tT(e)),e}function Na(n,e){return im(n.databaseId,e.path)}function vn(n,e){const t=HE(e);if(t.get(1)!==n.databaseId.projectId)throw new j(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new j(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new q(QE(t))}function GE(n,e){return im(n.databaseId,e)}function KE(n){const e=HE(n);return e.length===4?ie.emptyPath():QE(e)}function Ep(n){return new ie(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function QE(n){return W(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Qy(n,e,t){return{name:Na(n,e),fields:t.value.mapValue.fields}}function WE(n,e,t){const i=vn(n,e.name),r=Le(e.updateTime),s=e.createTime?Le(e.createTime):X.min(),o=new tt({mapValue:{fields:e.fields}}),a=_e.newFoundDocument(i,r,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function WP(n,e){return"found"in e?function(i,r){W(!!r.found),r.found.name,r.found.updateTime;const s=vn(i,r.found.name),o=Le(r.found.updateTime),a=r.found.createTime?Le(r.found.createTime):X.min(),l=new tt({mapValue:{fields:r.found.fields}});return _e.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(i,r){W(!!r.missing),W(!!r.readTime);const s=vn(i,r.missing),o=Le(r.readTime);return _e.newNoDocument(s,o)}(n,e):K()}function XP(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:K()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(W(h===void 0||typeof h=="string"),qe.fromBase64String(h||"")):(W(h===void 0||h instanceof Buffer||h instanceof Uint8Array),qe.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?O.UNKNOWN:BE(u.code);return new j(h,u.message||"")}(o);t=new $E(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=vn(n,i.document.name),s=Le(i.document.updateTime),o=i.document.createTime?Le(i.document.createTime):X.min(),a=new tt({mapValue:{fields:i.document.fields}}),l=_e.newFoundDocument(r,s,o,a),u=i.targetIds||[],h=i.removedTargetIds||[];t=new cc(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=vn(n,i.document),s=i.readTime?Le(i.readTime):X.min(),o=_e.newNoDocument(r,s),a=i.removedTargetIds||[];t=new cc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=vn(n,i.document),s=i.removedTargetIds||[];t=new cc([],s,r,null)}else{if(!("filter"in e))return K();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new UP(r,s),a=i.targetId;t=new zE(a,o)}}return t}function Va(n,e){let t;if(e instanceof Ks)t={update:Qy(n,e.key,e.value)};else if(e instanceof Qs)t={delete:Na(n,e.key)};else if(e instanceof qn)t={update:Qy(n,e.key,e.data),updateMask:nR(e.fieldMask)};else{if(!(e instanceof Jf))return K();t={verify:Na(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof Ds)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof xr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ns)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw K()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:QP(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K()}(n,e.precondition)),t}function Tp(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Te.updateTime(Le(s.updateTime)):s.exists!==void 0?Te.exists(s.exists):Te.none()}(e.currentDocument):Te.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(o,a){let l=null;if("setToServerValue"in a)W(a.setToServerValue==="REQUEST_TIME"),l=new Ds;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new xr(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new wr(h)}else"increment"in a?l=new Ns(o,a.increment):K();const u=Ee.fromServerFormat(a.fieldPath);return new Xa(u,l)}(n,r)):[];if(e.update){e.update.name;const r=vn(n,e.update.name),s=new tt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new bt(u.map(h=>Ee.fromServerFormat(h)))}(e.updateMask);return new qn(r,s,o,t,i)}return new Ks(r,s,t,i)}if(e.delete){const r=vn(n,e.delete);return new Qs(r,t)}if(e.verify){const r=vn(n,e.verify);return new Jf(r,t)}return K()}function YP(n,e){return n&&n.length>0?(W(e!==void 0),n.map(t=>function(r,s){let o=r.updateTime?Le(r.updateTime):Le(s);return o.isEqual(X.min())&&(o=Le(s)),new FP(o,r.transformResults||[])}(t,e))):[]}function XE(n,e){return{documents:[GE(n,e.path)]}}function YE(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=GE(n,r);const s=function(u){if(u.length!==0)return eT(ue.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(h=>function(f){return{field:Wr(f.field),direction:ZP(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=xp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:r}}function JE(n){let e=KE(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){W(i===1);const h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(p){const f=ZE(p);return f instanceof ue&&Wf(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(f=>function(I){return new Da(Xr(I.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(p){let f;return f=typeof p=="object"?p.value:p,Ga(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(p){const f=!!p.before,v=p.values||[];return new ki(v,f)}(t.startAt));let u=null;return t.endAt&&(u=function(p){const f=!p.before,v=p.values||[];return new ki(v,f)}(t.endAt)),TE(e,r,o,s,a,"F",l,u)}function JP(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ZE(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Xr(t.unaryFilter.field);return re.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Xr(t.unaryFilter.field);return re.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Xr(t.unaryFilter.field);return re.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xr(t.unaryFilter.field);return re.create(o,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(n):n.fieldFilter!==void 0?function(t){return re.create(Xr(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ue.create(t.compositeFilter.filters.map(i=>ZE(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return K()}}(t.compositeFilter.op))}(n):K()}function ZP(n){return qP[n]}function eR(n){return HP[n]}function tR(n){return GP[n]}function Wr(n){return{fieldPath:n.canonicalString()}}function Xr(n){return Ee.fromServerFormat(n.fieldPath)}function eT(n){return n instanceof re?function(t){if(t.op==="=="){if(Ry(t.value))return{unaryFilter:{field:Wr(t.field),op:"IS_NAN"}};if(Py(t.value))return{unaryFilter:{field:Wr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ry(t.value))return{unaryFilter:{field:Wr(t.field),op:"IS_NOT_NAN"}};if(Py(t.value))return{unaryFilter:{field:Wr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wr(t.field),op:eR(t.op),value:t.value}}}(n):n instanceof ue?function(t){const i=t.getFilters().map(r=>eT(r));return i.length===1?i[0]:{compositeFilter:{op:tR(t.op),filters:i}}}(n):K()}function nR(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function tT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,t,i,r,s=X.min(),o=X.min(),a=qe.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Nn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e){this.ct=e}}function iR(n,e){let t;if(e.document)t=WE(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=q.fromSegments(e.noDocument.path),r=Tr(e.noDocument.readTime);t=_e.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return K();{const i=q.fromSegments(e.unknownDocument.path),r=Tr(e.unknownDocument.version);t=_e.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(r){const s=new Ie(r[0],r[1]);return X.fromTimestamp(s)}(e.readTime)),t}function Wy(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Xc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(s,o){return{name:Na(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Vs(s,o.version.toTimestamp()),createTime:Vs(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Er(e.version)};else{if(!e.isUnknownDocument())return K();i.unknownDocument={path:t.path.toArray(),version:Er(e.version)}}return i}function Xc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Er(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Tr(n){const e=new Ie(n.seconds,n.nanoseconds);return X.fromTimestamp(e)}function Ji(n,e){const t=(e.baseMutations||[]).map(s=>Tp(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map(s=>Tp(n.ct,s)),r=Ie.fromMillis(e.localWriteTimeMs);return new Zf(e.batchId,r,t,i)}function Bo(n){const e=Tr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Tr(n.lastLimboFreeSnapshotVersion):X.min();let i;return i=function(s){return s.documents!==void 0}(n.query)?function(s){return W(s.documents.length===1),_t(Gs(KE(s.documents[0])))}(n.query):function(s){return _t(JE(s))}(n.query),new Nn(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,qe.fromBase64String(n.resumeToken))}function iT(n,e){const t=Er(e.snapshotVersion),i=Er(e.lastLimboFreeSnapshotVersion);let r;r=Kc(e.target)?XE(n.ct,e.target):YE(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:_r(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function rm(n){const e=JE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wc(e,e.limit,"L"):e}function Jh(n,e){return new tm(e.largestBatchId,Tp(n.ct,e.overlayMutation))}function Xy(n,e){const t=e.path.lastSegment();return[n,yt(e.path.popLast()),t]}function Yy(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Er(i.readTime),documentKey:yt(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{getBundleMetadata(e,t){return Jy(e).get(t).next(i=>{if(i)return function(s){return{id:s.bundleId,createTime:Tr(s.createTime),version:s.version}}(i)})}saveBundleMetadata(e,t){return Jy(e).put(function(r){return{bundleId:r.id,createTime:Er(Le(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return Zy(e).get(t).next(i=>{if(i)return function(s){return{name:s.name,query:rm(s.bundledQuery),readTime:Tr(s.readTime)}}(i)})}saveNamedQuery(e,t){return Zy(e).put(function(r){return{name:r.name,readTime:Er(Le(r.readTime)),bundledQuery:r.bundledQuery}}(t))}}function Jy(n){return Xe(n,"bundles")}function Zy(n){return Xe(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const i=t.uid||"";return new ku(e,i)}getOverlay(e,t){return To(e).get(Xy(this.userId,t)).next(i=>i?Jh(this.serializer,i):null)}getOverlays(e,t){const i=hn();return V.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){const r=[];return i.forEach((s,o)=>{const a=new tm(t,o);r.push(this.ht(e,a))}),V.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach(o=>r.add(yt(o.getCollectionPath())));const s=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(To(e).j("collectionPathOverlayIndex",a))}),V.waitFor(s)}getOverlaysForCollection(e,t,i){const r=hn(),s=yt(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return To(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=Jh(this.serializer,l);r.set(u.getKey(),u)}return r})}getOverlaysForCollectionGroup(e,t,i,r){const s=hn();let o;const a=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return To(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,h)=>{const p=Jh(this.serializer,u);s.size()<r||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):h.done()}).next(()=>s)}ht(e,t){return To(e).put(function(r,s,o){const[a,l,u]=Xy(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Va(r.ct,o.mutation)}}(this.serializer,this.userId,t))}}function To(n){return Xe(n,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(De(e.integerValue));else if("doubleValue"in e){const i=De(e.doubleValue);isNaN(i)?this.Et(t,13):(this.Et(t,15),Ca(i)?t.dt(0):t.dt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Et(t,20),typeof i=="string"&&(i=Bn(i)),t.At(`${i.seconds||""}`),t.dt(i.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Ai(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Et(t,45),t.dt(i.latitude||0),t.dt(i.longitude||0)}else"mapValue"in e?fE(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):K()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const i=e.fields||{};this.Et(t,55);for(const r of Object.keys(i))this.Rt(r,t),this.It(i[r],t)}wt(e,t){const i=e.values||[];this.Et(t,50);for(const r of i)this.It(r,t)}gt(e,t){this.Et(t,37),q.fromName(e).path.forEach(i=>{this.Et(t,60),this.St(i,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}Zi.bt=new Zi;function sR(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function e_(n){const e=64-function(i){let r=0;for(let s=0;s<8;++s){const o=sR(255&i[s]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}class oR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ct(i.value),i=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Mt(i.value),i=t.next();this.xt()}Ot(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ct(i);else if(i<2048)this.Ct(960|i>>>6),this.Ct(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ct(480|i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i);else{const r=t.codePointAt(0);this.Ct(240|r>>>18),this.Ct(128|63&r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r)}}this.vt()}Nt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Mt(i);else if(i<2048)this.Mt(960|i>>>6),this.Mt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Mt(480|i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i);else{const r=t.codePointAt(0);this.Mt(240|r>>>18),this.Mt(128|63&r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r)}}this.xt()}Lt(e){const t=this.Bt(e),i=e_(t);this.kt(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}qt(e){const t=this.Bt(e),i=e_(t);this.kt(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Ct(e){const t=255&e;t===0?(this.Kt(0),this.Kt(255)):t===255?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class aR{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class lR{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class Io{constructor(){this.Gt=new oR,this.zt=new aR(this.Gt),this.jt=new lR(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new er(this.indexId,this.documentKey,this.arrayValue,i)}}function Xn(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=t_(n.arrayValue,e.arrayValue),t!==0?t:(t=t_(n.directionalValue,e.directionalValue),t!==0?t:q.comparator(n.documentKey,e.documentKey)))}function t_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e){this.Yt=new de((t,i)=>Ee.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const i=t;i.isInequality()?this.Yt=this.Yt.add(i):this.Xt.push(i)}}get en(){return this.Yt.size>1}tn(e){if(W(e.collectionGroup===this.collectionId),this.en)return!1;const t=dp(e);if(t!==void 0&&!this.nn(t))return!1;const i=Xi(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.nn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Yt.size>0){const a=this.Yt.getIterator().getNext();if(!r.has(a.field.canonicalString())){const l=i[s];if(!this.rn(a,l)||!this.sn(this.Zt[o++],l))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new de(Ee.comparator);const t=[];for(const i of this.Xt)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new rc(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new rc(i.field,0))}for(const i of this.Zt)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new rc(i.field,i.dir==="asc"?0:1)));return new Gc(Gc.UNKNOWN_ID,this.collectionId,t,ba.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(n){var e,t;if(W(n instanceof re||n instanceof ue),n instanceof re){if(n instanceof EE){const r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>re.create(n.field,"==",s)))||[];return ue.create(r,"or")}return n}const i=n.filters.map(r=>rT(r));return ue.create(i,n.op)}function cR(n){if(n.getFilters().length===0)return[];const e=Ap(rT(n));return W(sT(e)),Ip(e)||Sp(e)?[e]:e.getFilters()}function Ip(n){return n instanceof re}function Sp(n){return n instanceof ue&&Wf(n)}function sT(n){return Ip(n)||Sp(n)||function(t){if(t instanceof ue&&gp(t)){for(const i of t.getFilters())if(!Ip(i)&&!Sp(i))return!1;return!0}return!1}(n)}function Ap(n){if(W(n instanceof re||n instanceof ue),n instanceof re)return n;if(n.filters.length===1)return Ap(n.filters[0]);const e=n.filters.map(i=>Ap(i));let t=ue.create(e,n.op);return t=Yc(t),sT(t)?t:(W(t instanceof ue),W(Rs(t)),W(t.filters.length>1),t.filters.reduce((i,r)=>sm(i,r)))}function sm(n,e){let t;return W(n instanceof re||n instanceof ue),W(e instanceof re||e instanceof ue),t=n instanceof re?e instanceof re?function(r,s){return ue.create([r,s],"and")}(n,e):i_(n,e):e instanceof re?i_(e,n):function(r,s){if(W(r.filters.length>0&&s.filters.length>0),Rs(r)&&Rs(s))return _E(r,s.getFilters());const o=gp(r)?r:s,a=gp(r)?s:r,l=o.filters.map(u=>sm(u,a));return ue.create(l,"or")}(n,e),Yc(t)}function i_(n,e){if(Rs(e))return _E(e,n.getFilters());{const t=e.filters.map(i=>sm(n,i));return ue.create(t,"or")}}function Yc(n){if(W(n instanceof re||n instanceof ue),n instanceof re)return n;const e=n.getFilters();if(e.length===1)return Yc(e[0]);if(vE(n))return n;const t=e.map(r=>Yc(r)),i=[];return t.forEach(r=>{r instanceof re?i.push(r):r instanceof ue&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:ue.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(){this._n=new om}addToCollectionParentIndex(e,t){return this._n.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Ft.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Ft.min())}updateCollectionGroup(e,t,i){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class om{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new de(ie.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new de(ie.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul=new Uint8Array(0);class hR{constructor(e,t){this.databaseId=t,this.an=new om,this.un=new ji(i=>_r(i),(i,r)=>Ka(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});const s={collectionId:i,parent:yt(r)};return r_(e).put(s)}return V.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[eE(t),""],!1,!0);return r_(e).U(r).next(s=>{for(const o of s){if(o.collectionId!==t)break;i.push(un(o.parent))}return i})}addFieldIndex(e,t){const i=So(e),r=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete r.indexId;const s=i.add(r);if(t.indexState){const o=$r(e);return s.next(a=>{o.put(Yy(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const i=So(e),r=$r(e),s=zr(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=So(e),i=zr(e),r=$r(e);return t.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(e,t){return V.forEach(this.cn(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){const s=new n_(i).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const i=zr(e);let r=!0;const s=new Map;return V.forEach(this.cn(t),o=>this.ln(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=ee();const a=[];return V.forEach(s,(l,u)=>{B("IndexedDbIndexManager",`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(l)} to execute ${_r(t)}`);const h=function(w,k){const N=dp(k);if(N===void 0)return null;for(const M of Qc(w,N.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(u,l),p=function(w,k){const N=new Map;for(const M of Xi(k))for(const E of Qc(w,M.fieldPath))switch(E.op){case"==":case"in":N.set(M.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return N.set(M.fieldPath.canonicalString(),E.value),Array.from(N.values())}return null}(u,l),f=function(w,k){const N=[];let M=!0;for(const E of Xi(k)){const x=E.kind===0?Oy(w,E.fieldPath,w.startAt):Ly(w,E.fieldPath,w.startAt);N.push(x.value),M&&(M=x.inclusive)}return new ki(N,M)}(u,l),v=function(w,k){const N=[];let M=!0;for(const E of Xi(k)){const x=E.kind===0?Ly(w,E.fieldPath,w.endAt):Oy(w,E.fieldPath,w.endAt);N.push(x.value),M&&(M=x.inclusive)}return new ki(N,M)}(u,l),I=this.hn(l,u,f),b=this.hn(l,u,v),T=this.Pn(l,u,p),y=this.In(l.indexId,h,I,f.inclusive,b,v.inclusive,T);return V.forEach(y,g=>i.G(g,t.limit).next(w=>{w.forEach(k=>{const N=q.fromSegments(k.documentKey);o.has(N)||(o=o.add(N),a.push(N))})}))}).next(()=>a)}return V.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=cR(ue.create(e.filters,"and")).map(i=>yp(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,i,r,s,o,a){const l=(t!=null?t.length:1)*Math.max(i.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let p=0;p<l;++p){const f=t?this.Tn(t[p/u]):Ul,v=this.En(e,f,i[p%u],r),I=this.dn(e,f,s[p%u],o),b=a.map(T=>this.En(e,f,T,!0));h.push(...this.createRange(v,I,b))}return h}En(e,t,i,r){const s=new er(e,q.empty(),t,i);return r?s:s.Jt()}dn(e,t,i,r){const s=new er(e,q.empty(),t,i);return r?s.Jt():s}ln(e,t){const i=new n_(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const a of s)i.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let i=2;const r=this.cn(t);return V.forEach(r,s=>this.ln(e,s).next(o=>{o?i!==0&&o.fields.length<function(l){let u=new de(Ee.comparator),h=!1;for(const p of l.filters)for(const f of p.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?h=!0:u=u.add(f.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(h?1:0)}(s)&&(i=1):i=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&i===2?1:i)}An(e,t){const i=new Io;for(const r of Xi(e)){const s=t.data.field(r.fieldPath);if(s==null)return null;const o=i.Ht(r.kind);Zi.bt.Pt(s,o)}return i.Wt()}Tn(e){const t=new Io;return Zi.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const i=new Io;return Zi.bt.Pt(yr(this.databaseId,t),i.Ht(function(s){const o=Xi(s);return o.length===0?0:o[o.length-1].kind}(e))),i.Wt()}Pn(e,t,i){if(i===null)return[];let r=[];r.push(new Io);let s=0;for(const o of Xi(e)){const a=i[s++];for(const l of r)if(this.Vn(t,o.fieldPath)&&Ra(a))r=this.mn(r,o,a);else{const u=l.Ht(o.kind);Zi.bt.Pt(a,u)}}return this.fn(r)}hn(e,t,i){return this.Pn(e,t,i.position)}fn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].Wt();return t}mn(e,t,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const l=new Io;l.seed(a.Wt()),Zi.bt.Pt(o,l.Ht(t.kind)),s.push(l)}return s}Vn(e,t){return!!e.filters.find(i=>i instanceof re&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){const i=So(e),r=$r(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next(s=>{const o=[];return V.forEach(s,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(function(h,p){const f=p?new ba(p.sequenceNumber,new Ft(Tr(p.readTime),new q(un(p.documentKey)),p.largestBatchId)):ba.empty(),v=h.fields.map(([I,b])=>new rc(Ee.fromServerFormat(I),b));return new Gc(h.indexId,h.collectionGroup,v,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:Z(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const r=So(e),s=$r(e);return this.gn(e).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,l=>s.put(Yy(l.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){const i=new Map;return V.forEach(t,(r,s)=>{const o=i.get(r.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(i.set(r.collectionGroup,a),V.forEach(a,l=>this.pn(e,r,l).next(u=>{const h=this.yn(s,l);return u.isEqual(h)?V.resolve():this.wn(e,s,l,u,h)}))))})}Sn(e,t,i,r){return zr(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(i,t.key),documentKey:t.key.path.toArray()})}bn(e,t,i,r){return zr(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(i,t.key),t.key.path.toArray()])}pn(e,t,i){const r=zr(e);let s=new de(Xn);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.Rn(i,t)])},(o,a)=>{s=s.add(new er(i.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,t){let i=new de(Xn);const r=this.An(t,e);if(r==null)return i;const s=dp(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Ra(o))for(const a of o.arrayValue.values||[])i=i.add(new er(t.indexId,e.key,this.Tn(a),r))}else i=i.add(new er(t.indexId,e.key,Ul,r));return i}wn(e,t,i,r,s){B("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,u,h,p,f){const v=l.getIterator(),I=u.getIterator();let b=Ur(v),T=Ur(I);for(;b||T;){let y=!1,g=!1;if(b&&T){const w=h(b,T);w<0?g=!0:w>0&&(y=!0)}else b!=null?g=!0:y=!0;y?(p(T),T=Ur(I)):g?(f(b),b=Ur(v)):(b=Ur(v),T=Ur(I))}}(r,s,Xn,a=>{o.push(this.Sn(e,t,i,a))},a=>{o.push(this.bn(e,t,i,a))}),V.waitFor(o)}gn(e){let t=1;return $r(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,a)=>Xn(o,a)).filter((o,a,l)=>!a||Xn(o,l[a-1])!==0);const r=[];r.push(e);for(const o of i){const a=Xn(o,e),l=Xn(o,t);if(a===0)r[0]=e.Jt();else if(a>0&&l<0)r.push(o),r.push(o.Jt());else if(l>0)break}r.push(t);const s=[];for(let o=0;o<r.length;o+=2){if(this.Dn(r[o],r[o+1]))return[];const a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ul,[]],l=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ul,[]];s.push(IDBKeyRange.bound(a,l))}return s}Dn(e,t){return Xn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(s_)}getMinOffset(e,t){return V.mapArray(this.cn(t),i=>this.ln(e,i).next(r=>r||K())).next(s_)}}function r_(n){return Xe(n,"collectionParents")}function zr(n){return Xe(n,"indexEntries")}function So(n){return Xe(n,"indexConfiguration")}function $r(n){return Xe(n,"indexState")}function s_(n){W(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Gf(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ft(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Tt{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new Tt(e,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(n,e,t){const i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=i.J({range:o},(h,p,f)=>(a++,f.delete()));s.push(l.next(()=>{W(a===1)}));const u=[];for(const h of t.mutations){const p=aE(e,h.key.path,t.batchId);s.push(r.delete(p)),u.push(h.key)}return V.waitFor(s).next(()=>u)}function Jc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw K();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tt.DEFAULT_COLLECTION_PERCENTILE=10,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tt.DEFAULT=new Tt(41943040,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tt.DISABLED=new Tt(-1,0,0);class Pu{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Cn={}}static lt(e,t,i,r){W(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Pu(s,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yn(e).J({index:"userMutationsIndex",range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){const s=Yr(e),o=Yn(e);return o.add({}).next(a=>{W(typeof a=="number");const l=new Zf(a,t,i,r),u=function(v,I,b){const T=b.baseMutations.map(g=>Va(v.ct,g)),y=b.mutations.map(g=>Va(v.ct,g));return{userId:I,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:T,mutations:y}}(this.serializer,this.userId,l),h=[];let p=new de((f,v)=>Z(f.canonicalString(),v.canonicalString()));for(const f of r){const v=aE(this.userId,f.key.path,a);p=p.add(f.key.path.popLast()),h.push(o.put(u)),h.push(s.put(v,Zk))}return p.forEach(f=>{h.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Cn[a]=l.keys()}),V.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return Yn(e).get(t).next(i=>i?(W(i.userId===this.userId),Ji(this.serializer,i)):null)}vn(e,t){return this.Cn[t]?V.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const r=i.keys();return this.Cn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return Yn(e).J({index:"userMutationsIndex",range:r},(o,a,l)=>{a.userId===this.userId&&(W(a.batchId>=i),s=Ji(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return Yn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Yn(e).U("userMutationsIndex",t).next(i=>i.map(r=>Ji(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=sc(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Yr(e).J({range:r},(o,a,l)=>{const[u,h,p]=o,f=un(h);if(u===this.userId&&t.path.isEqual(f))return Yn(e).get(p).next(v=>{if(!v)throw K();W(v.userId===this.userId),s.push(Ji(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new de(Z);const r=[];return t.forEach(s=>{const o=sc(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Yr(e).J({range:a},(u,h,p)=>{const[f,v,I]=u,b=un(v);f===this.userId&&s.path.isEqual(b)?i=i.add(I):p.done()});r.push(l)}),V.waitFor(r).next(()=>this.Fn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,s=sc(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new de(Z);return Yr(e).J({range:o},(l,u,h)=>{const[p,f,v]=l,I=un(f);p===this.userId&&i.isPrefixOf(I)?I.length===r&&(a=a.add(v)):h.done()}).next(()=>this.Fn(e,a))}Fn(e,t){const i=[],r=[];return t.forEach(s=>{r.push(Yn(e).get(s).next(o=>{if(o===null)throw K();W(o.userId===this.userId),i.push(Ji(this.serializer,o))}))}),V.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return oT(e._e,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),V.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const i=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return Yr(e).J({range:i},(s,o,a)=>{if(s[0]===this.userId){const l=un(s[1]);r.push(l)}else a.done()}).next(()=>{W(r.length===0)})})}containsKey(e,t){return aT(e,this.userId,t)}xn(e){return lT(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function aT(n,e,t){const i=sc(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return Yr(n).J({range:s,H:!0},(a,l,u)=>{const[h,p,f]=a;h===e&&p===r&&(o=!0),u.done()}).next(()=>o)}function Yn(n){return Xe(n,"mutations")}function Yr(n){return Xe(n,"documentMutations")}function lT(n){return Xe(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ir(0)}static Ln(){return new Ir(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next(t=>{const i=new Ir(t.highestTargetId);return t.highestTargetId=i.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(t=>X.fromTimestamp(new Ie(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.Bn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Bn(e).next(i=>(i.targetCount+=1,this.Qn(t,i),this.kn(e,i))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>qr(e).delete(t.targetId)).next(()=>this.Bn(e)).next(i=>(W(i.targetCount>0),i.targetCount-=1,this.kn(e,i)))}removeTargets(e,t,i){let r=0;const s=[];return qr(e).J((o,a)=>{const l=Bo(a);l.sequenceNumber<=t&&i.get(l.targetId)===null&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(s)).next(()=>r)}forEachTarget(e,t){return qr(e).J((i,r)=>{const s=Bo(r);t(s)})}Bn(e){return a_(e).get("targetGlobalKey").next(t=>(W(t!==null),t))}kn(e,t){return a_(e).put("targetGlobalKey",t)}qn(e,t){return qr(e).put(iT(this.serializer,t))}Qn(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.Bn(e).next(t=>t.targetCount)}getTargetData(e,t){const i=_r(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return qr(e).J({range:r,index:"queryTargetsIndex"},(o,a,l)=>{const u=Bo(a);Ka(t,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,t,i){const r=[],s=ri(e);return t.forEach(o=>{const a=yt(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),V.waitFor(r)}removeMatchingKeys(e,t,i){const r=ri(e);return V.forEach(t,s=>{const o=yt(s.path);return V.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){const i=ri(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=ri(e);let s=ee();return r.J({range:i,H:!0},(o,a,l)=>{const u=un(o[1]),h=new q(u);s=s.add(h)}).next(()=>s)}containsKey(e,t){const i=yt(t.path),r=IDBKeyRange.bound([i],[eE(i)],!1,!0);let s=0;return ri(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return qr(e).get(t).next(i=>i?Bo(i):null)}}function qr(n){return Xe(n,"targets")}function a_(n){return Xe(n,"targetGlobal")}function ri(n){return Xe(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_([n,e],[t,i]){const r=Z(n,t);return r===0?Z(e,i):r}class pR{constructor(e){this.Kn=e,this.buffer=new de(l_),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();l_(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fR{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){B("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fi(t)?B("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Li(t)}await this.zn(3e5)})}}class mR{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return V.resolve(At.oe);const i=new pR(t);return this.jn.forEachTarget(e,r=>i.Wn(r.sequenceNumber)).next(()=>this.jn.Jn(e,r=>i.Wn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(B("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(o_)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),o_):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let i,r,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),r=this.params.maximumSequenceNumbersToCollect):r=p,o=Date.now(),this.nthSequenceNumber(e,r))).next(p=>(i=p,a=Date.now(),this.removeTargets(e,i,t))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(p=>(u=Date.now(),Kr()<=se.DEBUG&&B("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${p} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:p})))}}function gR(n,e){return new mR(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,t){this.db=e,this.garbageCollector=gR(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}Zn(e){let t=0;return this.Jn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(i,r)=>t(r))}addReference(e,t,i){return zl(e,i)}removeReference(e,t,i){return zl(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return zl(e,t)}er(e,t){return function(r,s){let o=!1;return lT(r).Y(a=>aT(r,a,s).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Xn(e,(o,a)=>{if(a<=t){const l=this.er(e,o).next(u=>{if(!u)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,X.min()),ri(e).delete(function(p){return[0,yt(p.path)]}(o))))});r.push(l)}}).next(()=>V.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return zl(e,t)}Xn(e,t){const i=ri(e);let r,s=At.oe;return i.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==At.oe&&t(new q(un(r)),s),s=u,r=l):s=At.oe}).next(()=>{s!==At.oe&&t(new q(un(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zl(n,e){return ri(n).put(function(i,r){return{targetId:0,path:yt(i.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.changes=new ji(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_e.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?V.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Gi(e).put(i)}removeEntry(e,t,i){return Gi(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xc(o),a[a.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.tr(e,i)))}getEntry(e,t){let i=_e.newInvalidDocument(t);return Gi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ao(t))},(r,s)=>{i=this.nr(t,s)}).next(()=>i)}rr(e,t){let i={size:0,document:_e.newInvalidDocument(t)};return Gi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ao(t))},(r,s)=>{i={document:this.nr(t,s),size:Jc(s)}}).next(()=>i)}getEntries(e,t){let i=Ct();return this.ir(e,t,(r,s)=>{const o=this.nr(r,s);i=i.insert(r,o)}).next(()=>i)}sr(e,t){let i=Ct(),r=new ge(q.comparator);return this.ir(e,t,(s,o)=>{const a=this.nr(s,o);i=i.insert(s,a),r=r.insert(s,Jc(o))}).next(()=>({documents:i,_r:r}))}ir(e,t,i){if(t.isEmpty())return V.resolve();let r=new de(h_);t.forEach(l=>r=r.add(l));const s=IDBKeyRange.bound(Ao(r.first()),Ao(r.last())),o=r.getIterator();let a=o.getNext();return Gi(e).J({index:"documentKeyIndex",range:s},(l,u,h)=>{const p=q.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&h_(a,p)<0;)i(a,null),a=o.getNext();a&&a.isEqual(p)&&(i(a,u),a=o.hasNext()?o.getNext():null),a?h.$(Ao(a)):h.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Xc(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gi(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let h=Ct();for(const p of u){const f=this.nr(q.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);f.isFoundDocument()&&(Wa(t,f)||r.has(f.key))&&(h=h.insert(f.key,f))}return h})}getAllFromCollectionGroup(e,t,i,r){let s=Ct();const o=u_(t,i),a=u_(t,Ft.max());return Gi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const p=this.nr(q.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===r&&h.done()}).next(()=>s)}newChangeBuffer(e){return new _R(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return c_(e).get("remoteDocumentGlobalKey").next(t=>(W(!!t),t))}tr(e,t){return c_(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const i=iR(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(X.min())))return i}return _e.newInvalidDocument(e)}}function uT(n){return new yR(n)}class _R extends cT{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new ji(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const t=[];let i=0,r=new de((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=Wy(this.ar.serializer,o);r=r.add(s.path.popLast());const u=Jc(l);i+=u-a.size,t.push(this.ar.addEntry(e,s,l))}else if(i-=a.size,this.trackRemovals){const l=Wy(this.ar.serializer,o.convertToNoDocument(X.min()));t.push(this.ar.addEntry(e,s,l))}}),r.forEach(s=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.ar.updateMetadata(e,i)),V.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(i=>(this.ur.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:i,_r:r})=>(r.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:i.get(s).readTime})}),i))}}function c_(n){return Xe(n,"remoteDocumentGlobal")}function Gi(n){return Xe(n,"remoteDocumentsV14")}function Ao(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function u_(n,e){const t=e.documentKey.path.toArray();return[n,Xc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function h_(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=Z(t[s],i[s]),r)return r;return r=Z(t.length,i.length),r||(r=Z(t[t.length-2],i[i.length-2]),r||Z(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&ea(i.mutation,r,bt.empty(),Ie.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,ee()).next(()=>i))}getLocalViewOfDocuments(e,t,i=ee()){const r=hn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Fo();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=hn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,ee()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=Ct();const o=Zo(),a=function(){return Zo()}();return t.forEach((l,u)=>{const h=i.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof qn)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),ea(h.mutation,u,h.mutation.getFieldMask(),Ie.now())):o.set(u.key,bt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var p;return a.set(u,new xR(h,(p=o.get(u))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){const i=Zo();let r=new ge((o,a)=>o-a),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=i.get(l)||bt.empty();h=a.applyToLocalView(u,h),i.set(l,h);const p=(r.get(a.batchId)||ee()).add(l);r=r.insert(a.batchId,p)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,p=kE();h.forEach(f=>{if(!s.has(f)){const v=LE(t.get(f),i.get(f));v!==null&&p.set(f,v),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return V.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return q.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):V.resolve(hn());let a=-1,l=s;return o.next(u=>V.forEach(u,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,ee())).next(h=>({batchId:a,changes:CE(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next(i=>{let r=Fo();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Fo();return this.indexManager.getCollectionParents(e,s).next(a=>V.forEach(a,l=>{const u=function(p,f){return new $n(f,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(h=>{h.forEach((p,f)=>{o=o.insert(p,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,_e.newInvalidDocument(h)))});let a=Fo();return o.forEach((l,u)=>{const h=s.get(l);h!==void 0&&ea(h.mutation,u,bt.empty(),Ie.now()),Wa(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return V.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:Le(r.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(r){return{name:r.name,query:rm(r.bundledQuery),readTime:Le(r.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(){this.overlays=new ge(q.comparator),this.hr=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const i=hn();return V.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.hr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(i)),V.resolve()}getOverlaysForCollection(e,t,i){const r=hn(),s=t.length+1,o=new q(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return V.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new ge((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let h=s.get(u.largestBatchId);h===null&&(h=hn(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=hn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return V.resolve(a)}ht(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.hr.get(r.largestBatchId).delete(i.key);this.hr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new tm(t,i));let s=this.hr.get(t);s===void 0&&(s=ee(),this.hr.set(t,s)),this.hr.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(){this.Pr=new de(He.Ir),this.Tr=new de(He.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const i=new He(e,t);this.Pr=this.Pr.add(i),this.Tr=this.Tr.add(i)}dr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Ar(new He(e,t))}Rr(e,t){e.forEach(i=>this.removeReference(i,t))}Vr(e){const t=new q(new ie([])),i=new He(t,e),r=new He(t,e+1),s=[];return this.Tr.forEachInRange([i,r],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new q(new ie([])),i=new He(t,e),r=new He(t,e+1);let s=ee();return this.Tr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new He(e,0),i=this.Pr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class He{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return q.comparator(e.key,t.key)||Z(e.pr,t.pr)}static Er(e,t){return Z(e.pr,t.pr)||q.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new de(He.Ir)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Zf(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.wr=this.wr.add(new He(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.br(i),s=r<0?0:r;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new He(t,0),r=new He(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([i,r],o=>{const a=this.Sr(o.pr);s.push(a)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new de(Z);return t.forEach(r=>{const s=new He(r,0),o=new He(r,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{i=i.add(a.pr)})}),V.resolve(this.Dr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;q.isDocumentKey(s)||(s=s.child(""));const o=new He(new q(s),0);let a=new de(Z);return this.wr.forEachWhile(l=>{const u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(a=a.add(l.pr)),!0)},o),V.resolve(this.Dr(a))}Dr(e){const t=[];return e.forEach(i=>{const r=this.Sr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){W(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.wr;return V.forEach(t.mutations,r=>{const s=new He(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.wr=i})}Mn(e){}containsKey(e,t){const i=new He(t,0),r=this.wr.firstAfterOrEqual(i);return V.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.vr=e,this.docs=function(){return new ge(q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.vr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return V.resolve(i?i.document.mutableCopy():_e.newInvalidDocument(t))}getEntries(e,t){let i=Ct();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():_e.newInvalidDocument(r))}),V.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Ct();const o=t.path,a=new q(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Gf(nE(h),i)<=0||(r.has(h.key)||Wa(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,i,r){K()}Fr(e,t){return V.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new SR(this)}getSize(e){return V.resolve(this.size)}}class SR extends cT{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(i)}),V.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.persistence=e,this.Mr=new ji(t=>_r(t),Ka),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Or=0,this.Nr=new am,this.targetCount=0,this.Lr=Ir.Nn()}forEachTarget(e,t){return this.Mr.forEach((i,r)=>t(r)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Or&&(this.Or=t),V.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ir(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.qn(t),V.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),V.waitFor(s).next(()=>r)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const i=this.Mr.get(t)||null;return V.resolve(i)}addMatchingKeys(e,t,i){return this.Nr.dr(t,i),V.resolve()}removeMatchingKeys(e,t,i){this.Nr.Rr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Nr.gr(t);return V.resolve(i)}containsKey(e,t){return V.resolve(this.Nr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,t){this.Br={},this.overlays={},this.kr=new At(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new AR(this),this.indexManager=new uR,this.remoteDocumentCache=function(r){return new IR(r)}(i=>this.referenceDelegate.Kr(i)),this.serializer=new nT(t),this.$r=new wR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ER,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.Br[e.toKey()];return i||(i=new TR(t,this.referenceDelegate),this.Br[e.toKey()]=i),i}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,i){B("MemoryPersistence","Starting transaction:",e);const r=new bR(this.kr.next());return this.referenceDelegate.Ur(),i(r).next(s=>this.referenceDelegate.Wr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gr(e,t){return V.or(Object.values(this.Br).map(i=>()=>i.containsKey(e,t)))}}class bR extends rE{constructor(e){super(),this.currentSequenceNumber=e}}class Ru{constructor(e){this.persistence=e,this.zr=new am,this.jr=null}static Hr(e){return new Ru(e)}get Jr(){if(this.jr)return this.jr;throw K()}addReference(e,t,i){return this.zr.addReference(i,t),this.Jr.delete(i.toString()),V.resolve()}removeReference(e,t,i){return this.zr.removeReference(i,t),this.Jr.add(i.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),V.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(r=>this.Jr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Jr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Jr,i=>{const r=q.fromPath(i);return this.Yr(e,r).next(s=>{s||t.removeEntry(r,X.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(i=>{i?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return V.or([()=>V.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.serializer=e}O(e,t,i,r){const s=new Su("createOrUpgrade",t);i<1&&r>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ay,{unique:!0}),l.createObjectStore("documentMutations")}(e),d_(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return i<3&&r>=3&&(i!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),d_(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",h)}(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ay,{unique:!0});const p=u.store("mutations"),f=h.map(v=>p.put(v));return V.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),i<5&&r>=5&&(o=o.next(()=>this.Xr(s))),i<6&&r>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),i<7&&r>=7&&(o=o.next(()=>this.ti(s))),i<8&&r>=8&&(o=o.next(()=>this.ni(e,s))),i<9&&r>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&r>=10&&(o=o.next(()=>this.ri(s))),i<11&&r>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:hP});u.createIndex("collectionPathOverlayIndex",dP,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",pP,{unique:!1})})(e)})),i<13&&r>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:eP});u.createIndex("documentKeyIndex",tP),u.createIndex("collectionGroupIndex",nP)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.si(e,s))),i<15&&r>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:aP}).createIndex("sequenceNumberIndex",lP,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:cP}).createIndex("documentKeyIndex",uP,{unique:!1})}(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),o}ei(e){let t=0;return e.store("remoteDocuments").J((i,r)=>{t+=Jc(r)}).next(()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Xr(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next(r=>V.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",o).next(a=>V.forEach(a,l=>{W(l.userId===s.userId);const u=Ji(this.serializer,l);return oT(e,s.userId,u).next(()=>{})}))}))}ti(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.J((o,a)=>{const l=new ie(o),u=function(p){return[0,yt(p)]}(l);s.push(t.get(u).next(h=>h?V.resolve():(p=>t.put({targetId:0,path:yt(p),sequenceNumber:r.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(s))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:oP});const i=t.store("collectionParents"),r=new om,s=o=>{if(r.add(o)){const a=o.lastSegment(),l=o.popLast();return i.put({collectionId:a,parent:yt(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new ie(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],u)=>{const h=un(a);return s(h.popLast())}))}ri(e){const t=e.store("targets");return t.J((i,r)=>{const s=Bo(r),o=iT(this.serializer,s);return t.put(o)})}ii(e,t){const i=t.store("remoteDocuments"),r=[];return i.J((s,o)=>{const a=t.store("remoteDocumentsV14"),l=function(p){return p.document?new q(ie.fromString(p.document.name).popFirst(5)):p.noDocument?q.fromSegments(p.noDocument.path):p.unknownDocument?q.fromSegments(p.unknownDocument.path):K()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>V.waitFor(r))}si(e,t){const i=t.store("mutations"),r=uT(this.serializer),s=new dT(Ru.Hr,this.serializer.ct);return i.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let h=(u=a.get(l.userId))!==null&&u!==void 0?u:ee();Ji(this.serializer,l).keys().forEach(p=>h=h.add(p)),a.set(l.userId,h)}),V.forEach(a,(l,u)=>{const h=new Ke(u),p=ku.lt(this.serializer,h),f=s.getIndexManager(h),v=Pu.lt(h,this.serializer,f,s.referenceDelegate);return new hT(r,v,p,f).recalculateAndSaveOverlaysForDocumentKeys(new pp(t,At.oe),l).next()})})}}function d_(n){n.createObjectStore("targetDocuments",{keyPath:rP}).createIndex("documentTargetsIndex",sP,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",iP,{unique:!0}),n.createObjectStore("targetGlobal")}const Zh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class lm{constructor(e,t,i,r,s,o,a,l,u,h,p=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=h,this.ui=p,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=f=>Promise.resolve(),!lm.D())throw new j(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vR(this,r),this.Ti=t+"main",this.serializer=new nT(l),this.Ei=new gn(this.Ti,this.ui,new CR(this.serializer)),this.Qr=new dR(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uT(this.serializer),this.$r=new rR,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,h===!1&&Oe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new j(O.FAILED_PRECONDITION,Zh);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new At(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(async()=>{this.started&&await this.Ai()}))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$l(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(t=>{t||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Fi(e))return B("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return B("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return bo(e).get("owner").next(t=>V.resolve(this.Si(t)))}bi(e){return $l(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const i=Xe(t,"clientMetadata");return i.U().next(r=>{const s=this.vi(r,18e5),o=r.filter(a=>s.indexOf(a)===-1);return V.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?V.resolve(!0):bo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new j(O.FAILED_PRECONDITION,Zh);return!1}}return!(!this.networkEnabled||!this.inForeground)||$l(e).U().next(i=>this.vi(i,5e3).find(r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&B("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new pp(e,At.oe);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Li()}vi(e,t){return e.filter(i=>this.Ci(i.updateTimeMs,t)&&!this.Mi(i.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>$l(e).U().next(t=>this.vi(t,18e5).map(i=>i.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return Pu.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new hR(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ku.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,i){B("IndexedDbPersistence","Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",s=function(l){return l===16?mP:l===15?hE:l===14?uE:l===13?cE:l===12?fP:l===11?lE:void K()}(this.ui);let o;return this.Ei.runTransaction(e,r,s,a=>(o=new pp(a,this.kr?this.kr.next():At.oe),t==="readwrite-primary"?this.gi(o).next(l=>!!l||this.pi(o)).next(l=>{if(!l)throw Oe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new j(O.FAILED_PRECONDITION,iE);return i(o)}).next(l=>this.wi(o).next(()=>l)):this.ki(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return bo(e).get("owner").next(t=>{if(t!==null&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)&&!this.Si(t)&&!(this.ai||this.allowTabSynchronization&&t.allowTabSynchronization))throw new j(O.FAILED_PRECONDITION,Zh)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bo(e).put("owner",t)}static D(){return gn.D()}yi(e){const t=bo(e);return t.get("owner").next(i=>this.Si(i)?(B("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Ci(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Oe(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;P0()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const i=((t=this.di)===null||t===void 0?void 0:t.getItem(this.Fi(e)))!==null;return B("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Oe("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Oe("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bo(n){return Xe(n,"owner")}function $l(n){return Xe(n,"clientMetadata")}function cm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.qi=i,this.Qi=r}static Ki(e,t){let i=ee(),r=ee();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new um(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return P0()?8:sE(qc())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ji(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new kR;return this.Ji(e,t,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>s.result)}Yi(e,t,i,r){return i.documentReadCount<this.Wi?(Kr()<=se.DEBUG&&B("QueryEngine","SDK will not create cache indexes for query:",Qr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),V.resolve()):(Kr()<=se.DEBUG&&B("QueryEngine","Query:",Qr(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Gi*r?(Kr()<=se.DEBUG&&B("QueryEngine","The SDK decides to create cache indexes for query:",Qr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_t(t))):V.resolve())}ji(e,t){if(Fy(t))return V.resolve(null);let i=_t(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Wc(t,null,"F"),i=_t(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=ee(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const u=this.Zi(t,a);return this.Xi(t,u,o,l.readTime)?this.ji(e,Wc(t,null,"F")):this.es(e,u,t,l)}))})))}Hi(e,t,i,r){return Fy(t)||r.isEqual(X.min())?V.resolve(null):this.zi.getDocuments(e,i).next(s=>{const o=this.Zi(t,s);return this.Xi(t,o,i,r)?V.resolve(null):(Kr()<=se.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qr(t)),this.es(e,o,t,tE(r,-1)).next(a=>a))})}Zi(e,t){let i=new de(AE(e));return t.forEach((r,s)=>{Wa(e,s)&&(i=i.add(s))}),i}Xi(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ji(e,t,i){return Kr()<=se.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",Qr(t)),this.zi.getDocumentsMatchingQuery(e,t,Ft.min(),i)}es(e,t,i,r){return this.zi.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e,t,i,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new ge(Z),this.rs=new ji(s=>_r(s),Ka),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(i)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hT(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function fT(n,e,t,i){return new PR(n,e,t,i)}async function mT(n,e){const t=H(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t._s(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=ee();for(const u of r){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})}function RR(n,e){const t=H(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.os.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const p=u.batch,f=p.keys();let v=V.resolve();return f.forEach(I=>{v=v.next(()=>h.getEntry(l,I)).next(b=>{const T=u.docVersions.get(I);W(T!==null),b.version.compareTo(T)<0&&(p.applyToRemoteDocument(b,u),b.isValidDocument()&&(b.setReadTime(u.commitVersion),h.addEntry(b)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=ee();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function gT(n){const e=H(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function DR(n,e){const t=H(n),i=e.snapshotVersion;let r=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.os.newChangeBuffer({trackRemovals:!0});r=t.ns;const a=[];e.targetChanges.forEach((h,p)=>{const f=r.get(p);if(!f)return;a.push(t.Qr.removeMatchingKeys(s,h.removedDocuments,p).next(()=>t.Qr.addMatchingKeys(s,h.addedDocuments,p)));let v=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(qe.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,i)),r=r.insert(p,v),function(b,T,y){return b.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,v,h)&&a.push(t.Qr.updateTargetData(s,v))});let l=Ct(),u=ee();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(vT(s,o,e.documentUpdates).next(h=>{l=h.cs,u=h.ls})),!i.isEqual(X.min())){const h=t.Qr.getLastRemoteSnapshotVersion(s).next(p=>t.Qr.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(h)}return V.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.ns=r,s))}function vT(n,e,t){let i=ee(),r=ee();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=Ct();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):B("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{cs:o,ls:r}})}function NR(n,e){const t=H(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Ms(n,e){const t=H(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Qr.getTargetData(i,e).next(s=>s?(r=s,V.resolve(r)):t.Qr.allocateTargetId(i).next(o=>(r=new Nn(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Qr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.ns.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.ns=t.ns.insert(i.targetId,i),t.rs.set(e,i.targetId)),i})}async function Os(n,e,t){const i=H(n),r=i.ns.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Fi(o))throw o;B("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.ns=i.ns.remove(e),i.rs.delete(r.target)}function Zc(n,e,t){const i=H(n);let r=X.min(),s=ee();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const p=H(l),f=p.rs.get(h);return f!==void 0?V.resolve(p.ns.get(f)):p.Qr.getTargetData(u,h)}(i,o,_t(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.ts.getDocumentsMatchingQuery(o,e,t?r:X.min(),t?s:ee())).next(a=>(xT(i,SE(e),a),{documents:a,hs:s})))}function yT(n,e){const t=H(n),i=H(t.Qr),r=t.ns.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ot(s,e).next(o=>o?o.target:null))}function _T(n,e){const t=H(n),i=t.ss.get(e)||X.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.os.getAllFromCollectionGroup(r,e,tE(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(xT(t,e,r),r))}function xT(n,e,t){let i=n.ss.get(e)||X.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.ss.set(e,i)}async function VR(n,e,t,i){const r=H(n);let s=ee(),o=Ct();for(const u of t){const h=e.Ps(u.metadata.name);u.document&&(s=s.add(h));const p=e.Is(u);p.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(h,p)}const a=r.os.newChangeBuffer({trackRemovals:!0}),l=await Ms(r,function(h){return _t(Gs(ie.fromString(`__bundle__/docs/${h}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",u=>vT(u,a,o).next(h=>(a.apply(u),h)).next(h=>r.Qr.removeMatchingKeysForTargetId(u,l.targetId).next(()=>r.Qr.addMatchingKeys(u,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(u,h.cs,h.ls)).next(()=>h.cs)))}async function MR(n,e,t=ee()){const i=await Ms(n,_t(rm(e.bundledQuery))),r=H(n);return r.persistence.runTransaction("Save named query","readwrite",s=>{const o=Le(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return r.$r.saveNamedQuery(s,e);const a=i.withResumeToken(qe.EMPTY_BYTE_STRING,o);return r.ns=r.ns.insert(a.targetId,a),r.Qr.updateTargetData(s,a).next(()=>r.Qr.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Qr.addMatchingKeys(s,t,i.targetId)).next(()=>r.$r.saveNamedQuery(s,e))})}function p_(n,e){return`firestore_clients_${n}_${e}`}function f_(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function ed(n,e){return`firestore_targets_${n}_${e}`}class eu{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Es(e,t,i){const r=JSON.parse(i);let s,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new j(r.error.code,r.error.message))),o?new eu(e,t,r.state,s):(Oe("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ta{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Es(e,t){const i=JSON.parse(t);let r,s=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(r=new j(i.error.code,i.error.message))),s?new ta(e,i.state,r):(Oe("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class tu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const i=JSON.parse(t);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=Yf();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=oE(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new tu(e,s):(Oe("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class hm{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new hm(t.clientId,t.onlineState):(Oe("SharedClientState",`Failed to parse online state: ${e}`),null)}}class bp{constructor(){this.activeTargetIds=Yf()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class td{constructor(e,t,i,r,s){this.window=e,this.oi=t,this.persistenceKey=i,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new ge(Z),this.started=!1,this.ys=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=p_(this.persistenceKey,this.Vs),this.Ss=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new bp),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Fs=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const i of e){if(i===this.Vs)continue;const r=this.getItem(p_(this.persistenceKey,i));if(r){const s=tu.Es(i,r);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const i=this.xs(t);i&&this.Os(i)}for(const i of this.ys)this.gs(i);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,i){this.Ls(e,t,i),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(ed(this.persistenceKey,e));if(i){const r=ta.Es(e,i);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ed(this.persistenceKey,e))}updateQueryState(e,t,i){this.qs(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Bs(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return B("SharedClientState","READ",e,t),t}setItem(e,t){B("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){B("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(B("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void Oe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.bs.test(t.key)){if(t.newValue==null){const i=this.$s(t.key);return this.Us(i,null)}{const i=this.Ws(t.key,t.newValue);if(i)return this.Us(i.clientId,i)}}else if(this.Ds.test(t.key)){if(t.newValue!==null){const i=this.Gs(t.key,t.newValue);if(i)return this.zs(i)}}else if(this.Cs.test(t.key)){if(t.newValue!==null){const i=this.js(t.key,t.newValue);if(i)return this.Hs(i)}}else if(t.key===this.vs){if(t.newValue!==null){const i=this.xs(t.newValue);if(i)return this.Os(i)}}else if(t.key===this.Ss){const i=function(s){let o=At.oe;if(s!=null)try{const a=JSON.parse(s);W(typeof a=="number"),o=a}catch(a){Oe("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);i!==At.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Fs){const i=this.Js(t.newValue);await Promise.all(i.map(r=>this.syncEngine.Ys(r)))}}}else this.ys.push(t)})}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,i){const r=new eu(this.currentUser,e,t,i),s=f_(this.persistenceKey,this.currentUser,e);this.setItem(s,r.ds())}Bs(e){const t=f_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,i){const r=ed(this.persistenceKey,e),s=new ta(e,t,i);this.setItem(r,s.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const i=this.$s(e);return tu.Es(i,t)}Gs(e,t){const i=this.Ds.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return eu.Es(new Ke(s),r,t)}js(e,t){const i=this.Cs.exec(e),r=Number(i[1]);return ta.Es(r,t)}xs(e){return hm.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);B("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const i=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),s=this.Ns(i),o=[],a=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.eo(o,a).then(()=>{this.ps=i})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Yf();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class wT{constructor(){this.no=new bp,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,i){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new bp,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{io(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ql=null;function nd(){return ql===null?ql=function(){return 268435456+Math.round(2147483648*Math.random())}():ql++,"0x"+ql.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="WebChannelConnection";class jR extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=i+"://"+t.host,this.So=`projects/${r}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Do(){return!1}Co(t,i,r,s,o){const a=nd(),l=this.vo(t,i.toUriEncodedString());B("RestConnection",`Sending RPC '${t}' ${a}:`,l,r);const u={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(u,s,o),this.Mo(t,l,u,r).then(h=>(B("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw on("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",r),h})}xo(t,i,r,s,o,a){return this.Co(t,i,r,s,o)}Fo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Hs}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}vo(t,i){const r=LR[t];return`${this.wo}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,i,r){const s=nd();return new Promise((o,a)=>{const l=new G0;l.setWithCredentials(!0),l.listenOnce(Q0.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ic.NO_ERROR:const h=l.getResponseJson();B(ct,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case ic.TIMEOUT:B(ct,`RPC '${e}' ${s} timed out`),a(new j(O.DEADLINE_EXCEEDED,"Request time out"));break;case ic.HTTP_ERROR:const p=l.getStatus();if(B(ct,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const v=f==null?void 0:f.error;if(v&&v.status&&v.message){const I=function(T){const y=T.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(y)>=0?y:O.UNKNOWN}(v.status);a(new j(I,v.message))}else a(new j(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new j(O.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{B(ct,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(r);B(ct,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",u,i,15)})}Oo(e,t,i){const r=nd(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Y0(),a=X0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.xmlHttpFactory=new K0({})),this.Fo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const h=s.join("");B(ct,`Creating RPC '${e}' stream ${r}: ${h}`,l);const p=o.createWebChannel(h,l);let f=!1,v=!1;const I=new FR({lo:T=>{v?B(ct,`Not sending because RPC '${e}' stream ${r} is closed:`,T):(f||(B(ct,`Opening RPC '${e}' stream ${r} transport.`),p.open(),f=!0),B(ct,`RPC '${e}' stream ${r} sending:`,T),p.send(T))},ho:()=>p.close()}),b=(T,y,g)=>{T.listen(y,w=>{try{g(w)}catch(k){setTimeout(()=>{throw k},0)}})};return b(p,Lo.EventType.OPEN,()=>{v||(B(ct,`RPC '${e}' stream ${r} transport opened.`),I.mo())}),b(p,Lo.EventType.CLOSE,()=>{v||(v=!0,B(ct,`RPC '${e}' stream ${r} transport closed`),I.po())}),b(p,Lo.EventType.ERROR,T=>{v||(v=!0,on(ct,`RPC '${e}' stream ${r} transport errored:`,T),I.po(new j(O.UNAVAILABLE,"The operation could not be completed")))}),b(p,Lo.EventType.MESSAGE,T=>{var y;if(!v){const g=T.data[0];W(!!g);const w=g,k=w.error||((y=w[0])===null||y===void 0?void 0:y.error);if(k){B(ct,`RPC '${e}' stream ${r} received error:`,k);const N=k.status;let M=function(S){const A=Fe[S];if(A!==void 0)return BE(A)}(N),E=k.message;M===void 0&&(M=O.INTERNAL,E="Unknown error status: "+N+" with message "+k.message),v=!0,I.po(new j(M,E)),p.close()}else B(ct,`RPC '${e}' stream ${r} received:`,g),I.yo(g)}}),b(a,W0.STAT_EVENT,T=>{T.stat===hp.PROXY?B(ct,`RPC '${e}' stream ${r} detected buffering proxy`):T.stat===hp.NOPROXY&&B(ct,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{I.fo()},0),I}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(){return typeof window<"u"?window:null}function uc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(n){return new KP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,t,i=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=t,this.No=i,this.Lo=r,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),i=Math.max(0,Date.now()-this.Qo),r=Math.max(0,t-i);r>0&&B("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,t,i,r,s,o,a,l){this.oi=e,this.Go=i,this.zo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new dm(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,t){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(Oe(t.toString()),Oe("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(t)}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.jo===t&&this.u_(i,r)},i=>{e(()=>{const r=new j(O.UNKNOWN,"Fetching auth token failed: "+i.message);return this.c_(r)})})}u_(e,t){const i=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{i(()=>this.listener.Po())}),this.stream.To(()=>{i(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(r=>{i(()=>this.c_(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(e){return B("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class BR extends TT{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=XP(this.serializer,e),i=function(s){if(!("targetChange"in s))return X.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?X.min():o.readTime?Le(o.readTime):X.min()}(e);return this.listener.h_(t,i)}P_(e){const t={};t.database=Ep(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=Kc(l)?{documents:XE(s,l)}:{query:YE(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=qE(s,o.resumeToken);const u=xp(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(X.min())>0){a.readTime=Vs(s,o.snapshotVersion.toTimestamp());const u=xp(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const i=JP(this.serializer,e);i&&(t.labels=i),this.i_(t)}I_(e){const t={};t.database=Ep(this.serializer),t.removeTarget=e,this.i_(t)}}class UR extends TT{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(W(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=YP(e.writeResults,e.commitTime),i=Le(e.commitTime);return this.listener.A_(i,t)}return W(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=Ep(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>Va(this.serializer,i))};this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.m_=!1}f_(){if(this.m_)throw new j(O.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,i,r){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,wp(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(O.UNKNOWN,s.toString())})}xo(e,t,i,r,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,wp(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new j(O.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class $R{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Oe(t),this.y_=!1):B("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{i.enqueueAndForget(async()=>{Bi(this)&&(B("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=H(l);u.M_.add(4),await Ws(u),u.N_.set("Unknown"),u.M_.delete(4),await el(u)}(this))})}),this.N_=new $R(i,r)}}async function el(n){if(Bi(n))for(const e of n.x_)await e(!0)}async function Ws(n){for(const e of n.x_)await e(!1)}function Du(n,e){const t=H(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),mm(t)?fm(t):Ys(t).Xo()&&pm(t,e))}function Ls(n,e){const t=H(n),i=Ys(t);t.F_.delete(e),i.Xo()&&IT(t,e),t.F_.size===0&&(i.Xo()?i.n_():Bi(t)&&t.N_.set("Unknown"))}function pm(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ys(n).P_(e)}function IT(n,e){n.L_.xe(e),Ys(n).I_(e)}function fm(n){n.L_=new $P({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ys(n).start(),n.N_.w_()}function mm(n){return Bi(n)&&!Ys(n).Zo()&&n.F_.size>0}function Bi(n){return H(n).M_.size===0}function ST(n){n.L_=void 0}async function HR(n){n.N_.set("Online")}async function GR(n){n.F_.forEach((e,t)=>{pm(n,e)})}async function KR(n,e){ST(n),mm(n)?(n.N_.D_(e),fm(n)):n.N_.set("Unknown")}async function QR(n,e,t){if(n.N_.set("Online"),e instanceof $E&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.F_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.F_.delete(a),r.L_.removeTarget(a))}(n,e)}catch(i){B("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await nu(n,i)}else if(e instanceof cc?n.L_.Ke(e):e instanceof zE?n.L_.He(e):n.L_.We(e),!t.isEqual(X.min()))try{const i=await gT(n.localStore);t.compareTo(i)>=0&&await function(s,o){const a=s.L_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.F_.get(u);h&&s.F_.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.F_.get(l);if(!h)return;s.F_.set(l,h.withResumeToken(qe.EMPTY_BYTE_STRING,h.snapshotVersion)),IT(s,l);const p=new Nn(h.target,l,u,h.sequenceNumber);pm(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(i){B("RemoteStore","Failed to raise snapshot:",i),await nu(n,i)}}async function nu(n,e,t){if(!Fi(e))throw e;n.M_.add(1),await Ws(n),n.N_.set("Offline"),t||(t=()=>gT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{B("RemoteStore","Retrying IndexedDB access"),await t(),n.M_.delete(1),await el(n)})}function AT(n,e){return e().catch(t=>nu(n,t,e))}async function Xs(n){const e=H(n),t=Pi(e);let i=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;WR(e);)try{const r=await NR(e.localStore,i);if(r===null){e.v_.length===0&&t.n_();break}i=r.batchId,XR(e,r)}catch(r){await nu(e,r)}bT(e)&&CT(e)}function WR(n){return Bi(n)&&n.v_.length<10}function XR(n,e){n.v_.push(e);const t=Pi(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function bT(n){return Bi(n)&&!Pi(n).Zo()&&n.v_.length>0}function CT(n){Pi(n).start()}async function YR(n){Pi(n).V_()}async function JR(n){const e=Pi(n);for(const t of n.v_)e.d_(t.mutations)}async function ZR(n,e,t){const i=n.v_.shift(),r=em.from(i,e,t);await AT(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await Xs(n)}async function eD(n,e){e&&Pi(n).E_&&await async function(i,r){if(function(o){return jE(o)&&o!==O.ABORTED}(r.code)){const s=i.v_.shift();Pi(i).t_(),await AT(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Xs(i)}}(n,e),bT(n)&&CT(n)}async function g_(n,e){const t=H(n);t.asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials");const i=Bi(t);t.M_.add(3),await Ws(t),i&&t.N_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),await el(t)}async function Cp(n,e){const t=H(n);e?(t.M_.delete(2),await el(t)):e||(t.M_.add(2),await Ws(t),t.N_.set("Unknown"))}function Ys(n){return n.B_||(n.B_=function(t,i,r){const s=H(t);return s.f_(),new BR(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Po:HR.bind(null,n),To:GR.bind(null,n),Ao:KR.bind(null,n),h_:QR.bind(null,n)}),n.x_.push(async e=>{e?(n.B_.t_(),mm(n)?fm(n):n.N_.set("Unknown")):(await n.B_.stop(),ST(n))})),n.B_}function Pi(n){return n.k_||(n.k_=function(t,i,r){const s=H(t);return s.f_(),new UR(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:YR.bind(null,n),Ao:eD.bind(null,n),R_:JR.bind(null,n),A_:ZR.bind(null,n)}),n.x_.push(async e=>{e?(n.k_.t_(),await Xs(n)):(await n.k_.stop(),n.v_.length>0&&(B("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))})),n.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new gm(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Js(n,e){if(Oe("AsyncQueue",`${e}: ${n}`),Fi(n))return new j(O.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.comparator=e?(t,i)=>e(t,i)||q.comparator(t.key,i.key):(t,i)=>q.comparator(t.key,i.key),this.keyedMap=Fo(),this.sortedSet=new ge(this.comparator)}static emptySet(e){return new vs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof vs)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new vs;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(){this.q_=new ge(q.comparator)}track(e){const t=e.doc.key,i=this.q_.get(t);i?e.type!==0&&i.type===3?this.q_=this.q_.insert(t,e):e.type===3&&i.type!==1?this.q_=this.q_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.q_=this.q_.remove(t):e.type===1&&i.type===2?this.q_=this.q_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):K():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,i)=>{e.push(i)}),e}}class Fs{constructor(e,t,i,r,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Fs(e,t,vs.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class nD{constructor(){this.queries=new ji(e=>IE(e),Qa),this.onlineState="Unknown",this.z_=new Set}}async function vm(n,e){const t=H(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.W_()&&e.G_()&&(i=2):(s=new tD,i=e.G_()?0:1);try{switch(i){case 0:s.K_=await t.onListen(r,!0);break;case 1:s.K_=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=Js(o,`Initialization of query '${Qr(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.U_.push(e),e.j_(t.onlineState),s.K_&&e.H_(s.K_)&&_m(t)}async function ym(n,e){const t=H(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?r=e.G_()?0:1:!s.W_()&&e.G_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function iD(n,e){const t=H(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.U_)a.H_(r)&&(i=!0);o.K_=r}}i&&_m(t)}function rD(n,e,t){const i=H(n),r=i.queries.get(e);if(r)for(const s of r.U_)s.onError(t);i.queries.delete(e)}function _m(n){n.z_.forEach(e=>{e.next()})}var kp,y_;(y_=kp||(kp={})).J_="default",y_.Cache="cache";class xm{constructor(e,t,i){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=i||{}}H_(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Fs(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;const i=t!=="Offline";return(!this.options.ra||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Fs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==kp.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,t){this.ia=e,this.byteLength=t}sa(){return"metadata"in this.ia}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e){this.serializer=e}Ps(e){return vn(this.serializer,e)}Is(e){return e.metadata.exists?WE(this.serializer,e.document,!1):_e.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Le(e)}}class oD{constructor(e,t,i){this.oa=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=kT(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++t;const i=ie.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}aa(e){const t=new Map,i=new __(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.Ps(r.metadata.name);for(const o of r.metadata.queries){const a=(t.get(o)||ee()).add(s);t.set(o,a)}}return t}async complete(){const e=await VR(this.localStore,new __(this.serializer),this.documents,this.oa.id),t=this.aa(this.documents);for(const i of this.queries)await MR(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}}}function kT(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.key=e}}class RT{constructor(e){this.key=e}}class DT{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ee(),this.mutatedKeys=ee(),this.Ia=AE(e),this.Ta=new vs(this.Ia)}get Ea(){return this.la}da(e,t){const i=t?t.Aa:new v_,r=t?t.Ta:this.Ta;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,p)=>{const f=r.get(h),v=Wa(this.query,p)?p:null,I=!!f&&this.mutatedKeys.has(f.key),b=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let T=!1;f&&v?f.data.isEqual(v.data)?I!==b&&(i.track({type:3,doc:v}),T=!0):this.Ra(f,v)||(i.track({type:2,doc:v}),T=!0,(l&&this.Ia(v,l)>0||u&&this.Ia(v,u)<0)&&(a=!0)):!f&&v?(i.track({type:0,doc:v}),T=!0):f&&!v&&(i.track({type:1,doc:f}),T=!0,(l||u)&&(a=!0)),T&&(v?(o=o.add(v),s=b?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{Ta:o,Aa:i,Xi:a,mutatedKeys:s}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((h,p)=>function(v,I){const b=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K()}};return b(v)-b(I)}(h.type,p.type)||this.Ia(h.doc,p.doc)),this.Va(i),r=r!=null&&r;const a=t&&!r?this.ma():[],l=this.Pa.size===0&&this.current&&!r?1:0,u=l!==this.ha;return this.ha=l,o.length!==0||u?{snapshot:new Fs(this.query,e.Ta,s,o,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new v_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=ee(),this.Ta.forEach(i=>{this.ga(i.key)&&(this.Pa=this.Pa.add(i.key))});const t=[];return e.forEach(i=>{this.Pa.has(i)||t.push(new RT(i))}),this.Pa.forEach(i=>{e.has(i)||t.push(new PT(i))}),t}pa(e){this.la=e.hs,this.Pa=ee();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Fs.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class aD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class lD{constructor(e){this.key=e,this.wa=!1}}class cD{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new ji(a=>IE(a),Qa),this.Da=new Map,this.Ca=new Set,this.va=new ge(q.comparator),this.Fa=new Map,this.Ma=new am,this.xa={},this.Oa=new Map,this.Na=Ir.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function uD(n,e,t=!0){const i=Nu(n);let r;const s=i.ba.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.ya()):r=await NT(i,e,t,!0),r}async function hD(n,e){const t=Nu(n);await NT(t,e,!0,!1)}async function NT(n,e,t,i){const r=await Ms(n.localStore,_t(e)),s=r.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return i&&(a=await wm(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&Du(n.remoteStore,r),a}async function wm(n,e,t,i,r){n.Ba=(p,f,v)=>async function(b,T,y,g){let w=T.view.da(y);w.Xi&&(w=await Zc(b.localStore,T.query,!1).then(({documents:E})=>T.view.da(E,w)));const k=g&&g.targetChanges.get(T.targetId),N=g&&g.targetMismatches.get(T.targetId)!=null,M=T.view.applyChanges(w,b.isPrimaryClient,k,N);return Pp(b,T.targetId,M.fa),M.snapshot}(n,p,f,v);const s=await Zc(n.localStore,e,!0),o=new DT(e,s.hs),a=o.da(s.documents),l=Ja.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=o.applyChanges(a,n.isPrimaryClient,l);Pp(n,t,u.fa);const h=new aD(e,t,o);return n.ba.set(e,h),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),u.snapshot}async function dD(n,e,t){const i=H(n),r=i.ba.get(e),s=i.Da.get(r.targetId);if(s.length>1)return i.Da.set(r.targetId,s.filter(o=>!Qa(o,e))),void i.ba.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Os(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Ls(i.remoteStore,r.targetId),js(i,r.targetId)}).catch(Li)):(js(i,r.targetId),await Os(i.localStore,r.targetId,!0))}async function pD(n,e){const t=H(n),i=t.ba.get(e),r=t.Da.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ls(t.remoteStore,i.targetId))}async function fD(n,e,t){const i=Sm(n);try{const r=await function(o,a){const l=H(o),u=Ie.now(),h=a.reduce((v,I)=>v.add(I.key),ee());let p,f;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let I=Ct(),b=ee();return l.os.getEntries(v,h).next(T=>{I=T,I.forEach((y,g)=>{g.isValidDocument()||(b=b.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,I)).next(T=>{p=T;const y=[];for(const g of a){const w=BP(g,p.get(g.key).overlayedDocument);w!=null&&y.push(new qn(g.key,w,mE(w.value.mapValue),Te.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,y,a)}).next(T=>{f=T;const y=T.applyToLocalDocumentSet(p,b);return l.documentOverlayCache.saveOverlays(v,T.batchId,y)})}).then(()=>({batchId:f.batchId,changes:CE(p)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let u=o.xa[o.currentUser.toKey()];u||(u=new ge(Z)),u=u.insert(a,l),o.xa[o.currentUser.toKey()]=u}(i,r.batchId,t),await Hn(i,r.changes),await Xs(i.remoteStore)}catch(r){const s=Js(r,"Failed to persist write");t.reject(s)}}async function VT(n,e){const t=H(n);try{const i=await DR(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Fa.get(s);o&&(W(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.wa=!0:r.modifiedDocuments.size>0?W(o.wa):r.removedDocuments.size>0&&(W(o.wa),o.wa=!1))}),await Hn(t,i,e)}catch(i){await Li(i)}}function x_(n,e,t){const i=H(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.ba.forEach((s,o)=>{const a=o.view.j_(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=H(o);l.onlineState=a;let u=!1;l.queries.forEach((h,p)=>{for(const f of p.U_)f.j_(a)&&(u=!0)}),u&&_m(l)}(i.eventManager,e),r.length&&i.Sa.h_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function mD(n,e,t){const i=H(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Fa.get(e),s=r&&r.key;if(s){let o=new ge(q.comparator);o=o.insert(s,_e.newNoDocument(s,X.min()));const a=ee().add(s),l=new Ya(X.min(),new Map,new ge(Z),o,a);await VT(i,l),i.va=i.va.remove(s),i.Fa.delete(e),Im(i)}else await Os(i.localStore,e,!1).then(()=>js(i,e,t)).catch(Li)}async function gD(n,e){const t=H(n),i=e.batch.batchId;try{const r=await RR(t.localStore,e);Tm(t,i,null),Em(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Hn(t,r)}catch(r){await Li(r)}}async function vD(n,e,t){const i=H(n);try{const r=await function(o,a){const l=H(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(W(p!==null),h=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(i.localStore,e);Tm(i,e,t),Em(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Hn(i,r)}catch(r){await Li(r)}}async function yD(n,e){const t=H(n);Bi(t.remoteStore)||B("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await function(o){const a=H(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(i===-1)return void e.resolve();const r=t.Oa.get(i)||[];r.push(e),t.Oa.set(i,r)}catch(i){const r=Js(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function Em(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function Tm(n,e,t){const i=H(n);let r=i.xa[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.xa[i.currentUser.toKey()]=r}}function js(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Da.get(e))n.ba.delete(i),t&&n.Sa.ka(i,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(i=>{n.Ma.containsKey(i)||MT(n,i)})}function MT(n,e){n.Ca.delete(e.path.canonicalString());const t=n.va.get(e);t!==null&&(Ls(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),Im(n))}function Pp(n,e,t){for(const i of t)i instanceof PT?(n.Ma.addReference(i.key,e),_D(n,i)):i instanceof RT?(B("SyncEngine","Document no longer in limbo: "+i.key),n.Ma.removeReference(i.key,e),n.Ma.containsKey(i.key)||MT(n,i.key)):K()}function _D(n,e){const t=e.key,i=t.path.canonicalString();n.va.get(t)||n.Ca.has(i)||(B("SyncEngine","New document in limbo: "+t),n.Ca.add(i),Im(n))}function Im(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){const e=n.Ca.values().next().value;n.Ca.delete(e);const t=new q(ie.fromString(e)),i=n.Na.next();n.Fa.set(i,new lD(t)),n.va=n.va.insert(t,i),Du(n.remoteStore,new Nn(_t(Gs(t.path)),i,"TargetPurposeLimboResolution",At.oe))}}async function Hn(n,e,t){const i=H(n),r=[],s=[],o=[];i.ba.isEmpty()||(i.ba.forEach((a,l)=>{o.push(i.Ba(l,e,t).then(u=>{if((u||t)&&i.isPrimaryClient){const h=u&&!u.fromCache;i.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){r.push(u);const h=um.Ki(l.targetId,u);s.push(h)}}))}),await Promise.all(o),i.Sa.h_(r),await async function(l,u){const h=H(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>V.forEach(u,f=>V.forEach(f.qi,v=>h.persistence.referenceDelegate.addReference(p,f.targetId,v)).next(()=>V.forEach(f.Qi,v=>h.persistence.referenceDelegate.removeReference(p,f.targetId,v)))))}catch(p){if(!Fi(p))throw p;B("LocalStore","Failed to update sequence numbers: "+p)}for(const p of u){const f=p.targetId;if(!p.fromCache){const v=h.ns.get(f),I=v.snapshotVersion,b=v.withLastLimboFreeSnapshotVersion(I);h.ns=h.ns.insert(f,b)}}}(i.localStore,s))}async function xD(n,e){const t=H(n);if(!t.currentUser.isEqual(e)){B("SyncEngine","User change. New user:",e.toKey());const i=await mT(t.localStore,e);t.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(l=>{l.reject(new j(O.CANCELLED,o))})}),s.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Hn(t,i.us)}}function wD(n,e){const t=H(n),i=t.Fa.get(e);if(i&&i.wa)return ee().add(i.key);{let r=ee();const s=t.Da.get(e);if(!s)return r;for(const o of s){const a=t.ba.get(o);r=r.unionWith(a.view.Ea)}return r}}async function ED(n,e){const t=H(n),i=await Zc(t.localStore,e.query,!0),r=e.view.pa(i);return t.isPrimaryClient&&Pp(t,e.targetId,r.fa),r}async function TD(n,e){const t=H(n);return _T(t.localStore,e).then(i=>Hn(t,i))}async function ID(n,e,t,i){const r=H(n),s=await function(a,l){const u=H(a),h=H(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.vn(p,l).next(f=>f?u.localDocuments.getDocuments(p,f):V.resolve(null)))}(r.localStore,e);s!==null?(t==="pending"?await Xs(r.remoteStore):t==="acknowledged"||t==="rejected"?(Tm(r,e,i||null),Em(r,e),function(a,l){H(H(a).mutationQueue).Mn(l)}(r.localStore,e)):K(),await Hn(r,s)):B("SyncEngine","Cannot apply mutation batch with id: "+e)}async function SD(n,e){const t=H(n);if(Nu(t),Sm(t),e===!0&&t.La!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),r=await w_(t,i.toArray());t.La=!0,await Cp(t.remoteStore,!0);for(const s of r)Du(t.remoteStore,s)}else if(e===!1&&t.La!==!1){const i=[];let r=Promise.resolve();t.Da.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(js(t,o),Os(t.localStore,o,!0))),Ls(t.remoteStore,o)}),await r,await w_(t,i),function(o){const a=H(o);a.Fa.forEach((l,u)=>{Ls(a.remoteStore,u)}),a.Ma.mr(),a.Fa=new Map,a.va=new ge(q.comparator)}(t),t.La=!1,await Cp(t.remoteStore,!1)}}async function w_(n,e,t){const i=H(n),r=[],s=[];for(const o of e){let a;const l=i.Da.get(o);if(l&&l.length!==0){a=await Ms(i.localStore,_t(l[0]));for(const u of l){const h=i.ba.get(u),p=await ED(i,h);p.snapshot&&s.push(p.snapshot)}}else{const u=await yT(i.localStore,o);a=await Ms(i.localStore,u),await wm(i,OT(u),o,!1,a.resumeToken)}r.push(a)}return i.Sa.h_(s),r}function OT(n){return TE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function AD(n){return function(t){return H(H(t).persistence).Bi()}(H(n).localStore)}async function bD(n,e,t,i){const r=H(n);if(r.La)return void B("SyncEngine","Ignoring unexpected query state notification.");const s=r.Da.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await _T(r.localStore,SE(s[0])),a=Ya.createSynthesizedRemoteEventForCurrentChange(e,t==="current",qe.EMPTY_BYTE_STRING);await Hn(r,o,a);break}case"rejected":await Os(r.localStore,e,!0),js(r,e,i);break;default:K()}}async function CD(n,e,t){const i=Nu(n);if(i.La){for(const r of e){if(i.Da.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){B("SyncEngine","Adding an already active target "+r);continue}const s=await yT(i.localStore,r),o=await Ms(i.localStore,s);await wm(i,OT(s),o.targetId,!1,o.resumeToken),Du(i.remoteStore,o)}for(const r of t)i.Da.has(r)&&await Os(i.localStore,r,!1).then(()=>{Ls(i.remoteStore,r),js(i,r)}).catch(Li)}}function Nu(n){const e=H(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=VT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mD.bind(null,e),e.Sa.h_=iD.bind(null,e.eventManager),e.Sa.ka=rD.bind(null,e.eventManager),e}function Sm(n){const e=H(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vD.bind(null,e),e}function kD(n,e,t){const i=H(n);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(v,I){const b=H(v),T=Le(I.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",y=>b.$r.getBundleMetadata(y,I.id)).then(y=>!!y&&y.createTime.compareTo(T)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(kT(l));const u=new oD(l,s.localStore,o.serializer);let h=await o.qa();for(;h;){const f=await u._a(h);f&&a._updateProgress(f),h=await o.qa()}const p=await u.complete();return await Hn(s,p.ca,void 0),await function(v,I){const b=H(v);return b.persistence.runTransaction("Save bundle","readwrite",T=>b.$r.saveBundleMetadata(T,I))}(s.localStore,l),a._completeWith(p.progress),Promise.resolve(p.ua)}catch(l){return on("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}class Rp{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Za(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return fT(this.persistence,new pT,e.initialUser,this.serializer)}createPersistence(e){return new dT(Ru.Hr,this.serializer)}createSharedClientState(e){return new wT}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class LT extends Rp{constructor(e,t,i){super(),this.Qa=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Qa.initialize(this,e),await Sm(this.Qa.syncEngine),await Xs(this.Qa.remoteStore),await this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return fT(this.persistence,new pT,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new fR(i,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const i=new Yk(t,this.persistence);return new Xk(e.asyncQueue,i)}createPersistence(e){const t=cm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?Tt.withCacheSize(this.cacheSizeBytes):Tt.DEFAULT;return new lm(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,ET(),uc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new wT}}class PD extends LT{constructor(e,t){super(e,t,!1),this.Qa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Qa.syncEngine;this.sharedClientState instanceof td&&(this.sharedClientState.syncEngine={Zs:ID.bind(null,t),Xs:bD.bind(null,t),eo:CD.bind(null,t),Bi:AD.bind(null,t),Ys:TD.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi(async i=>{await SD(this.Qa.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=ET();if(!td.D(t))throw new j(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=cm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new td(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Am{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>x_(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=xD.bind(null,this.syncEngine),await Cp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new nD}()}createDatastore(e){const t=Za(e.databaseInfo.databaseId),i=function(s){return new jR(s)}(e.databaseInfo);return function(s,o,a,l){return new zR(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,r,s,o,a){return new qR(i,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>x_(this.syncEngine,t,0),function(){return m_.D()?new m_:new OR}())}createSyncEngine(e,t){return function(r,s,o,a,l,u,h){const p=new cD(r,s,o,a,l,u);return h&&(p.La=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(i){const r=H(i);B("RemoteStore","RemoteStore shutting down."),r.M_.add(5),await Ws(r),r.O_.shutdown(),r.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Oe("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,t){this.Ua=e,this.serializer=t,this.metadata=new We,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(i=>{i&&i.sa()?this.metadata.resolve(i.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.ia)}`))},i=>this.metadata.reject(i))}close(){return this.Ua.cancel()}async getMetadata(){return this.metadata.promise}async qa(){return await this.getMetadata(),this.Ga()}async Ga(){const e=await this.za();if(e===null)return null;const t=this.Wa.decode(e),i=Number(t);isNaN(i)&&this.ja(`length string (${t}) is not valid number`);const r=await this.Ha(i);return new sD(JSON.parse(r),e.length+i)}Ja(){return this.buffer.findIndex(e=>e===123)}async za(){for(;this.Ja()<0&&!await this.Ya(););if(this.buffer.length===0)return null;const e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ha(e){for(;this.buffer.length<e;)await this.Ya()&&this.ja("Reached the end of bundle when more is expected.");const t=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ya(){const e=await this.Ua.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new j(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(r,s){const o=H(r),a={documents:s.map(p=>Na(o.serializer,p))},l=await o.xo("BatchGetDocuments",o.serializer.databaseId,ie.emptyPath(),a,s.length),u=new Map;l.forEach(p=>{const f=WP(o.serializer,p);u.set(f.key.toString(),f)});const h=[];return s.forEach(p=>{const f=u.get(p.toString());W(!!f),h.push(f)}),h}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Qs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const r=q.fromPath(i);this.mutations.push(new Jf(r,this.precondition(r)))}),await async function(i,r){const s=H(i),o={writes:r.map(a=>Va(s.serializer,a))};await s.Co("Commit",s.serializer.databaseId,ie.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw K();t=X.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new j(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?Te.exists(!1):Te.updateTime(t):Te.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new j(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Te.updateTime(t)}return Te.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Za=i.maxAttempts,this.Yo=new dm(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(async()=>{const e=new DD(this.datastore),t=this.tu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.nu(r)}))}).catch(i=>{this.nu(i)})})}tu(e){try{const t=this.updateFunction(e);return!Ga(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!jE(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,t,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Ke.UNAUTHENTICATED,this.clientId=Z0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async s=>{B("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(B("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new j(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Js(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function hc(n,e){n.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await mT(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Dp(n,e){n.asyncQueue.verifyOperationInProgress();const t=await bm(n);B("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>g_(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>g_(e.remoteStore,r)),n._onlineComponents=e}function FT(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function bm(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){B("FirestoreClient","Using user provided OfflineComponentProvider");try{await hc(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!FT(t))throw t;on("Error using user provided cache. Falling back to memory cache: "+t),await hc(n,new Rp)}}else B("FirestoreClient","Using default OfflineComponentProvider"),await hc(n,new Rp);return n._offlineComponents}async function Mu(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(B("FirestoreClient","Using user provided OnlineComponentProvider"),await Dp(n,n._uninitializedComponentsProvider._online)):(B("FirestoreClient","Using default OnlineComponentProvider"),await Dp(n,new Am))),n._onlineComponents}function jT(n){return bm(n).then(e=>e.persistence)}function Cm(n){return bm(n).then(e=>e.localStore)}function BT(n){return Mu(n).then(e=>e.remoteStore)}function km(n){return Mu(n).then(e=>e.syncEngine)}function MD(n){return Mu(n).then(e=>e.datastore)}async function Bs(n){const e=await Mu(n),t=e.eventManager;return t.onListen=uD.bind(null,e.syncEngine),t.onUnlisten=dD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pD.bind(null,e.syncEngine),t}function OD(n){return n.asyncQueue.enqueue(async()=>{const e=await jT(n),t=await BT(n);return e.setNetworkEnabled(!0),function(r){const s=H(r);return s.M_.delete(0),el(s)}(t)})}function LD(n){return n.asyncQueue.enqueue(async()=>{const e=await jT(n),t=await BT(n);return e.setNetworkEnabled(!1),async function(r){const s=H(r);s.M_.add(0),await Ws(s),s.N_.set("Offline")}(t)})}function FD(n,e){const t=new We;return n.asyncQueue.enqueueAndForget(async()=>async function(r,s,o){try{const a=await function(u,h){const p=H(u);return p.persistence.runTransaction("read document","readonly",f=>p.localDocuments.getDocument(f,h))}(r,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new j(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=Js(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await Cm(n),e,t)),t.promise}function UT(n,e,t={}){const i=new We;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Vu({next:f=>{o.enqueueAndForget(()=>ym(s,p));const v=f.docs.has(a);!v&&f.fromCache?u.reject(new j(O.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&f.fromCache&&l&&l.source==="server"?u.reject(new j(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),p=new xm(Gs(a.path),h,{includeMetadataChanges:!0,ra:!0});return vm(s,p)}(await Bs(n),n.asyncQueue,e,t,i)),i.promise}function jD(n,e){const t=new We;return n.asyncQueue.enqueueAndForget(async()=>async function(r,s,o){try{const a=await Zc(r,s,!0),l=new DT(s,a.hs),u=l.da(a.documents),h=l.applyChanges(u,!1);o.resolve(h.snapshot)}catch(a){const l=Js(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await Cm(n),e,t)),t.promise}function zT(n,e,t={}){const i=new We;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Vu({next:f=>{o.enqueueAndForget(()=>ym(s,p)),f.fromCache&&l.source==="server"?u.reject(new j(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),p=new xm(a,h,{includeMetadataChanges:!0,ra:!0});return vm(s,p)}(await Bs(n),n.asyncQueue,e,t,i)),i.promise}function BD(n,e){const t=new Vu(e);return n.asyncQueue.enqueueAndForget(async()=>function(r,s){H(r).z_.add(s),s.next()}(await Bs(n),t)),()=>{t.$a(),n.asyncQueue.enqueueAndForget(async()=>function(r,s){H(r).z_.delete(s)}(await Bs(n),t))}}function UD(n,e,t,i){const r=function(o,a){let l;return l=typeof o=="string"?UE().encode(o):o,function(h,p){return new RD(h,p)}(function(h,p){if(h instanceof Uint8Array)return E_(h,p);if(h instanceof ArrayBuffer)return E_(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Za(e));n.asyncQueue.enqueueAndForget(async()=>{kD(await km(n),r,i)})}function zD(n,e){return n.asyncQueue.enqueue(async()=>function(i,r){const s=H(i);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,r))}(await Cm(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(n,e,t){if(!t)throw new j(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function qT(n,e,t,i){if(e===!0&&i===!0)throw new j(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function I_(n){if(!q.isDocumentKey(n))throw new j(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function S_(n){if(q.isDocumentKey(n))throw new j(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ou(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":K()}function le(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new j(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ou(n);throw new j(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function HT(n,e){if(e<=0)throw new j(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new j(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new j(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$T((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tl{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new A_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new j(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new j(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new A_(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new jk;switch(i.type){case"firstParty":return new $k(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new j(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=T_.get(t);i&&(B("ComponentProvider","Removing Datastore"),T_.delete(t),i.terminate())}(this),Promise.resolve()}}function $D(n,e,t,i={}){var r;const s=(n=le(n,tl))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&on("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=Ke.MOCK_USER;else{a=aC(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new j(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ke(u)}n._authCredentials=new Bk(new J0(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xt=class GT{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new GT(this.firestore,e,this._query)}},Ce=class KT{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new KT(this.firestore,e,this._key)}},xi=class QT extends xt{constructor(e,t,i){super(e,t,Gs(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ce(this.firestore,null,new q(e))}withConverter(e){return new QT(this.firestore,e,this._path)}};function WT(n,e,...t){if(n=Ue(n),Pm("collection","path",e),n instanceof tl){const i=ie.fromString(e,...t);return S_(i),new xi(n,null,i)}{if(!(n instanceof Ce||n instanceof xi))throw new j(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ie.fromString(e,...t));return S_(i),new xi(n.firestore,null,i)}}function qD(n,e){if(n=le(n,tl),Pm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new j(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new xt(n,null,function(i){return new $n(ie.emptyPath(),i)}(e))}function iu(n,e,...t){if(n=Ue(n),arguments.length===1&&(e=Z0.newId()),Pm("doc","path",e),n instanceof tl){const i=ie.fromString(e,...t);return I_(i),new Ce(n,null,new q(i))}{if(!(n instanceof Ce||n instanceof xi))throw new j(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ie.fromString(e,...t));return I_(i),new Ce(n.firestore,n instanceof xi?n.converter:null,new q(i))}}function XT(n,e){return n=Ue(n),e=Ue(e),(n instanceof Ce||n instanceof xi)&&(e instanceof Ce||e instanceof xi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function YT(n,e){return n=Ue(n),e=Ue(e),n instanceof xt&&e instanceof xt&&n.firestore===e.firestore&&Qa(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new dm(this,"async_queue_retry"),this.hu=()=>{const t=uc();t&&B("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};const e=uc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=uc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new We;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Fi(e))throw e;B("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(i=>{this.au=i,this.uu=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw Oe("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.uu=!1,i))));return this.iu=t,t}enqueueAfterDelay(e,t,i){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const r=gm.createAndSchedule(this,e,t,i,s=>this.Eu(s));return this._u.push(r),r}Pu(){this.au&&K()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}function Np(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}class GD{constructor(){this._progressObserver={},this._taskCompletionResolver=new We,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD=-1;let Ne=class extends tl{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=function(){return new HD}(),this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||JT(this),this._firestoreClient.terminate()}};function Ye(n){return n._firestoreClient||JT(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function JT(n){var e,t,i;const r=n._freezeSettings(),s=function(a,l,u,h){return new yP(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,$T(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new VD(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function QD(n,e){eI(n=le(n,Ne));const t=Ye(n);if(t._uninitializedComponentsProvider)throw new j(O.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new Am;return ZT(t,r,new LT(r,i.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function WD(n){eI(n=le(n,Ne));const e=Ye(n);if(e._uninitializedComponentsProvider)throw new j(O.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),i=new Am;return ZT(e,i,new PD(i,t.cacheSizeBytes))}function ZT(n,e,t){const i=new We;return n.asyncQueue.enqueue(async()=>{try{await hc(n,t),await Dp(n,e),i.resolve()}catch(r){const s=r;if(!FT(s))throw s;on("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}}).then(()=>i.promise)}function XD(n){if(n._initialized&&!n._terminated)throw new j(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new We;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(i){if(!gn.D())return Promise.resolve();const r=i+"main";await gn.delete(r)}(cm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function YD(n){return function(t){const i=new We;return t.asyncQueue.enqueueAndForget(async()=>yD(await km(t),i)),i.promise}(Ye(n=le(n,Ne)))}function JD(n){return OD(Ye(n=le(n,Ne)))}function ZD(n){return LD(Ye(n=le(n,Ne)))}function eN(n,e){const t=Ye(n=le(n,Ne)),i=new GD;return UD(t,n._databaseId,e,i),i}function tN(n,e){return zD(Ye(n=le(n,Ne)),e).then(t=>t?new xt(n,null,t.query):null)}function eI(n){if(n._initialized||n._terminated)throw new j(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _n(qe.fromBase64String(e))}catch(t){throw new j(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _n(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ri=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new j(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ee(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dr=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new j(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new j(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=/^__.*__$/;class iN{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new qn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ks(e,this.data,t,this.fieldTransforms)}}class tI{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new qn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function nI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}class Fu{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new Fu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.wu(e),r}Su(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.gu({path:i,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return ru(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(nI(this.fu)&&nN.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class rN{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Za(e)}Fu(e,t,i,r=!1){return new Fu({fu:e,methodName:t,vu:i,path:Ee.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nr(n){const e=n._freezeSettings(),t=Za(n._databaseId);return new rN(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ju(n,e,t,i,r,s={}){const o=n.Fu(s.merge||s.mergeFields?2:0,e,t,r);Lm("Data must be an object, but it was:",o,i);const a=sI(i,o);let l,u;if(s.merge)l=new bt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const p of s.mergeFields){const f=Vp(e,p,t);if(!o.contains(f))throw new j(O.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);aI(h,f)||h.push(f)}l=new bt(h),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new iN(new tt(a),l,u)}class nl extends Dr{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nl}}function iI(n,e,t){return new Fu({fu:3,vu:e.settings.vu,methodName:n._methodName,yu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Rm extends Dr{_toFieldTransform(e){return new Xa(e.path,new Ds)}isEqual(e){return e instanceof Rm}}class Dm extends Dr{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=iI(this,e,!0),i=this.Mu.map(s=>Vr(s,t)),r=new xr(i);return new Xa(e.path,r)}isEqual(e){return e instanceof Dm&&Ta(this.Mu,e.Mu)}}class Nm extends Dr{constructor(e,t){super(e),this.Mu=t}_toFieldTransform(e){const t=iI(this,e,!0),i=this.Mu.map(s=>Vr(s,t)),r=new wr(i);return new Xa(e.path,r)}isEqual(e){return e instanceof Nm&&Ta(this.Mu,e.Mu)}}class Vm extends Dr{constructor(e,t){super(e),this.xu=t}_toFieldTransform(e){const t=new Ns(e.serializer,DE(e.serializer,this.xu));return new Xa(e.path,t)}isEqual(e){return e instanceof Vm&&this.xu===e.xu}}function Mm(n,e,t,i){const r=n.Fu(1,e,t);Lm("Data must be an object, but it was:",r,i);const s=[],o=tt.empty();Rr(i,(l,u)=>{const h=Fm(e,l,t);u=Ue(u);const p=r.Su(h);if(u instanceof nl)s.push(h);else{const f=Vr(u,p);f!=null&&(s.push(h),o.set(h,f))}});const a=new bt(s);return new tI(o,a,r.fieldTransforms)}function Om(n,e,t,i,r,s){const o=n.Fu(1,e,t),a=[Vp(e,i,t)],l=[r];if(s.length%2!=0)throw new j(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Vp(e,s[f])),l.push(s[f+1]);const u=[],h=tt.empty();for(let f=a.length-1;f>=0;--f)if(!aI(u,a[f])){const v=a[f];let I=l[f];I=Ue(I);const b=o.Su(v);if(I instanceof nl)u.push(v);else{const T=Vr(I,b);T!=null&&(u.push(v),h.set(v,T))}}const p=new bt(u);return new tI(h,p,o.fieldTransforms)}function rI(n,e,t,i=!1){return Vr(t,n.Fu(i?4:3,e))}function Vr(n,e){if(oI(n=Ue(n)))return Lm("Unsupported field value:",e,n),sI(n,e);if(n instanceof Dr)return function(i,r){if(!nI(r.fu))throw r.Du(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Du(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let l=Vr(a,r.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=Ue(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return DE(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Ie.fromDate(i);return{timestampValue:Vs(r.serializer,s)}}if(i instanceof Ie){const s=new Ie(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vs(r.serializer,s)}}if(i instanceof Lu)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof _n)return{bytesValue:qE(r.serializer,i._byteString)};if(i instanceof Ce){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:im(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.Du(`Unsupported field value: ${Ou(i)}`)}(n,e)}function sI(n,e){const t={};return dE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rr(n,(i,r)=>{const s=Vr(r,e.pu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function oI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ie||n instanceof Lu||n instanceof _n||n instanceof Ce||n instanceof Dr)}function Lm(n,e,t){if(!oI(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){const i=Ou(t);throw i==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+i)}}function Vp(n,e,t){if((e=Ue(e))instanceof Ri)return e._internalPath;if(typeof e=="string")return Fm(n,e);throw ru("Field path arguments must be of type string or ",n,!1,void 0,t)}const sN=new RegExp("[~\\*/\\[\\]]");function Fm(n,e,t){if(e.search(sN)>=0)throw ru(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ri(...e.split("."))._internalPath}catch{throw ru(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ru(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new j(O.INVALID_ARGUMENT,a+n+l)}function aI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ce(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Bu("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oN extends Ma{data(){return super.data()}}function Bu(n,e){return typeof e=="string"?Fm(n,e):e instanceof Ri?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new j(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jm{}class il extends jm{}function Jn(n,e,...t){let i=[];e instanceof jm&&i.push(e),i=i.concat(t),function(s){const o=s.filter(l=>l instanceof Bm).length,a=s.filter(l=>l instanceof Uu).length;if(o>1||o>0&&a>0)throw new j(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class Uu extends il{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Uu(e,t,i)}_apply(e){const t=this._parse(e);return uI(e._query,t),new xt(e.firestore,e.converter,_p(e._query,t))}_parse(e){const t=Nr(e.firestore);return function(s,o,a,l,u,h,p){let f;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new j(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){C_(p,h);const v=[];for(const I of p)v.push(b_(l,s,I));f={arrayValue:{values:v}}}else f=b_(l,s,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||C_(p,h),f=rI(a,o,p,h==="in"||h==="not-in");return re.create(u,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function aN(n,e,t){const i=e,r=Bu("where",n);return Uu._create(r,i,t)}class Bm extends jm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bm(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:ue.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)uI(o,l),o=_p(o,l)}(e._query,t),new xt(e.firestore,e.converter,_p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Um extends il{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Um(e,t)}_apply(e){const t=function(r,s,o){if(r.startAt!==null)throw new j(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new j(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Da(s,o)}(e._query,this._field,this._direction);return new xt(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new $n(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function lN(n,e="asc"){const t=e,i=Bu("orderBy",n);return Um._create(i,t)}class zu extends il{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new zu(e,t,i)}_apply(e){return new xt(e.firestore,e.converter,Wc(e._query,this._limit,this._limitType))}}function cN(n){return HT("limit",n),zu._create("limit",n,"F")}function uN(n){return HT("limitToLast",n),zu._create("limitToLast",n,"L")}class $u extends il{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new $u(e,t,i)}_apply(e){const t=cI(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(r,s){return new $n(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,t))}}function hN(...n){return $u._create("startAt",n,!0)}function dN(...n){return $u._create("startAfter",n,!1)}class qu extends il{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new qu(e,t,i)}_apply(e){const t=cI(e,this.type,this._docOrFields,this._inclusive);return new xt(e.firestore,e.converter,function(r,s){return new $n(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,t))}}function pN(...n){return qu._create("endBefore",n,!1)}function fN(...n){return qu._create("endAt",n,!0)}function cI(n,e,t,i){if(t[0]=Ue(t[0]),t[0]instanceof Ma)return function(s,o,a,l,u){if(!l)throw new j(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const p of gs(s))if(p.field.isKeyField())h.push(yr(o,l.key));else{const f=l.data.field(p.field);if(Au(f))throw new j(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const v=p.field.canonicalString();throw new j(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}h.push(f)}return new ki(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const r=Nr(n.firestore);return function(o,a,l,u,h,p){const f=o.explicitOrderBy;if(h.length>f.length)throw new j(O.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let I=0;I<h.length;I++){const b=h[I];if(f[I].field.isKeyField()){if(typeof b!="string")throw new j(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof b}`);if(!Xf(o)&&b.indexOf("/")!==-1)throw new j(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${b}' contains a slash.`);const T=o.path.child(ie.fromString(b));if(!q.isDocumentKey(T))throw new j(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const y=new q(T);v.push(yr(a,y))}else{const T=rI(l,u,b);v.push(T)}}return new ki(v,p)}(n._query,n.firestore._databaseId,r,e,t,i)}}function b_(n,e,t){if(typeof(t=Ue(t))=="string"){if(t==="")throw new j(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xf(e)&&t.indexOf("/")!==-1)throw new j(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ie.fromString(t));if(!q.isDocumentKey(i))throw new j(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return yr(n,new q(i))}if(t instanceof Ce)return yr(n,t._key);throw new j(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ou(t)}.`)}function C_(n,e){if(!Array.isArray(n)||n.length===0)throw new j(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uI(n,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new j(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class zm{convertValue(e,t="none"){switch(vr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return De(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw K()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Rr(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertGeoPoint(e){return new Lu(De(e.latitude),De(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Qf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(ka(e));default:return null}}convertTimestamp(e){const t=Bn(e);return new Ie(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ie.fromString(e);W(tT(i));const r=new bi(i.get(1),i.get(3)),s=new q(i.popFirst(5));return r.isEqual(t)||Oe(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class mN extends zm{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Un=class extends Ma{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new na(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Bu("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},na=class extends Un{data(e={}){return super.data(e)}},Di=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new sr(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new na(this._firestore,this._userDataWriter,i.key,i,new sr(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new j(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new na(r._firestore,r._userDataWriter,a.doc.key,a.doc,new sr(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new na(r._firestore,r._userDataWriter,a.doc.key,a.doc,new sr(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:gN(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function gN(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K()}}function hI(n,e){return n instanceof Un&&e instanceof Un?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Di&&e instanceof Di&&n._firestore===e._firestore&&YT(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(n){n=le(n,Ce);const e=le(n.firestore,Ne);return UT(Ye(e),n._key).then(t=>$m(e,n,t))}class Mr extends zm{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,t)}}function yN(n){n=le(n,Ce);const e=le(n.firestore,Ne),t=Ye(e),i=new Mr(e);return FD(t,n._key).then(r=>new Un(e,i,n._key,r,new sr(r!==null&&r.hasLocalMutations,!0),n.converter))}function _N(n){n=le(n,Ce);const e=le(n.firestore,Ne);return UT(Ye(e),n._key,{source:"server"}).then(t=>$m(e,n,t))}function xN(n){n=le(n,xt);const e=le(n.firestore,Ne),t=Ye(e),i=new Mr(e);return lI(n._query),zT(t,n._query).then(r=>new Di(e,i,n,r))}function wN(n){n=le(n,xt);const e=le(n.firestore,Ne),t=Ye(e),i=new Mr(e);return jD(t,n._query).then(r=>new Di(e,i,n,r))}function EN(n){n=le(n,xt);const e=le(n.firestore,Ne),t=Ye(e),i=new Mr(e);return zT(t,n._query,{source:"server"}).then(r=>new Di(e,i,n,r))}function k_(n,e,t){n=le(n,Ce);const i=le(n.firestore,Ne),r=Hu(n.converter,e,t);return rl(i,[ju(Nr(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Te.none())])}function P_(n,e,t,...i){n=le(n,Ce);const r=le(n.firestore,Ne),s=Nr(r);let o;return o=typeof(e=Ue(e))=="string"||e instanceof Ri?Om(s,"updateDoc",n._key,e,t,i):Mm(s,"updateDoc",n._key,e),rl(r,[o.toMutation(n._key,Te.exists(!0))])}function TN(n){return rl(le(n.firestore,Ne),[new Qs(n._key,Te.none())])}function IN(n,e){const t=le(n.firestore,Ne),i=iu(n),r=Hu(n.converter,e);return rl(t,[ju(Nr(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Te.exists(!1))]).then(()=>i)}function dI(n,...e){var t,i,r;n=Ue(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Np(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Np(e[o])){const p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(i=p.error)===null||i===void 0?void 0:i.bind(p),e[o+2]=(r=p.complete)===null||r===void 0?void 0:r.bind(p)}let l,u,h;if(n instanceof Ce)u=le(n.firestore,Ne),h=Gs(n._key.path),l={next:p=>{e[o]&&e[o]($m(u,n,p))},error:e[o+1],complete:e[o+2]};else{const p=le(n,xt);u=le(p.firestore,Ne),h=p._query;const f=new Mr(u);l={next:v=>{e[o]&&e[o](new Di(u,f,p,v))},error:e[o+1],complete:e[o+2]},lI(n._query)}return function(f,v,I,b){const T=new Vu(b),y=new xm(v,T,I);return f.asyncQueue.enqueueAndForget(async()=>vm(await Bs(f),y)),()=>{T.$a(),f.asyncQueue.enqueueAndForget(async()=>ym(await Bs(f),y))}}(Ye(u),h,a,l)}function SN(n,e){return BD(Ye(n=le(n,Ne)),Np(e)?e:{next:e})}function rl(n,e){return function(i,r){const s=new We;return i.asyncQueue.enqueueAndForget(async()=>fD(await km(i),r,s)),s.promise}(Ye(n),e)}function $m(n,e,t){const i=t.docs.get(e._key),r=new Mr(n);return new Un(n,r,e._key,i,new sr(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bN=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Nr(e)}set(e,t,i){this._verifyNotCommitted();const r=si(e,this._firestore),s=Hu(r.converter,t,i),o=ju(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,Te.none())),this}update(e,t,i,...r){this._verifyNotCommitted();const s=si(e,this._firestore);let o;return o=typeof(t=Ue(t))=="string"||t instanceof Ri?Om(this._dataReader,"WriteBatch.update",s._key,t,i,r):Mm(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Te.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=si(e,this._firestore);return this._mutations=this._mutations.concat(new Qs(t._key,Te.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new j(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function si(n,e){if((n=Ue(n)).firestore!==e)throw new j(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CN=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=Nr(t)}get(t){const i=si(t,this._firestore),r=new mN(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||s.length!==1)return K();const o=s[0];if(o.isFoundDocument())return new Ma(this._firestore,r,o.key,o,i.converter);if(o.isNoDocument())return new Ma(this._firestore,r,i._key,null,i.converter);throw K()})}set(t,i,r){const s=si(t,this._firestore),o=Hu(s.converter,i,r),a=ju(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,r);return this._transaction.set(s._key,a),this}update(t,i,r,...s){const o=si(t,this._firestore);let a;return a=typeof(i=Ue(i))=="string"||i instanceof Ri?Om(this._dataReader,"Transaction.update",o._key,i,r,s):Mm(this._dataReader,"Transaction.update",o._key,i),this._transaction.update(o._key,a),this}delete(t){const i=si(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=si(e,this._firestore),i=new Mr(this._firestore);return super.get(e).then(r=>new Un(this._firestore,i,t._key,r._document,new sr(!1,!1),t.converter))}};function kN(n,e,t){n=le(n,Ne);const i=Object.assign(Object.assign({},AN),t);return function(s){if(s.maxAttempts<1)throw new j(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,a){const l=new We;return s.asyncQueue.enqueueAndForget(async()=>{const u=await MD(s);new ND(s.asyncQueue,u,a,o,l).Xa()}),l.promise}(Ye(n),r=>e(new CN(n,r)),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(){return new nl("deleteField")}function RN(){return new Rm("serverTimestamp")}function DN(...n){return new Dm("arrayUnion",n)}function NN(...n){return new Nm("arrayRemove",n)}function VN(n){return new Vm("increment",n)}(function(e,t=!0){(function(r){Hs=r})(zf),Cs(new mr("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new Ne(new Uk(i.getProvider("auth-internal")),new Hk(i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new j(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bi(u.options.projectId,h)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Mn(Ty,"4.6.3",e),Mn(Ty,"4.6.3","esm2017")})();const MN="@firebase/firestore-compat",ON="0.3.32";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new j("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(){if(typeof Uint8Array>"u")throw new j("unimplemented","Uint8Arrays are not available in this environment.")}function D_(){if(!gP())throw new j("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Oa{constructor(e){this._delegate=e}static fromBase64String(e){return D_(),new Oa(_n.fromBase64String(e))}static fromUint8Array(e){return R_(),new Oa(_n.fromUint8Array(e))}toBase64(){return D_(),this._delegate.toBase64()}toUint8Array(){return R_(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(n){return LN(n,["next","error","complete"])}function LN(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{enableIndexedDbPersistence(e,t){return QD(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return WD(e._delegate)}clearIndexedDbPersistence(e){return XD(e._delegate)}}class pI{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof bi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&on("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){$D(this._delegate,e,t,i)}enableNetwork(){return JD(this._delegate)}disableNetwork(){return ZD(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,qT("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return YD(this._delegate)}onSnapshotsInSync(e){return SN(this._delegate,e)}get app(){if(!this._appCompat)throw new j("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Us(this,WT(this._delegate,e))}catch(t){throw gt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Ht(this,iu(this._delegate,e))}catch(t){throw gt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mt(this,qD(this._delegate,e))}catch(t){throw gt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return kN(this._delegate,t=>e(new fI(this,t)))}batch(){return Ye(this._delegate),new mI(new bN(this._delegate,e=>rl(this._delegate,e)))}loadBundle(e){return eN(this._delegate,e)}namedQuery(e){return tN(this._delegate,e).then(t=>t?new mt(this,t):null)}}class Gu extends zm{constructor(e){super(),this.firestore=e}convertBytes(e){return new Oa(new _n(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Ht.forKey(t,this.firestore,null)}}function jN(n){Lk(n)}class fI{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Gu(e)}get(e){const t=or(e);return this._delegate.get(t).then(i=>new La(this._firestore,new Un(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const r=or(e);return i?(qm("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=or(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=or(e);return this._delegate.delete(t),this}}class mI{constructor(e){this._delegate=e}set(e,t,i){const r=or(e);return i?(qm("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){const s=or(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){const t=or(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Sr{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new na(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Fa(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=Sr.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new Sr(e,new Gu(e),t),r.set(t,s)),s}}Sr.INSTANCES=new WeakMap;class Ht{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Gu(e)}static forPath(e,t,i){if(e.length%2!==0)throw new j("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ht(t,new Ce(t._delegate,i,new q(e)))}static forKey(e,t,i){return new Ht(t,new Ce(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Us(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Us(this.firestore,WT(this._delegate,e))}catch(t){throw gt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ue(e),e instanceof Ce?XT(this._delegate,e):!1}set(e,t){t=qm("DocumentReference.set",t);try{return t?k_(this._delegate,e,t):k_(this._delegate,e)}catch(i){throw gt(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?P_(this._delegate,e):P_(this._delegate,e,t,...i)}catch(r){throw gt(r,"updateDoc()","DocumentReference.update()")}}delete(){return TN(this._delegate)}onSnapshot(...e){const t=gI(e),i=vI(e,r=>new La(this.firestore,new Un(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return dI(this._delegate,t,i)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=yN(this._delegate):(e==null?void 0:e.source)==="server"?t=_N(this._delegate):t=vN(this._delegate),t.then(i=>new La(this.firestore,new Un(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new Ht(this.firestore,e?this._delegate.withConverter(Sr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function gt(n,e,t){return n.message=n.message.replace(e,t),n}function gI(n){for(const e of n)if(typeof e=="object"&&!Mp(e))return e;return{}}function vI(n,e){var t,i;let r;return Mp(n[0])?r=n[0]:Mp(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}class La{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Ht(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return hI(this._delegate,e._delegate)}}class Fa extends La{data(e){const t=this._delegate.data(e);return this._delegate._converter||Fk(t!==void 0),t}}class mt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Gu(e)}where(e,t,i){try{return new mt(this.firestore,Jn(this._delegate,aN(e,t,i)))}catch(r){throw gt(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new mt(this.firestore,Jn(this._delegate,lN(e,t)))}catch(i){throw gt(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new mt(this.firestore,Jn(this._delegate,cN(e)))}catch(t){throw gt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new mt(this.firestore,Jn(this._delegate,uN(e)))}catch(t){throw gt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new mt(this.firestore,Jn(this._delegate,hN(...e)))}catch(t){throw gt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new mt(this.firestore,Jn(this._delegate,dN(...e)))}catch(t){throw gt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new mt(this.firestore,Jn(this._delegate,pN(...e)))}catch(t){throw gt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new mt(this.firestore,Jn(this._delegate,fN(...e)))}catch(t){throw gt(t,"endAt()","Query.endAt()")}}isEqual(e){return YT(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=wN(this._delegate):(e==null?void 0:e.source)==="server"?t=EN(this._delegate):t=xN(this._delegate),t.then(i=>new Op(this.firestore,new Di(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=gI(e),i=vI(e,r=>new Op(this.firestore,new Di(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return dI(this._delegate,t,i)}withConverter(e){return new mt(this.firestore,e?this._delegate.withConverter(Sr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class BN{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Fa(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Op{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new mt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Fa(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new BN(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Fa(this._firestore,i))})}isEqual(e){return hI(this._delegate,e._delegate)}}class Us extends mt{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ht(this.firestore,e):null}doc(e){try{return e===void 0?new Ht(this.firestore,iu(this._delegate)):new Ht(this.firestore,iu(this._delegate,e))}catch(t){throw gt(t,"doc()","CollectionReference.doc()")}}add(e){return IN(this._delegate,e).then(t=>new Ht(this.firestore,t))}isEqual(e){return XT(this._delegate,e._delegate)}withConverter(e){return new Us(this.firestore,e?this._delegate.withConverter(Sr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function or(n){return le(n,Ce)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(...e){this._delegate=new Ri(...e)}static documentId(){return new Hm(Ee.keyField().canonicalString())}isEqual(e){return e=Ue(e),e instanceof Ri?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this._delegate=e}static serverTimestamp(){const e=RN();return e._methodName="FieldValue.serverTimestamp",new tr(e)}static delete(){const e=PN();return e._methodName="FieldValue.delete",new tr(e)}static arrayUnion(...e){const t=DN(...e);return t._methodName="FieldValue.arrayUnion",new tr(t)}static arrayRemove(...e){const t=NN(...e);return t._methodName="FieldValue.arrayRemove",new tr(t)}static increment(e){const t=VN(e);return t._methodName="FieldValue.increment",new tr(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN={Firestore:pI,GeoPoint:Lu,Timestamp:Ie,Blob:Oa,Transaction:fI,WriteBatch:mI,DocumentReference:Ht,DocumentSnapshot:La,Query:mt,QueryDocumentSnapshot:Fa,QuerySnapshot:Op,CollectionReference:Us,FieldPath:Hm,FieldValue:tr,setLogLevel:jN,CACHE_SIZE_UNLIMITED:KD};function zN(n,e){n.INTERNAL.registerComponent(new mr("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},UN)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $N(n){zN(n,(e,t)=>new pI(e,t,new FN)),n.registerVersion(MN,ON)}$N(Iu);const qN={apiKey:"AIzaSyCkSAEznD5f-jC0i_v9DXXA8Jnyw7jtVKw",authDomain:"apls-ce9eb.firebaseapp.com",projectId:"apls-ce9eb",storageBucket:"apls-ce9eb.appspot.com",messagingSenderId:"219761636584",appId:"1:219761636584:web:a8bdb56e5a0104edc3055d"},HN=Iu.initializeApp(qN),ia=Iu.firestore(HN),GN=[{id:1,time:"8:00 AM"},{id:2,time:"10:00 AM"},{id:3,time:"12:00 PM"},{id:4,time:"2:00 PM"},{id:5,time:"4:00 PM"}];async function KN(n){const t=await ia.collection("bookings").where("boardingSlot","==",n).get();let i=dc.find(s=>t.docs.filter(o=>o.data().carId===s.id).length<s.capacity);if(!i)throw new Error("No available seats for this boarding slot");const r=t.docs.filter(s=>s.data().carId===i.id).length+1;return{carId:i.id,seatNumber:r}}function QN(n){const e=new Date,[t,i]=n.split(":"),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),parseInt(t),parseInt(i));r<e&&r.setDate(r.getDate()+1);const s=r-e,o=Math.floor(s/36e5),a=Math.floor(s%36e5/6e4),l=Math.floor(s%6e4/1e3);return`${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`}const dc=[{id:1,capacity:100,model:"FUDMA001"},{id:2,capacity:100,model:"FUDMASCOS"},{id:3,capacity:30,model:"White Container"},{id:4,capacity:100,model:"Maryam Abacha"}];function WN(){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let t=0;t<8;t++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}var Ku={};const XN={},YN=Object.freeze(Object.defineProperty({__proto__:null,default:XN},Symbol.toStringTag,{value:"Module"})),Y=TS(YN);var yI={exports:{}},Gm={exports:{}};const N_=Y,V_=1800;let JN=class{constructor(e){this.options=e||{},this.cookies=[]}set(e,t){let i=N_.parse(t||""),r=this.parse(e),s;return r.domain?(s=r.domain.replace(/^\./,""),(i.hostname.length<s.length||("."+i.hostname).substr(-s.length+1)!=="."+s)&&(r.domain=i.hostname)):r.domain=i.hostname,r.path||(r.path=this.getPath(i.pathname)),r.expires||(r.expires=new Date(Date.now()+(Number(this.options.sessionTimeout||V_)||V_)*1e3)),this.add(r)}get(e){return this.list(e).map(t=>t.name+"="+t.value).join("; ")}list(e){let t=[],i,r;for(i=this.cookies.length-1;i>=0;i--){if(r=this.cookies[i],this.isExpired(r)){this.cookies.splice(i,i);continue}this.match(r,e)&&t.unshift(r)}return t}parse(e){let t={};return(e||"").toString().split(";").forEach(i=>{let r=i.split("="),s=r.shift().trim().toLowerCase(),o=r.join("=").trim(),a;if(s)switch(s){case"expires":o=new Date(o),o.toString()!=="Invalid Date"&&(t.expires=o);break;case"path":t.path=o;break;case"domain":a=o.toLowerCase(),a.length&&a.charAt(0)!=="."&&(a="."+a),t.domain=a;break;case"max-age":t.expires=new Date(Date.now()+(Number(o)||0)*1e3);break;case"secure":t.secure=!0;break;case"httponly":t.httponly=!0;break;default:t.name||(t.name=s,t.value=o)}}),t}match(e,t){let i=N_.parse(t||"");return!(i.hostname!==e.domain&&(e.domain.charAt(0)!=="."||("."+i.hostname).substr(-e.domain.length)!==e.domain)||this.getPath(i.pathname).substr(0,e.path.length)!==e.path||e.secure&&i.protocol!=="https:")}add(e){let t,i;if(!e||!e.name)return!1;for(t=0,i=this.cookies.length;t<i;t++)if(this.compare(this.cookies[t],e))return this.isExpired(e)?(this.cookies.splice(t,1),!1):(this.cookies[t]=e,!0);return this.isExpired(e)||this.cookies.push(e),!0}compare(e,t){return e.name===t.name&&e.path===t.path&&e.domain===t.domain&&e.secure===t.secure&&e.httponly===e.httponly}isExpired(e){return e.expires&&e.expires<new Date||!e.value}getPath(e){let t=(e||"/").split("/");return t.pop(),t=t.join("/").trim(),t.charAt(0)!=="/"&&(t="/"+t),t.substr(-1)!=="/"&&(t+="/"),t}};var ZN=JN;const e2="nodemailer",t2="6.9.14",n2="Easy as cake e-mail sending from your Node.js applications",i2="lib/nodemailer.js",r2={test:"node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js","test:coverage":"c8 node --test --test-concurrency=1 test/**/*.test.js test/**/*-test.js",lint:"eslint .",update:"rm -rf node_modules/ package-lock.json && ncu -u && npm install"},s2={type:"git",url:"https://github.com/nodemailer/nodemailer.git"},o2=["Nodemailer"],a2="Andris Reinman",l2="MIT-0",c2={url:"https://github.com/nodemailer/nodemailer/issues"},u2="https://nodemailer.com/",h2={"@aws-sdk/client-ses":"3.600.0",bunyan:"1.8.15",c8:"10.1.2",eslint:"8.57.0","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"9.1.0",libbase64:"1.3.0",libmime:"5.3.5",libqp:"2.1.0","nodemailer-ntlm-auth":"1.0.4",proxy:"1.0.2","proxy-test-server":"1.0.0","smtp-server":"3.13.4"},d2={node:">=6.0.0"},xn={name:e2,version:t2,description:n2,main:i2,scripts:r2,repository:s2,keywords:o2,author:a2,license:l2,bugs:c2,homepage:u2,devDependencies:h2,engines:d2},p2=Y,f2=Y,M_=Y,m2=Y,g2=Y.PassThrough,_I=ZN,v2=xn,y2=Y,_2=5;Gm.exports=function(n,e){return xI(n,e)};Gm.exports.Cookies=_I;function xI(n,e){e=e||{},e.fetchRes=e.fetchRes||new g2,e.cookies=e.cookies||new _I,e.redirects=e.redirects||0,e.maxRedirects=isNaN(e.maxRedirects)?_2:e.maxRedirects,e.cookie&&([].concat(e.cookie||[]).forEach(f=>{e.cookies.set(f,n)}),e.cookie=!1);let t=e.fetchRes,i=M_.parse(n),r=(e.method||"").toString().trim().toUpperCase()||"GET",s=!1,o,a,l=i.protocol==="https:"?f2:p2,u={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+v2.version};if(Object.keys(e.headers||{}).forEach(f=>{u[f.toLowerCase().trim()]=e.headers[f]}),e.userAgent&&(u["user-agent"]=e.userAgent),i.auth&&(u.Authorization="Basic "+Buffer.from(i.auth).toString("base64")),(o=e.cookies.get(n))&&(u.cookie=o),e.body){if(e.contentType!==!1&&(u["Content-Type"]=e.contentType||"application/x-www-form-urlencoded"),typeof e.body.pipe=="function")u["Transfer-Encoding"]="chunked",a=e.body,a.on("error",f=>{s||(s=!0,f.type="FETCH",f.sourceUrl=n,t.emit("error",f))});else{if(e.body instanceof Buffer)a=e.body;else if(typeof e.body=="object")try{a=Buffer.from(Object.keys(e.body).map(f=>{let v=e.body[f].toString().trim();return encodeURIComponent(f)+"="+encodeURIComponent(v)}).join("&"))}catch(f){if(s)return;s=!0,f.type="FETCH",f.sourceUrl=n,t.emit("error",f);return}else a=Buffer.from(e.body.toString().trim());u["Content-Type"]=e.contentType||"application/x-www-form-urlencoded",u["Content-Length"]=a.length}r=(e.method||"").toString().trim().toUpperCase()||"POST"}let h,p={method:r,host:i.hostname,path:i.path,port:i.port?i.port:i.protocol==="https:"?443:80,headers:u,rejectUnauthorized:!1,agent:!1};e.tls&&Object.keys(e.tls).forEach(f=>{p[f]=e.tls[f]}),i.protocol==="https:"&&i.hostname&&i.hostname!==p.host&&!y2.isIP(i.hostname)&&!p.servername&&(p.servername=i.hostname);try{h=l.request(p)}catch(f){return s=!0,setImmediate(()=>{f.type="FETCH",f.sourceUrl=n,t.emit("error",f)}),t}return e.timeout&&h.setTimeout(e.timeout,()=>{if(s)return;s=!0,h.abort();let f=new Error("Request Timeout");f.type="FETCH",f.sourceUrl=n,t.emit("error",f)}),h.on("error",f=>{s||(s=!0,f.type="FETCH",f.sourceUrl=n,t.emit("error",f))}),h.on("response",f=>{let v;if(!s){switch(f.headers["content-encoding"]){case"gzip":case"deflate":v=m2.createUnzip();break}if(f.headers["set-cookie"]&&[].concat(f.headers["set-cookie"]||[]).forEach(I=>{e.cookies.set(I,n)}),[301,302,303,307,308].includes(f.statusCode)&&f.headers.location){if(e.redirects++,e.redirects>e.maxRedirects){s=!0;let I=new Error("Maximum redirect count exceeded");I.type="FETCH",I.sourceUrl=n,t.emit("error",I),h.abort();return}return e.method="GET",e.body=!1,xI(M_.resolve(n,f.headers.location),e)}if(t.statusCode=f.statusCode,t.headers=f.headers,f.statusCode>=300&&!e.allowErrorResponse){s=!0;let I=new Error("Invalid status code "+f.statusCode);I.type="FETCH",I.sourceUrl=n,t.emit("error",I),h.abort();return}f.on("error",I=>{s||(s=!0,I.type="FETCH",I.sourceUrl=n,t.emit("error",I),h.abort())}),v?(f.pipe(v).pipe(t),v.on("error",I=>{s||(s=!0,I.type="FETCH",I.sourceUrl=n,t.emit("error",I),h.abort())})):f.pipe(t)}}),setImmediate(()=>{if(a)try{if(typeof a.pipe=="function")return a.pipe(h);h.write(a)}catch(f){s=!0,f.type="FETCH",f.sourceUrl=n,t.emit("error",f);return}h.end()}),t}var Qu=Gm.exports;(function(n){const e=Y,t=Y,i=Y,r=Qu,s=Y,o=Y,a=Y,l=5*60*1e3;let u;try{u=a.networkInterfaces()}catch{}n.exports.networkInterfaces=u;const h=(T,y)=>{let g=n.exports.networkInterfaces;return g?Object.keys(g).map(k=>g[k]).reduce((k,N)=>k.concat(N),[]).filter(k=>!k.internal||y).filter(k=>k.family==="IPv"+T||k.family===T).length>0:!0},p=(T,y,g,w)=>{if(g=g||{},!h(T,g.allowInternalNetworkInterfaces))return w(null,[]);(s.Resolver?new s.Resolver(g):s)["resolve"+T](y,(M,E)=>{if(M){switch(M.code){case s.NODATA:case s.NOTFOUND:case s.NOTIMP:case s.SERVFAIL:case s.CONNREFUSED:case s.REFUSED:case"EAI_AGAIN":return w(null,[])}return w(M)}return w(null,Array.isArray(E)?E:[].concat(E||[]))})},f=n.exports.dnsCache=new Map,v=(T,y)=>T?Object.assign({servername:T.servername,host:!T.addresses||!T.addresses.length?null:T.addresses.length===1?T.addresses[0]:T.addresses[Math.floor(Math.random()*T.addresses.length)]},y||{}):Object.assign({},y||{});n.exports.resolveHostname=(T,y)=>{if(T=T||{},!T.host&&T.servername&&(T.host=T.servername),!T.host||o.isIP(T.host)){let w={addresses:[T.host],servername:T.servername||!1};return y(null,v(w,{cached:!1}))}let g;if(f.has(T.host)&&(g=f.get(T.host),!g.expires||g.expires>=Date.now()))return y(null,v(g.value,{cached:!0}));p(4,T.host,T,(w,k)=>{if(w)return g?y(null,v(g.value,{cached:!0,error:w})):y(w);if(k&&k.length){let N={addresses:k,servername:T.servername||T.host};return f.set(T.host,{value:N,expires:Date.now()+(T.dnsTtl||l)}),y(null,v(N,{cached:!1}))}p(6,T.host,T,(N,M)=>{if(N)return g?y(null,v(g.value,{cached:!0,error:N})):y(N);if(M&&M.length){let E={addresses:M,servername:T.servername||T.host};return f.set(T.host,{value:E,expires:Date.now()+(T.dnsTtl||l)}),y(null,v(E,{cached:!1}))}try{s.lookup(T.host,{all:!0},(E,x)=>{if(E)return g?y(null,v(g.value,{cached:!0,error:E})):y(E);let S=x?x.filter(P=>h(P.family)).map(P=>P.address).shift():!1;if(x&&x.length&&!S&&console.warn(`Failed to resolve IPv${x[0].family} addresses with current network`),!S&&g)return y(null,v(g.value,{cached:!0}));let A={addresses:S?[S]:[T.host],servername:T.servername||T.host};return f.set(T.host,{value:A,expires:Date.now()+(T.dnsTtl||l)}),y(null,v(A,{cached:!1}))})}catch(E){return g?y(null,v(g.value,{cached:!0,error:E})):y(E)}})})},n.exports.parseConnectionUrl=T=>{T=T||"";let y={};return[e.parse(T,!0)].forEach(g=>{let w;switch(g.protocol){case"smtp:":y.secure=!1;break;case"smtps:":y.secure=!0;break;case"direct:":y.direct=!0;break}!isNaN(g.port)&&Number(g.port)&&(y.port=Number(g.port)),g.hostname&&(y.host=g.hostname),g.auth&&(w=g.auth.split(":"),y.auth||(y.auth={}),y.auth.user=w.shift(),y.auth.pass=w.join(":")),Object.keys(g.query||{}).forEach(k=>{let N=y,M=k,E=g.query[k];switch(isNaN(E)||(E=Number(E)),E){case"true":E=!0;break;case"false":E=!1;break}if(k.indexOf("tls.")===0)M=k.substr(4),y.tls||(y.tls={}),N=y.tls;else if(k.indexOf(".")>=0)return;M in N||(N[M]=E)})}),y},n.exports._logFunc=(T,y,g,w,k,...N)=>{let M={};Object.keys(g||{}).forEach(E=>{E!=="level"&&(M[E]=g[E])}),Object.keys(w||{}).forEach(E=>{E!=="level"&&(M[E]=w[E])}),T[y](M,k,...N)},n.exports.getLogger=(T,y)=>{T=T||{};let g={},w=["trace","debug","info","warn","error","fatal"];if(!T.logger)return w.forEach(N=>{g[N]=()=>!1}),g;let k=T.logger;return T.logger===!0&&(k=b(w)),w.forEach(N=>{g[N]=(M,E,...x)=>{n.exports._logFunc(k,N,y,M,E,...x)}}),g},n.exports.callbackPromise=(T,y)=>function(){let g=Array.from(arguments),w=g.shift();w?y(w):T(...g)},n.exports.parseDataURI=T=>{let y=T,g=y.indexOf(",");if(!g)return T;let w=y.substring(g+1),k=y.substring(5,g),N,M=k.split(";"),E=M.length>1?M[M.length-1]:!1;E&&E.indexOf("=")<0&&(N=E.toLowerCase(),M.pop());let x=M.shift()||"application/octet-stream",S={};for(let A of M){let P=A.indexOf("=");if(P>=0){let R=A.substring(0,P),C=A.substring(P+1);S[R]=C}}switch(N){case"base64":w=Buffer.from(w,"base64");break;case"utf8":w=Buffer.from(w);break;default:try{w=Buffer.from(decodeURIComponent(w))}catch{w=Buffer.from(w)}w=Buffer.from(w)}return{data:w,encoding:N,contentType:x,params:S}},n.exports.resolveContent=(T,y,g)=>{let w;g||(w=new Promise((E,x)=>{g=n.exports.callbackPromise(E,x)}));let k=T&&T[y]&&T[y].content||T[y],N,M=(typeof T[y]=="object"&&T[y].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!k)return g(null,k);if(typeof k=="object"){if(typeof k.pipe=="function")return I(k,(E,x)=>{if(E)return g(E);T[y].content?T[y].content=x:T[y]=x,g(null,x)});if(/^https?:\/\//i.test(k.path||k.href))return N=r(k.path||k.href),I(N,g);if(/^data:/i.test(k.path||k.href)){let E=n.exports.parseDataURI(k.path||k.href);return!E||!E.data?g(null,Buffer.from(0)):g(null,E.data)}else if(k.path)return I(i.createReadStream(k.path),g)}return typeof T[y].content=="string"&&!["utf8","usascii","ascii"].includes(M)&&(k=Buffer.from(T[y].content,M)),setImmediate(()=>g(null,k)),w},n.exports.assign=function(){let T=Array.from(arguments),y=T.shift()||{};return T.forEach(g=>{Object.keys(g||{}).forEach(w=>{["tls","auth"].includes(w)&&g[w]&&typeof g[w]=="object"?(y[w]||(y[w]={}),Object.keys(g[w]).forEach(k=>{y[w][k]=g[w][k]})):y[w]=g[w]})}),y},n.exports.encodeXText=T=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(T))return T;let y=Buffer.from(T),g="";for(let w=0,k=y.length;w<k;w++){let N=y[w];N<33||N>126||N===43||N===61?g+="+"+(N<16?"0":"")+N.toString(16).toUpperCase():g+=String.fromCharCode(N)}return g};function I(T,y){let g=!1,w=[],k=0;T.on("error",N=>{g||(g=!0,y(N))}),T.on("readable",()=>{let N;for(;(N=T.read())!==null;)w.push(N),k+=N.length}),T.on("end",()=>{if(g)return;g=!0;let N;try{N=Buffer.concat(w,k)}catch(M){return y(M)}y(null,N)})}function b(T){let y=0,g=new Map;T.forEach(N=>{N.length>y&&(y=N.length)}),T.forEach(N=>{let M=N.toUpperCase();M.length<y&&(M+=" ".repeat(y-M.length)),g.set(N,M)});let w=(N,M,E,...x)=>{let S="";M&&(M.tnx==="server"?S="S: ":M.tnx==="client"&&(S="C: "),M.sid&&(S="["+M.sid+"] "+S),M.cid&&(S="[#"+M.cid+"] "+S)),E=t.format(E,...x),E.split(/\r?\n/).forEach(A=>{console.log("[%s] %s %s",new Date().toISOString().substr(0,19).replace(/T/," "),g.get(N),S+A)})},k={};return T.forEach(N=>{k[N]=w.bind(null,N)}),k}})(yI);var Dt=yI.exports;const x2=Y,O_="application/octet-stream",w2="bin",L_=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["application/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]),F_=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","application/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);var wI={detectMimeType(n){if(!n)return O_;let e=x2.parse(n),t=(e.ext.substr(1)||e.name||"").split("?").shift().trim().toLowerCase(),i=O_;return F_.has(t)&&(i=F_.get(t)),Array.isArray(i)?i[0]:i},detectExtension(n){if(!n)return w2;let e=(n||"").toLowerCase().trim().split("/"),t=e.shift().trim(),i=e.join("/").trim();if(L_.has(t+"/"+i)){let r=L_.get(t+"/"+i);return Array.isArray(r)?r[0]:r}switch(t){case"text":return"txt";default:return"bin"}}};const ys=2147483647,dn=36,Km=1,ja=26,E2=38,T2=700,EI=72,TI=128,II="-",I2=/^xn--/,S2=/[^\0-\x7F]/,A2=/[\x2E\u3002\uFF0E\uFF61]/g,b2={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},id=dn-Km,pn=Math.floor,rd=String.fromCharCode;function ti(n){throw new RangeError(b2[n])}function C2(n,e){const t=[];let i=n.length;for(;i--;)t[i]=e(n[i]);return t}function SI(n,e){const t=n.split("@");let i="";t.length>1&&(i=t[0]+"@",n=t[1]),n=n.replace(A2,".");const r=n.split("."),s=C2(r,e).join(".");return i+s}function AI(n){const e=[];let t=0;const i=n.length;for(;t<i;){const r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){const s=n.charCodeAt(t++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e}const k2=n=>String.fromCodePoint(...n),P2=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:dn},j_=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},bI=function(n,e,t){let i=0;for(n=t?pn(n/T2):n>>1,n+=pn(n/e);n>id*ja>>1;i+=dn)n=pn(n/id);return pn(i+(id+1)*n/(n+E2))},CI=function(n){const e=[],t=n.length;let i=0,r=TI,s=EI,o=n.lastIndexOf(II);o<0&&(o=0);for(let a=0;a<o;++a)n.charCodeAt(a)>=128&&ti("not-basic"),e.push(n.charCodeAt(a));for(let a=o>0?o+1:0;a<t;){const l=i;for(let h=1,p=dn;;p+=dn){a>=t&&ti("invalid-input");const f=P2(n.charCodeAt(a++));f>=dn&&ti("invalid-input"),f>pn((ys-i)/h)&&ti("overflow"),i+=f*h;const v=p<=s?Km:p>=s+ja?ja:p-s;if(f<v)break;const I=dn-v;h>pn(ys/I)&&ti("overflow"),h*=I}const u=e.length+1;s=bI(i-l,u,l==0),pn(i/u)>ys-r&&ti("overflow"),r+=pn(i/u),i%=u,e.splice(i++,0,r)}return String.fromCodePoint(...e)},kI=function(n){const e=[];n=AI(n);const t=n.length;let i=TI,r=0,s=EI;for(const l of n)l<128&&e.push(rd(l));const o=e.length;let a=o;for(o&&e.push(II);a<t;){let l=ys;for(const h of n)h>=i&&h<l&&(l=h);const u=a+1;l-i>pn((ys-r)/u)&&ti("overflow"),r+=(l-i)*u,i=l;for(const h of n)if(h<i&&++r>ys&&ti("overflow"),h===i){let p=r;for(let f=dn;;f+=dn){const v=f<=s?Km:f>=s+ja?ja:f-s;if(p<v)break;const I=p-v,b=dn-v;e.push(rd(j_(v+I%b,0))),p=pn(I/b)}e.push(rd(j_(p,0))),s=bI(r,u,a===o),r=0,++a}++r,++i}return e.join("")},R2=function(n){return SI(n,function(e){return I2.test(e)?CI(e.slice(4).toLowerCase()):e})},D2=function(n){return SI(n,function(e){return S2.test(e)?"xn--"+kI(e):e})},N2={version:"2.3.1",ucs2:{decode:AI,encode:k2},decode:CI,encode:kI,toASCII:D2,toUnicode:R2};var PI=N2;const V2=Y.Transform;function Lp(n){return typeof n=="string"&&(n=Buffer.from(n,"utf-8")),n.toString("base64")}function Fp(n,e){if(n=(n||"").toString(),e=e||76,n.length<=e)return n;let t=[],i=0,r=e*1024;for(;i<n.length;){let s=n.substr(i,r).replace(new RegExp(".{"+e+"}","g"),`$&\r
`).trim();t.push(s),i+=r}return t.join(`\r
`).trim()}let M2=class extends V2{constructor(e){super(),this.options=e||{},this.options.lineLength!==!1&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this._remainingBytes=!1,this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){if(t!=="buffer"&&(e=Buffer.from(e,t)),!e||!e.length)return setImmediate(i);this.inputBytes+=e.length,this._remainingBytes&&this._remainingBytes.length&&(e=Buffer.concat([this._remainingBytes,e],this._remainingBytes.length+e.length),this._remainingBytes=!1),e.length%3?(this._remainingBytes=e.slice(e.length-e.length%3),e=e.slice(0,e.length-e.length%3)):this._remainingBytes=!1;let r=this._curLine+Lp(e);if(this.options.lineLength){r=Fp(r,this.options.lineLength);let s=r.lastIndexOf(`
`);s<0?(this._curLine=r,r=""):s===r.length-1?this._curLine="":(this._curLine=r.substr(s+1),r=r.substr(0,s+1))}r&&(this.outputBytes+=r.length,this.push(Buffer.from(r,"ascii"))),setImmediate(i)}_flush(e){this._remainingBytes&&this._remainingBytes.length&&(this._curLine+=Lp(this._remainingBytes)),this._curLine&&(this._curLine=Fp(this._curLine,this.options.lineLength),this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii"),this._curLine=""),e()}};var RI={encode:Lp,wrap:Fp,Encoder:M2};const O2=Y.Transform;function jp(n){typeof n=="string"&&(n=Buffer.from(n,"utf-8"));let e=[[9],[10],[13],[32,60],[62,126]],t="",i;for(let r=0,s=n.length;r<s;r++){if(i=n[r],L2(i,e)&&!((i===32||i===9)&&(r===s-1||n[r+1]===10||n[r+1]===13))){t+=String.fromCharCode(i);continue}t+="="+(i<16?"0":"")+i.toString(16).toUpperCase()}return t}function DI(n,e){if(n=(n||"").toString(),e=e||76,n.length<=e)return n;let t=0,i=n.length,r,s,o,a=Math.floor(e/3),l="";for(;t<i;){if(o=n.substr(t,e),r=o.match(/\r\n/)){o=o.substr(0,r.index+r[0].length),l+=o,t+=o.length;continue}if(o.substr(-1)===`
`){l+=o,t+=o.length;continue}else if(r=o.substr(-a).match(/\n.*?$/)){o=o.substr(0,o.length-(r[0].length-1)),l+=o,t+=o.length;continue}else if(o.length>e-a&&(r=o.substr(-a).match(/[ \t.,!?][^ \t.,!?]*$/)))o=o.substr(0,o.length-(r[0].length-1));else if(o.match(/[=][\da-f]{0,2}$/i))for((r=o.match(/[=][\da-f]{0,1}$/i))&&(o=o.substr(0,o.length-r[0].length));o.length>3&&o.length<i-t&&!o.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(r=o.match(/[=][\da-f]{2}$/gi))&&(s=parseInt(r[0].substr(1,2),16),!(s<128||(o=o.substr(0,o.length-3),s>=192))););t+o.length<i&&o.substr(-1)!==`
`?(o.length===e&&o.match(/[=][\da-f]{2}$/i)?o=o.substr(0,o.length-3):o.length===e&&(o=o.substr(0,o.length-1)),t+=o.length,o+=`=\r
`):t+=o.length,l+=o}return l}function L2(n,e){for(let t=e.length-1;t>=0;t--)if(e[t].length&&(e[t].length===1&&n===e[t][0]||e[t].length===2&&n>=e[t][0]&&n<=e[t][1]))return!0;return!1}class F2 extends O2{constructor(e){super(),this.options=e||{},this.options.lineLength!==!1&&(this.options.lineLength=this.options.lineLength||76),this._curLine="",this.inputBytes=0,this.outputBytes=0}_transform(e,t,i){let r;if(t!=="buffer"&&(e=Buffer.from(e,t)),!e||!e.length)return i();this.inputBytes+=e.length,this.options.lineLength?(r=this._curLine+jp(e),r=DI(r,this.options.lineLength),r=r.replace(/(^|\n)([^\n]*)$/,(s,o,a)=>(this._curLine=a,o)),r&&(this.outputBytes+=r.length,this.push(r))):(r=jp(e),this.outputBytes+=r.length,this.push(r,"ascii")),i()}_flush(e){this._curLine&&(this.outputBytes+=this._curLine.length,this.push(this._curLine,"ascii")),e()}}var NI={encode:jp,wrap:DI,Encoder:F2};const Co=RI,j2=NI,B_=wI;var Wu={isPlainText(n,e){return!(typeof n!="string"||(e?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/).test(n))},hasLongerLines(n,e){return n.length>128*1024?!0:new RegExp("^.{"+(e+1)+",}","m").test(n)},encodeWord(n,e,t){e=(e||"Q").toString().toUpperCase().trim().charAt(0),t=t||0;let i,r="UTF-8";if(t&&t>7+r.length&&(t-=7+r.length),e==="Q"?i=j2.encode(n).replace(/[^a-z0-9!*+\-/=]/gi,s=>{let o=s.charCodeAt(0).toString(16).toUpperCase();return s===" "?"_":"="+(o.length===1?"0"+o:o)}):e==="B"&&(i=typeof n=="string"?n:Co.encode(n),t=t?Math.max(3,(t-t%4)/4*3):0),t&&(e!=="B"?i:Co.encode(n)).length>t)if(e==="Q")i=this.splitMimeEncodedString(i,t).join("?= =?"+r+"?"+e+"?");else{let s=[],o="";for(let a=0,l=i.length;a<l;a++){let u=i.charAt(a);/[\ud83c\ud83d\ud83e]/.test(u)&&a<l-1&&(u+=i.charAt(++a)),Buffer.byteLength(o+u)<=t||a===0?o+=u:(s.push(Co.encode(o)),o=u)}o&&s.push(Co.encode(o)),s.length>1?i=s.join("?= =?"+r+"?"+e+"?"):i=s.join("")}else e==="B"&&(i=Co.encode(n));return"=?"+r+"?"+e+"?"+i+(i.substr(-2)==="?="?"":"?=")},encodeWords(n,e,t,i){t=t||0;let r,s=n.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!s)return n;if(i)return this.encodeWord(n,e,t);let o=n.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!o)return n;let a=s.index+(s[0].match(/[^\s]/)||{index:0}).index,l=o.index+(o[1]||"").length;return r=(a?n.substr(0,a):"")+this.encodeWord(n.substring(a,l),e||"Q",t)+(l<n.length?n.substr(l):""),r},buildHeaderValue(n){let e=[];return Object.keys(n.params||{}).forEach(t=>{let i=n.params[t];!this.isPlainText(i,!0)||i.length>=75?this.buildHeaderParam(t,i,50).forEach(r=>{!/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(r.value)||r.key.substr(-1)==="*"?e.push(r.key+"="+r.value):e.push(r.key+"="+JSON.stringify(r.value))}):/[\s'"\\;:/=(),<>@[\]?]|^-/.test(i)?e.push(t+"="+JSON.stringify(i)):e.push(t+"="+i)}),n.value+(e.length?"; "+e.join("; "):"")},buildHeaderParam(n,e,t){let i=[],r=typeof e=="string"?e:(e||"").toString(),s,o,a,l,u=0,h,p;if(t=t||50,this.isPlainText(e,!0)){if(r.length<=t)return[{key:n,value:r}];r=r.replace(new RegExp(".{"+t+"}","g"),f=>(i.push({line:f}),"")),r&&i.push({line:r})}else{if(/[\uD800-\uDBFF]/.test(r)){for(s=[],h=0,p=r.length;h<p;h++)o=r.charAt(h),a=o.charCodeAt(0),a>=55296&&a<=56319&&h<p-1?(o+=r.charAt(h+1),s.push(o),h++):s.push(o);r=s}l="utf-8''";let f=!0;for(u=0,h=0,p=r.length;h<p;h++){if(o=r[h],f)o=this.safeEncodeURIComponent(o);else if(o=o===" "?o:this.safeEncodeURIComponent(o),o!==r[h])if((this.safeEncodeURIComponent(l)+o).length>=t)i.push({line:l,encoded:f}),l="",u=h-1;else{f=!0,h=u,l="";continue}(l+o).length>=t?(i.push({line:l,encoded:f}),l=o=r[h]===" "?" ":this.safeEncodeURIComponent(r[h]),o===r[h]?(f=!1,u=h-1):f=!0):l+=o}l&&i.push({line:l,encoded:f})}return i.map((f,v)=>({key:n+"*"+v+(f.encoded?"*":""),value:f.line}))},parseHeaderValue(n){let e={value:!1,params:{}},t=!1,i="",r="value",s=!1,o=!1,a;for(let l=0,u=n.length;l<u;l++)if(a=n.charAt(l),r==="key"){if(a==="="){t=i.trim().toLowerCase(),r="value",i="";continue}i+=a}else{if(o)i+=a;else if(a==="\\"){o=!0;continue}else s&&a===s?s=!1:!s&&a==='"'?s=a:!s&&a===";"?(t===!1?e.value=i.trim():e.params[t]=i.trim(),r="key",i=""):i+=a;o=!1}return r==="value"?t===!1?e.value=i.trim():e.params[t]=i.trim():i.trim()&&(e.params[i.trim().toLowerCase()]=""),Object.keys(e.params).forEach(l=>{let u,h,p,f;(p=l.match(/(\*(\d+)|\*(\d+)\*|\*)$/))&&(u=l.substr(0,p.index),h=Number(p[2]||p[3])||0,(!e.params[u]||typeof e.params[u]!="object")&&(e.params[u]={charset:!1,values:[]}),f=e.params[l],h===0&&p[0].substr(-1)==="*"&&(p=f.match(/^([^']*)'[^']*'(.*)$/))&&(e.params[u].charset=p[1]||"iso-8859-1",f=p[2]),e.params[u].values[h]=f,delete e.params[l])}),Object.keys(e.params).forEach(l=>{let u;e.params[l]&&Array.isArray(e.params[l].values)&&(u=e.params[l].values.map(h=>h||"").join(""),e.params[l].charset?e.params[l]="=?"+e.params[l].charset+"?Q?"+u.replace(/[=?_\s]/g,h=>{let p=h.charCodeAt(0).toString(16);return h===" "?"_":"%"+(p.length<2?"0":"")+p}).replace(/%/g,"=")+"?=":e.params[l]=u)}),e},detectExtension:n=>B_.detectExtension(n),detectMimeType:n=>B_.detectMimeType(n),foldLines(n,e,t){n=(n||"").toString(),e=e||76;let i=0,r=n.length,s="",o,a;for(;i<r;){if(o=n.substr(i,e),o.length<e){s+=o;break}if(a=o.match(/^[^\n\r]*(\r?\n|\r)/)){o=a[0],s+=o,i+=o.length;continue}else(a=o.match(/(\s+)[^\s]*$/))&&a[0].length-(t?(a[1]||"").length:0)<o.length?o=o.substr(0,o.length-(a[0].length-(t?(a[1]||"").length:0))):(a=n.substr(i+o.length).match(/^[^\s]+(\s*)/))&&(o=o+a[0].substr(0,a[0].length-(t?0:(a[1]||"").length)));s+=o,i+=o.length,i<r&&(s+=`\r
`)}return s},splitMimeEncodedString:(n,e)=>{let t,i,r,s,o=[];for(e=Math.max(e||0,12);n.length;){for(t=n.substr(0,e),(i=t.match(/[=][0-9A-F]?$/i))&&(t=t.substr(0,i.index)),s=!1;!s;)s=!0,(i=n.substr(t.length).match(/^[=]([0-9A-F]{2})/i))&&(r=parseInt(i[1],16),r<194&&r>127&&(t=t.substr(0,t.length-3),s=!1));t.length&&o.push(t),n=n.substr(t.length)}return o},encodeURICharComponent:n=>{let e="",t=n.charCodeAt(0).toString(16).toUpperCase();if(t.length%2&&(t="0"+t),t.length>2)for(let i=0,r=t.length/2;i<r;i++)e+="%"+t.substr(i,2);else e+="%"+t;return e},safeEncodeURIComponent(n){n=(n||"").toString();try{n=encodeURIComponent(n)}catch{return n.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return n.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,e=>this.encodeURICharComponent(e))}};function B2(n){let e,t=!1,i="text",r,s=[],o={address:[],comment:[],group:[],text:[]},a,l;for(a=0,l=n.length;a<l;a++)if(e=n[a],e.type==="operator")switch(e.value){case"<":i="address";break;case"(":i="comment";break;case":":i="group",t=!0;break;default:i="text"}else e.value&&(i==="address"&&(e.value=e.value.replace(/^[^<]*<\s*/,"")),o[i].push(e.value));if(!o.text.length&&o.comment.length&&(o.text=o.comment,o.comment=[]),t)o.text=o.text.join(" "),s.push({name:o.text||r&&r.name,group:o.group.length?VI(o.group.join(",")):[]});else{if(!o.address.length&&o.text.length){for(a=o.text.length-1;a>=0;a--)if(o.text[a].match(/^[^@\s]+@[^@\s]+$/)){o.address=o.text.splice(a,1);break}let u=function(h){return o.address.length?h:(o.address=[h.trim()]," ")};if(!o.address.length)for(a=o.text.length-1;a>=0&&(o.text[a]=o.text[a].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,u).trim(),!o.address.length);a--);}if(!o.text.length&&o.comment.length&&(o.text=o.comment,o.comment=[]),o.address.length>1&&(o.text=o.text.concat(o.address.splice(1))),o.text=o.text.join(" "),o.address=o.address.join(" "),!o.address&&t)return[];r={address:o.address||o.text||"",name:o.text||o.address||""},r.address===r.name&&((r.address||"").match(/@/)?r.name="":r.address=""),s.push(r)}return s}class U2{constructor(e){this.str=(e||"").toString(),this.operatorCurrent="",this.operatorExpecting="",this.node=null,this.escaped=!1,this.list=[],this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let e,t=[];for(let i=0,r=this.str.length;i<r;i++)e=this.str.charAt(i),this.checkChar(e);return this.list.forEach(i=>{i.value=(i.value||"").toString().trim(),i.value&&t.push(i)}),t}checkChar(e){if(!this.escaped){if(e===this.operatorExpecting){this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting="",this.escaped=!1;return}else if(!this.operatorExpecting&&e in this.operators){this.node={type:"operator",value:e},this.list.push(this.node),this.node=null,this.operatorExpecting=this.operators[e],this.escaped=!1;return}else if(['"',"'"].includes(this.operatorExpecting)&&e==="\\"){this.escaped=!0;return}}this.node||(this.node={type:"text",value:""},this.list.push(this.node)),e===`
`&&(e=" "),(e.charCodeAt(0)>=33||[" ","	"].includes(e))&&(this.node.value+=e),this.escaped=!1}}function VI(n,e){e=e||{};let i=new U2(n).tokenize(),r=[],s=[],o=[];if(i.forEach(a=>{a.type==="operator"&&(a.value===","||a.value===";")?(s.length&&r.push(s),s=[]):s.push(a)}),s.length&&r.push(s),r.forEach(a=>{a=B2(a),a.length&&(o=o.concat(a))}),e.flatten){let a=[],l=u=>{u.forEach(h=>{if(h.group)return l(h.group);a.push(h)})};return l(o),a}return o}var z2=VI;const $2=Y.Transform;let q2=class extends $2{constructor(){super(),this.lastByte=!1}_transform(e,t,i){e.length&&(this.lastByte=e[e.length-1]),this.push(e),i()}_flush(e){return this.lastByte===10?e():this.lastByte===13?(this.push(Buffer.from(`
`)),e()):(this.push(Buffer.from(`\r
`)),e())}};var H2=q2;const G2=Y,K2=G2.Transform;let Q2=class extends K2{constructor(e){super(e),this.options=e||{},this.lastByte=!1}_transform(e,t,i){let r,s=0;for(let o=0,a=e.length;o<a;o++)e[o]===10&&(o&&e[o-1]!==13||!o&&this.lastByte!==13)&&(o>s&&(r=e.slice(s,o),this.push(r)),this.push(Buffer.from(`\r
`)),s=o+1);s&&s<e.length?(r=e.slice(s),this.push(r)):s||this.push(e),this.lastByte=e[e.length-1],i()}};var MI=Q2;const W2=Y,X2=W2.Transform;let Y2=class extends X2{constructor(e){super(e),this.options=e||{}}_transform(e,t,i){let r,s=0;for(let o=0,a=e.length;o<a;o++)e[o]===13&&(r=e.slice(s,o),s=o+1,this.push(r));s&&s<e.length?(r=e.slice(s),this.push(r)):s||this.push(e),i()}};var J2=Y2;const sd=Y,Z2=Y,eV=PI,ko=Y.PassThrough,tV=Dt,Jt=Wu,nV=NI,iV=RI,rV=z2,sV=Qu,oV=H2,aV=MI,lV=J2;let cV=class OI{constructor(e,t){this.nodeCounter=0,t=t||{},this.baseBoundary=t.baseBoundary||sd.randomBytes(8).toString("hex"),this.boundaryPrefix=t.boundaryPrefix||"--_NmP",this.disableFileAccess=!!t.disableFileAccess,this.disableUrlAccess=!!t.disableUrlAccess,this.normalizeHeaderKey=t.normalizeHeaderKey,this.date=new Date,this.rootNode=t.rootNode||this,this.keepBcc=!!t.keepBcc,t.filename&&(this.filename=t.filename,e||(e=Jt.detectMimeType(this.filename.split(".").pop()))),this.textEncoding=(t.textEncoding||"").toString().trim().charAt(0).toUpperCase(),this.parentNode=t.parentNode,this.hostname=t.hostname,this.newline=t.newline,this.childNodes=[],this._nodeId=++this.rootNode.nodeCounter,this._headers=[],this._isPlainText=!1,this._hasLongLines=!1,this._envelope=!1,this._raw=!1,this._transforms=[],this._processFuncs=[],e&&this.setHeader("Content-Type",e)}createChild(e,t){!t&&typeof e=="object"&&(t=e,e=void 0);let i=new OI(e,t);return this.appendChild(i),i}appendChild(e){return e.rootNode!==this.rootNode&&(e.rootNode=this.rootNode,e._nodeId=++this.rootNode.nodeCounter),e.parentNode=this,this.childNodes.push(e),e}replace(e){return e===this?this:(this.parentNode.childNodes.forEach((t,i)=>{t===this&&(e.rootNode=this.rootNode,e.parentNode=this.parentNode,e._nodeId=this._nodeId,this.rootNode=this,this.parentNode=void 0,e.parentNode.childNodes[i]=e)}),e)}remove(){if(!this.parentNode)return this;for(let e=this.parentNode.childNodes.length-1;e>=0;e--)if(this.parentNode.childNodes[e]===this)return this.parentNode.childNodes.splice(e,1),this.parentNode=void 0,this.rootNode=this,this}setHeader(e,t){let i=!1,r;if(!t&&e&&typeof e=="object")return e.key&&"value"in e?this.setHeader(e.key,e.value):Array.isArray(e)?e.forEach(s=>{this.setHeader(s.key,s.value)}):Object.keys(e).forEach(s=>{this.setHeader(s,e[s])}),this;e=this._normalizeHeaderKey(e),r={key:e,value:t};for(let s=0,o=this._headers.length;s<o;s++)this._headers[s].key===e&&(i?(this._headers.splice(s,1),s--,o--):(this._headers[s]=r,i=!0));return i||this._headers.push(r),this}addHeader(e,t){return!t&&e&&typeof e=="object"?(e.key&&e.value?this.addHeader(e.key,e.value):Array.isArray(e)?e.forEach(i=>{this.addHeader(i.key,i.value)}):Object.keys(e).forEach(i=>{this.addHeader(i,e[i])}),this):Array.isArray(t)?(t.forEach(i=>{this.addHeader(e,i)}),this):(this._headers.push({key:this._normalizeHeaderKey(e),value:t}),this)}getHeader(e){e=this._normalizeHeaderKey(e);for(let t=0,i=this._headers.length;t<i;t++)if(this._headers[t].key===e)return this._headers[t].value}setContent(e){return this.content=e,typeof this.content.pipe=="function"?(this._contentErrorHandler=t=>{this.content.removeListener("error",this._contentErrorHandler),this.content=t},this.content.once("error",this._contentErrorHandler)):typeof this.content=="string"&&(this._isPlainText=Jt.isPlainText(this.content),this._isPlainText&&Jt.hasLongerLines(this.content,76)&&(this._hasLongLines=!0)),this}build(e){let t;e||(t=new Promise((a,l)=>{e=tV.callbackPromise(a,l)}));let i=this.createReadStream(),r=[],s=0,o=!1;return i.on("readable",()=>{let a;for(;(a=i.read())!==null;)r.push(a),s+=a.length}),i.once("error",a=>{if(!o)return o=!0,e(a)}),i.once("end",a=>{if(!o)return o=!0,a&&a.length&&(r.push(a),s+=a.length),e(null,Buffer.concat(r,s))}),t}getTransferEncoding(){let e=!1,t=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();return this.content&&(e=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim(),(!e||!["base64","quoted-printable"].includes(e))&&(/^text\//i.test(t)?this._isPlainText&&!this._hasLongLines?e="7bit":typeof this.content=="string"||this.content instanceof Buffer?e=this._getTextEncoding(this.content)==="Q"?"quoted-printable":"base64":e=this.textEncoding==="B"?"base64":"quoted-printable":/^(multipart|message)\//i.test(t)||(e=e||"base64"))),e}buildHeaders(){let e=this.getTransferEncoding(),t=[];if(e&&this.setHeader("Content-Transfer-Encoding",e),this.filename&&!this.getHeader("Content-Disposition")&&this.setHeader("Content-Disposition","attachment"),this.rootNode===this){this.getHeader("Date")||this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000")),this.messageId(),this.getHeader("MIME-Version")||this.setHeader("MIME-Version","1.0");for(let i=this._headers.length-2;i>=0;i--){let r=this._headers[i];r.key==="Content-Type"&&(this._headers.splice(i,1),this._headers.push(r))}}return this._headers.forEach(i=>{let r=i.key,s=i.value,o,a,l={};if(!(s&&typeof s=="object"&&!["From","Sender","To","Cc","Bcc","Reply-To","Date","References"].includes(r)&&(Object.keys(s).forEach(h=>{h!=="value"&&(l[h]=s[h])}),s=(s.value||"").toString(),!s.trim()))){if(l.prepared){l.foldLines?t.push(Jt.foldLines(r+": "+s)):t.push(r+": "+s);return}switch(i.key){case"Content-Disposition":o=Jt.parseHeaderValue(s),this.filename&&(o.params.filename=this.filename),s=Jt.buildHeaderValue(o);break;case"Content-Type":o=Jt.parseHeaderValue(s),this._handleContentType(o),o.value.match(/^text\/plain\b/)&&typeof this.content=="string"&&/[\u0080-\uFFFF]/.test(this.content)&&(o.params.charset="utf-8"),s=Jt.buildHeaderValue(o),this.filename&&(a=this._encodeWords(this.filename),(a!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(a))&&(a='"'+a+'"'),s+="; name="+a);break;case"Bcc":if(!this.keepBcc)return;break}if(s=this._encodeHeaderValue(r,s),!!(s||"").toString().trim()){if(typeof this.normalizeHeaderKey=="function"){let h=this.normalizeHeaderKey(r,s);h&&typeof h=="string"&&h.length&&(r=h)}t.push(Jt.foldLines(r+": "+s,76))}}}),t.join(`\r
`)}createReadStream(e){e=e||{};let t=new ko(e),i=t,r;this.stream(t,e,s=>{if(s){i.emit("error",s);return}t.end()});for(let s=0,o=this._transforms.length;s<o;s++)r=typeof this._transforms[s]=="function"?this._transforms[s]():this._transforms[s],i.once("error",a=>{r.emit("error",a)}),i=i.pipe(r);r=new oV,i.once("error",s=>{r.emit("error",s)}),i=i.pipe(r);for(let s=0,o=this._processFuncs.length;s<o;s++)r=this._processFuncs[s],i=r(i);if(this.newline){const o=["win","windows","dos",`\r
`].includes(this.newline.toString().toLowerCase())?new aV:new lV,a=i.pipe(o);return i.on("error",l=>a.emit("error",l)),a}return i}transform(e){this._transforms.push(e)}processFunc(e){this._processFuncs.push(e)}stream(e,t,i){let r=this.getTransferEncoding(),s,o,a=!1,l=p=>{a||(a=!0,i(p))},u=()=>{let p=0,f=()=>{if(p>=this.childNodes.length)return e.write(`\r
--`+this.boundary+`--\r
`),l();let v=this.childNodes[p++];e.write((p>1?`\r
`:"")+"--"+this.boundary+`\r
`),v.stream(e,t,I=>{if(I)return l(I);setImmediate(f)})};if(this.multipart)setImmediate(f);else return l()},h=()=>{if(this.content){if(Object.prototype.toString.call(this.content)==="[object Error]")return l(this.content);typeof this.content.pipe=="function"&&(this.content.removeListener("error",this._contentErrorHandler),this._contentErrorHandler=f=>l(f),this.content.once("error",this._contentErrorHandler));let p=()=>{["quoted-printable","base64"].includes(r)?(s=new(r==="base64"?iV:nV).Encoder(t),s.pipe(e,{end:!1}),s.once("end",u),s.once("error",f=>l(f)),o=this._getStream(this.content),o.pipe(s)):(o=this._getStream(this.content),o.pipe(e,{end:!1}),o.once("end",u)),o.once("error",f=>l(f))};if(this.content._resolve){let f=[],v=0,I=!1,b=this._getStream(this.content);b.on("error",T=>{I||(I=!0,l(T))}),b.on("readable",()=>{let T;for(;(T=b.read())!==null;)f.push(T),v+=T.length}),b.on("end",()=>{I||(I=!0,this.content._resolve=!1,this.content._resolvedValue=Buffer.concat(f,v),setImmediate(p))})}else setImmediate(p);return}else return setImmediate(u)};this._raw?setImmediate(()=>{if(Object.prototype.toString.call(this._raw)==="[object Error]")return l(this._raw);typeof this._raw.pipe=="function"&&this._raw.removeListener("error",this._contentErrorHandler);let p=this._getStream(this._raw);p.pipe(e,{end:!1}),p.on("error",f=>e.emit("error",f)),p.on("end",u)}):(e.write(this.buildHeaders()+`\r
\r
`),setImmediate(h))}setEnvelope(e){let t;this._envelope={from:!1,to:[]},e.from&&(t=[],this._convertAddresses(this._parseAddresses(e.from),t),t=t.filter(r=>r&&r.address),t.length&&t[0]&&(this._envelope.from=t[0].address)),["to","cc","bcc"].forEach(r=>{e[r]&&this._convertAddresses(this._parseAddresses(e[r]),this._envelope.to)}),this._envelope.to=this._envelope.to.map(r=>r.address).filter(r=>r);let i=["to","cc","bcc","from"];return Object.keys(e).forEach(r=>{i.includes(r)||(this._envelope[r]=e[r])}),this}getAddresses(){let e={};return this._headers.forEach(t=>{let i=t.key.toLowerCase();["from","sender","reply-to","to","cc","bcc"].includes(i)&&(Array.isArray(e[i])||(e[i]=[]),this._convertAddresses(this._parseAddresses(t.value),e[i]))}),e}getEnvelope(){if(this._envelope)return this._envelope;let e={from:!1,to:[]};return this._headers.forEach(t=>{let i=[];t.key==="From"||!e.from&&["Reply-To","Sender"].includes(t.key)?(this._convertAddresses(this._parseAddresses(t.value),i),i.length&&i[0]&&(e.from=i[0].address)):["To","Cc","Bcc"].includes(t.key)&&this._convertAddresses(this._parseAddresses(t.value),e.to)}),e.to=e.to.map(t=>t.address),e}messageId(){let e=this.getHeader("Message-ID");return e||(e=this._generateMessageId(),this.setHeader("Message-ID",e)),e}setRaw(e){return this._raw=e,this._raw&&typeof this._raw.pipe=="function"&&(this._contentErrorHandler=t=>{this._raw.removeListener("error",this._contentErrorHandler),this._raw=t},this._raw.once("error",this._contentErrorHandler)),this}_getStream(e){let t;return e._resolvedValue?(t=new ko,setImmediate(()=>{try{t.end(e._resolvedValue)}catch(i){t.emit("error",i)}}),t):typeof e.pipe=="function"?e:e&&typeof e.path=="string"&&!e.href?this.disableFileAccess?(t=new ko,setImmediate(()=>t.emit("error",new Error("File access rejected for "+e.path))),t):Z2.createReadStream(e.path):e&&typeof e.href=="string"?this.disableUrlAccess?(t=new ko,setImmediate(()=>t.emit("error",new Error("Url access rejected for "+e.href))),t):sV(e.href,{headers:e.httpHeaders}):(t=new ko,setImmediate(()=>{try{t.end(e||"")}catch(i){t.emit("error",i)}}),t)}_parseAddresses(e){return[].concat.apply([],[].concat(e).map(t=>t&&t.address?(t.address=this._normalizeAddress(t.address),t.name=t.name||"",[t]):rV(t)))}_normalizeHeaderKey(e){return e=(e||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,t=>t.toUpperCase()).replace(/^Content-Features$/i,"Content-features"),e}_handleContentType(e){this.contentType=e.value.trim().toLowerCase(),this.multipart=/^multipart\//i.test(this.contentType)?this.contentType.substr(this.contentType.indexOf("/")+1):!1,this.multipart?this.boundary=e.params.boundary=e.params.boundary||this.boundary||this._generateBoundary():this.boundary=!1}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(e,t){switch(e=this._normalizeHeaderKey(e),e){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(t));case"Message-ID":case"In-Reply-To":case"Content-Id":return t=(t||"").toString().replace(/\r?\n|\r/g," "),t.charAt(0)!=="<"&&(t="<"+t),t.charAt(t.length-1)!==">"&&(t=t+">"),t;case"References":return t=[].concat.apply([],[].concat(t||"").map(i=>(i=(i||"").toString().replace(/\r?\n|\r/g," ").trim(),i.replace(/<[^>]*>/g,r=>r.replace(/\s/g,"")).split(/\s+/)))).map(i=>(i.charAt(0)!=="<"&&(i="<"+i),i.charAt(i.length-1)!==">"&&(i=i+">"),i)),t.join(" ").trim();case"Date":return Object.prototype.toString.call(t)==="[object Date]"?t.toUTCString().replace(/GMT/,"+0000"):(t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t));case"Content-Type":case"Content-Disposition":return(t||"").toString().replace(/\r?\n|\r/g," ");default:return t=(t||"").toString().replace(/\r?\n|\r/g," "),this._encodeWords(t)}}_convertAddresses(e,t){let i=[];return t=t||[],[].concat(e||[]).forEach(r=>{if(r.address)r.address=this._normalizeAddress(r.address),r.name?r.name&&i.push(`${this._encodeAddressName(r.name)} <${r.address}>`):i.push(r.address.indexOf(" ")>=0?`<${r.address}>`:`${r.address}`),r.address&&(t.filter(s=>s.address===r.address).length||t.push(r));else if(r.group){let s=(r.group.length?this._convertAddresses(r.group,t):"").trim();i.push(`${this._encodeAddressName(r.name)}:${s};`)}}),i.join(", ")}_normalizeAddress(e){e=(e||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim();let t=e.lastIndexOf("@");if(t<0)return e;let i=e.substr(0,t),r=e.substr(t+1),s;try{s=eV.toASCII(r.toLowerCase())}catch{}return i.indexOf(" ")>=0&&(i.charAt(0)!=='"'&&(i='"'+i),i.substr(-1)!=='"'&&(i=i+'"')),`${i}@${s}`}_encodeAddressName(e){return/^[\w ]*$/.test(e)?e:/^[\x20-\x7e]*$/.test(e)?'"'+e.replace(/([\\"])/g,"\\$1")+'"':Jt.encodeWord(e,this._getTextEncoding(e),52)}_encodeWords(e){return Jt.encodeWords(e,this._getTextEncoding(e),52,!0)}_getTextEncoding(e){e=(e||"").toString();let t=this.textEncoding,i,r;return t||(r=(e.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length,i=(e.match(/[a-z]/gi)||[]).length,t=r<i?"Q":"B"),t}_generateMessageId(){return"<"+[2,2,2,6].reduce((e,t)=>e+"-"+sd.randomBytes(t).toString("hex"),sd.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||"localhost").split("@").pop()+">"}};var LI=cV;const Po=LI,od=Wu,uV=Dt.parseDataURI;let hV=class{constructor(e){this.mail=e||{},this.message=!1}compile(){return this._alternatives=this.getAlternatives(),this._htmlNode=this._alternatives.filter(e=>/^text\/html\b/i.test(e.contentType)).pop(),this._attachments=this.getAttachments(!!this._htmlNode),this._useRelated=!!(this._htmlNode&&this._attachments.related.length),this._useAlternative=this._alternatives.length>1,this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&this._attachments.attached.length===1,this.mail.raw?this.message=new Po("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw):this._useMixed?this.message=this._createMixed():this._useAlternative?this.message=this._createAlternative():this._useRelated?this.message=this._createRelated():this.message=this._createContentNode(!1,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""}),this.mail.headers&&this.message.addHeader(this.mail.headers),["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach(e=>{let t=e.replace(/-(\w)/g,(i,r)=>r.toUpperCase());this.mail[t]&&this.message.setHeader(e,this.mail[t])}),this.mail.envelope&&this.message.setEnvelope(this.mail.envelope),this.message.messageId(),this.message}getAttachments(e){let t,i,r=[].concat(this.mail.attachments||[]).map((s,o)=>{let a,l=/^message\//i.test(s.contentType);/^data:/i.test(s.path||s.href)&&(s=this._processDataUrl(s));let u=s.contentType||od.detectMimeType(s.filename||s.path||s.href||"bin"),h=/^image\//i.test(u),p=s.contentDisposition||(l||h&&s.cid?"inline":"attachment");return a={contentType:u,contentDisposition:p,contentTransferEncoding:"contentTransferEncoding"in s?s.contentTransferEncoding:"base64"},s.filename?a.filename=s.filename:!l&&s.filename!==!1&&(a.filename=(s.path||s.href||"").split("/").pop().split("?").shift()||"attachment-"+(o+1),a.filename.indexOf(".")<0&&(a.filename+="."+od.detectExtension(a.contentType))),/^https?:\/\//i.test(s.path)&&(s.href=s.path,s.path=void 0),s.cid&&(a.cid=s.cid),s.raw?a.raw=s.raw:s.path?a.content={path:s.path}:s.href?a.content={href:s.href,httpHeaders:s.httpHeaders}:a.content=s.content||"",s.encoding&&(a.encoding=s.encoding),s.headers&&(a.headers=s.headers),a});return this.mail.icalEvent&&(typeof this.mail.icalEvent=="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?t=this.mail.icalEvent:t={content:this.mail.icalEvent},i={},Object.keys(t).forEach(s=>{i[s]=t[s]}),i.contentType="application/ics",i.headers||(i.headers={}),i.filename=i.filename||"invite.ics",i.headers["Content-Disposition"]="attachment",i.headers["Content-Transfer-Encoding"]="base64"),e?{attached:r.filter(s=>!s.cid).concat(i||[]),related:r.filter(s=>!!s.cid)}:{attached:r.concat(i||[]),related:[]}}getAlternatives(){let e=[],t,i,r,s,o,a;return this.mail.text&&(typeof this.mail.text=="object"&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)?t=this.mail.text:t={content:this.mail.text},t.contentType="text/plain; charset=utf-8"),this.mail.watchHtml&&(typeof this.mail.watchHtml=="object"&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)?r=this.mail.watchHtml:r={content:this.mail.watchHtml},r.contentType="text/watch-html; charset=utf-8"),this.mail.amp&&(typeof this.mail.amp=="object"&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)?s=this.mail.amp:s={content:this.mail.amp},s.contentType="text/x-amp-html; charset=utf-8"),this.mail.icalEvent&&(typeof this.mail.icalEvent=="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)?o=this.mail.icalEvent:o={content:this.mail.icalEvent},a={},Object.keys(o).forEach(l=>{a[l]=o[l]}),a.content&&typeof a.content=="object"&&(a.content._resolve=!0),a.filename=!1,a.contentType="text/calendar; charset=utf-8; method="+(a.method||"PUBLISH").toString().trim().toUpperCase(),a.headers||(a.headers={})),this.mail.html&&(typeof this.mail.html=="object"&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)?i=this.mail.html:i={content:this.mail.html},i.contentType="text/html; charset=utf-8"),[].concat(t||[]).concat(r||[]).concat(s||[]).concat(i||[]).concat(a||[]).concat(this.mail.alternatives||[]).forEach(l=>{let u;/^data:/i.test(l.path||l.href)&&(l=this._processDataUrl(l)),u={contentType:l.contentType||od.detectMimeType(l.filename||l.path||l.href||"txt"),contentTransferEncoding:l.contentTransferEncoding},l.filename&&(u.filename=l.filename),/^https?:\/\//i.test(l.path)&&(l.href=l.path,l.path=void 0),l.raw?u.raw=l.raw:l.path?u.content={path:l.path}:l.href?u.content={href:l.href}:u.content=l.content||"",l.encoding&&(u.encoding=l.encoding),l.headers&&(u.headers=l.headers),e.push(u)}),e}_createMixed(e){let t;return e?t=e.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):t=new Po("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._useAlternative?this._createAlternative(t):this._useRelated&&this._createRelated(t),[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach(i=>{(!this._useRelated||i!==this._htmlNode)&&this._createContentNode(t,i)}),t}_createAlternative(e){let t;return e?t=e.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):t=new Po("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._alternatives.forEach(i=>{this._useRelated&&this._htmlNode===i?this._createRelated(t):this._createContentNode(t,i)}),t}_createRelated(e){let t;return e?t=e.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):t=new Po('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),this._createContentNode(t,this._htmlNode),this._attachments.related.forEach(i=>this._createContentNode(t,i)),t}_createContentNode(e,t){t=t||{},t.content=t.content||"";let i,r=(t.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");return e?i=e.createChild(t.contentType,{filename:t.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}):i=new Po(t.contentType,{filename:t.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline}),t.headers&&i.addHeader(t.headers),t.cid&&i.setHeader("Content-Id","<"+t.cid.replace(/[<>]/g,"")+">"),t.contentTransferEncoding?i.setHeader("Content-Transfer-Encoding",t.contentTransferEncoding):this.mail.encoding&&/^text\//i.test(t.contentType)&&i.setHeader("Content-Transfer-Encoding",this.mail.encoding),(!/^text\//i.test(t.contentType)||t.contentDisposition)&&i.setHeader("Content-Disposition",t.contentDisposition||(t.cid&&/^image\//i.test(t.contentType)?"inline":"attachment")),typeof t.content=="string"&&!["utf8","usascii","ascii"].includes(r)&&(t.content=Buffer.from(t.content,r)),t.raw?i.setRaw(t.raw):i.setContent(t.content),i}_processDataUrl(e){let t;return(e.path||e.href).match(/^data:/)&&(t=uV(e.path||e.href)),t&&(e.content=t.data,e.contentType=e.contentType||t.contentType,"path"in e&&(e.path=!1),"href"in e&&(e.href=!1)),e}};var dV=hV;const pV=Y.Transform;let fV=class extends pV{constructor(e){super(e),this.lastBytes=Buffer.alloc(4),this.headersParsed=!1,this.headerBytes=0,this.headerChunks=[],this.rawHeaders=!1,this.bodySize=0}updateLastBytes(e){let t=this.lastBytes.length,i=Math.min(e.length,t);for(let r=0,s=t-i;r<s;r++)this.lastBytes[r]=this.lastBytes[r+i];for(let r=1;r<=i;r++)this.lastBytes[t-r]=e[e.length-r]}checkHeaders(e){if(this.headersParsed)return!0;let t=this.lastBytes.length,i=0;this.curLinePos=0;for(let r=0,s=this.lastBytes.length+e.length;r<s;r++){let o;if(r<t?o=this.lastBytes[r]:o=e[r-t],o===10&&r){let a=r-1<t?this.lastBytes[r-1]:e[r-1-t],l=r>1?r-2<t?this.lastBytes[r-2]:e[r-2-t]:!1;if(a===10){this.headersParsed=!0,i=r-t+1,this.headerBytes+=i;break}else if(a===13&&l===10){this.headersParsed=!0,i=r-t+1,this.headerBytes+=i;break}}}if(this.headersParsed){if(this.headerChunks.push(e.slice(0,i)),this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes),this.headerChunks=null,this.emit("headers",this.parseHeaders()),e.length-1>i){let r=e.slice(i);this.bodySize+=r.length,setImmediate(()=>this.push(r))}return!1}else this.headerBytes+=e.length,this.headerChunks.push(e);return this.updateLastBytes(e),!1}_transform(e,t,i){if(!e||!e.length)return i();typeof e=="string"&&(e=Buffer.from(e,t));let r;try{r=this.checkHeaders(e)}catch(s){return i(s)}r&&(this.bodySize+=e.length,this.push(e)),setImmediate(i)}_flush(e){if(this.headerChunks){let t=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=t.length,this.push(t),this.headerChunks=null}e()}parseHeaders(){let e=(this.rawHeaders||"").toString().split(/\r?\n/);for(let t=e.length-1;t>0;t--)/^\s/.test(e[t])&&(e[t-1]+=`
`+e[t],e.splice(t,1));return e.filter(t=>t.trim()).map(t=>({key:t.substr(0,t.indexOf(":")).trim().toLowerCase(),line:t}))}};var mV=fV;const gV=Y.Transform,vV=Y;let yV=class extends gV{constructor(e){super(),e=e||{},this.chunkBuffer=[],this.chunkBufferLen=0,this.bodyHash=vV.createHash(e.hashAlgo||"sha1"),this.remainder="",this.byteLength=0,this.debug=e.debug,this._debugBody=e.debug?[]:!1}updateHash(e){let t,i="",r="file";for(let o=e.length-1;o>=0;o--){let a=e[o];if(!(r==="file"&&(a===10||a===13))){if(r==="file"&&(a===9||a===32))r="line";else if(!(r==="line"&&(a===9||a===32))){if((r==="file"||r==="line")&&(r="body",o===e.length-1))break}}if(o===0){if(r==="file"&&(!this.remainder||/[\r\n]$/.test(this.remainder))||r==="line"&&(!this.remainder||/[ \t]$/.test(this.remainder))){this.remainder+=e.toString("binary");return}else if(r==="line"||r==="file"){i=e.toString("binary"),e=!1;break}}if(r==="body"){i=e.slice(o+1).toString("binary"),e=e.slice(0,o+1);break}}let s=!!this.remainder;if(e&&!s){for(let o=0,a=e.length;o<a;o++)if(o&&e[o]===10&&e[o-1]!==13){s=!0;break}else if(o&&e[o]===13&&e[o-1]===32){s=!0;break}else if(o&&e[o]===32&&e[o-1]===32){s=!0;break}else if(e[o]===9){s=!0;break}}s?(t=this.remainder+(e?e.toString("binary"):""),this.remainder=i,t=t.replace(/\r?\n/g,`
`).replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,`\r
`),e=Buffer.from(t,"binary")):i&&(this.remainder=i),this.debug&&this._debugBody.push(e),this.bodyHash.update(e)}_transform(e,t,i){if(!e||!e.length)return i();typeof e=="string"&&(e=Buffer.from(e,t)),this.updateHash(e),this.byteLength+=e.length,this.push(e),i()}_flush(e){/[\r\n]$/.test(this.remainder)&&this.byteLength>2&&this.bodyHash.update(Buffer.from(`\r
`)),this.byteLength||this.push(Buffer.from(`\r
`)),this.emit("hash",this.bodyHash.digest("base64"),this.debug?Buffer.concat(this._debugBody):!1),e()}};var _V=yV,Qm={exports:{}};const xV=PI,wV=Wu,EV=Y;Qm.exports=(n,e,t,i)=>{i=i||{};let s=i.headerFieldNames||"From:Sender:Reply-To:Subject:Date:Message-ID:To:Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:List-Owner:List-Archive",o=FI(n,s,i.skipFields),a=TV(i.domainName,i.keySelector,o.fieldNames,e,t),l,u;o.headers+="dkim-signature:"+jI(a),l=EV.createSign(("rsa-"+e).toUpperCase()),l.update(o.headers);try{u=l.sign(i.privateKey,"base64")}catch{return!1}return a+u.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,`$&\r
 `).trim()};Qm.exports.relaxedHeaders=FI;function TV(n,e,t,i,r){let s=["v=1","a=rsa-"+i,"c=relaxed/relaxed","d="+xV.toASCII(n),"q=dns/txt","s="+e,"bh="+r,"h="+t].join("; ");return wV.foldLines("DKIM-Signature: "+s,76)+`;\r
 b=`}function FI(n,e,t){let i=new Set,r=new Set,s=new Map;(t||"").toLowerCase().split(":").forEach(l=>{r.add(l.trim())}),(e||"").toLowerCase().split(":").filter(l=>!r.has(l.trim())).forEach(l=>{i.add(l.trim())});for(let l=n.length-1;l>=0;l--){let u=n[l];i.has(u.key)&&!s.has(u.key)&&s.set(u.key,jI(u.line))}let o=[],a=[];return i.forEach(l=>{s.has(l)&&(a.push(l),o.push(l+":"+s.get(l)))}),{headers:o.join(`\r
`)+`\r
`,fieldNames:a.join(":")}}function jI(n){return n.substr(n.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}var IV=Qm.exports;const SV=mV,AV=_V,bV=IV,ad=Y.PassThrough,ld=Y,CV=Y,kV=Y,PV="sha256",RV=128*1024;class DV{constructor(e,t,i,r){this.options=e||{},this.keys=t,this.cacheTreshold=Number(this.options.cacheTreshold)||RV,this.hashAlgo=this.options.hashAlgo||PV,this.cacheDir=this.options.cacheDir||!1,this.chunks=[],this.chunklen=0,this.readPos=0,this.cachePath=this.cacheDir?CV.join(this.cacheDir,"message."+Date.now()+"-"+kV.randomBytes(14).toString("hex")):!1,this.cache=!1,this.headers=!1,this.bodyHash=!1,this.parser=!1,this.relaxedBody=!1,this.input=i,this.output=r,this.output.usingCache=!1,this.hasErrored=!1,this.input.on("error",s=>{this.hasErrored=!0,this.cleanup(),r.emit("error",s)})}cleanup(){!this.cache||!this.cachePath||ld.unlink(this.cachePath,()=>!1)}createReadCache(){this.cache=ld.createReadStream(this.cachePath),this.cache.once("error",e=>{this.cleanup(),this.output.emit("error",e)}),this.cache.once("close",()=>{this.cleanup()}),this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored)return;if(this.readPos>=this.chunks.length)return this.cache?this.createReadCache():this.output.end();let e=this.chunks[this.readPos++];if(this.output.write(e)===!1)return this.output.once("drain",()=>{this.sendNextChunk()});setImmediate(()=>this.sendNextChunk())}sendSignedOutput(){let e=0,t=()=>{if(e>=this.keys.length)return this.output.write(this.parser.rawHeaders),setImmediate(()=>this.sendNextChunk());let i=this.keys[e++],r=bV(this.headers,this.hashAlgo,this.bodyHash,{domainName:i.domainName,keySelector:i.keySelector,privateKey:i.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});return r&&this.output.write(Buffer.from(r+`\r
`)),setImmediate(t)};if(this.bodyHash&&this.headers)return t();this.output.write(this.parser.rawHeaders),this.sendNextChunk()}createWriteCache(){this.output.usingCache=!0,this.cache=ld.createWriteStream(this.cachePath),this.cache.once("error",e=>{this.cleanup(),this.relaxedBody.unpipe(this.cache),this.relaxedBody.on("readable",()=>{for(;this.relaxedBody.read()!==null;);}),this.hasErrored=!0,this.output.emit("error",e)}),this.cache.once("close",()=>{this.sendSignedOutput()}),this.relaxedBody.removeAllListeners("readable"),this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new SV,this.relaxedBody=new AV({hashAlgo:this.hashAlgo}),this.parser.on("headers",e=>{this.headers=e}),this.relaxedBody.on("hash",e=>{this.bodyHash=e}),this.relaxedBody.on("readable",()=>{let e;if(!this.cache){for(;(e=this.relaxedBody.read())!==null;)if(this.chunks.push(e),this.chunklen+=e.length,this.chunklen>=this.cacheTreshold&&this.cachePath)return this.createWriteCache()}}),this.relaxedBody.on("end",()=>{this.cache||this.sendSignedOutput()}),this.parser.pipe(this.relaxedBody),setImmediate(()=>this.input.pipe(this.parser))}}let NV=class{constructor(e){this.options=e||{},this.keys=[].concat(this.options.keys||{domainName:e.domainName,keySelector:e.keySelector,privateKey:e.privateKey})}sign(e,t){let i=new ad,r=e,s=!1;Buffer.isBuffer(e)?(s=e,r=new ad):typeof e=="string"&&(s=Buffer.from(e),r=new ad);let o=this.options;t&&Object.keys(t).length&&(o={},Object.keys(this.options||{}).forEach(l=>{o[l]=this.options[l]}),Object.keys(t||{}).forEach(l=>{l in o||(o[l]=t[l])}));let a=new DV(o,this.keys,r,i);return setImmediate(()=>{a.signStream(),s&&setImmediate(()=>{r.end(s)})}),i}};var VV=NV;const U_=Y,z_=Y,MV=Y;function BI(n,e,t,i){let r=MV.parse(n),s,o,a;s={host:r.hostname,port:Number(r.port)?Number(r.port):r.protocol==="https:"?443:80},r.protocol==="https:"?(s.rejectUnauthorized=!1,o=z_.connect.bind(z_)):o=U_.connect.bind(U_);let l=!1,u=p=>{if(!l){l=!0;try{a.destroy()}catch{}i(p)}},h=()=>{let p=new Error("Proxy socket timed out");p.code="ETIMEDOUT",u(p)};a=o(s,()=>{if(l)return;let p={Host:t+":"+e,Connection:"close"};r.auth&&(p["Proxy-Authorization"]="Basic "+Buffer.from(r.auth).toString("base64")),a.write("CONNECT "+t+":"+e+` HTTP/1.1\r
`+Object.keys(p).map(I=>I+": "+p[I]).join(`\r
`)+`\r
\r
`);let f="",v=I=>{let b,T;if(!l&&(f+=I.toString("binary"),b=f.match(/\r\n\r\n/))){if(a.removeListener("data",v),T=f.substr(b.index+b[0].length),f=f.substr(0,b.index),T&&a.unshift(Buffer.from(T,"binary")),l=!0,b=f.match(/^HTTP\/\d+\.\d+ (\d+)/i),!b||(b[1]||"").charAt(0)!=="2"){try{a.destroy()}catch{}return i(new Error("Invalid response from proxy"+(b&&": "+b[1]||"")))}return a.removeListener("error",u),a.removeListener("timeout",h),a.setTimeout(0),i(null,a)}};a.on("data",v)}),a.setTimeout(BI.timeout||30*1e3),a.on("timeout",h),a.once("error",u)}var OV=BI;const $_=Dt,LV=LI,Hr=Wu;let FV=class{constructor(e,t){this.mailer=e,this.data={},this.message=null,t=t||{};let i=e.options||{},r=e._defaults||{};Object.keys(t).forEach(s=>{this.data[s]=t[s]}),this.data.headers=this.data.headers||{},Object.keys(r).forEach(s=>{s in this.data?s==="headers"&&Object.keys(r.headers).forEach(o=>{o in this.data.headers||(this.data.headers[o]=r.headers[o])}):this.data[s]=r[s]}),["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach(s=>{s in i&&(this.data[s]=i[s])})}resolveContent(...e){return $_.resolveContent(...e)}resolveAll(e){let t=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];this.data.alternatives&&this.data.alternatives.length&&this.data.alternatives.forEach((l,u)=>{t.push([this.data.alternatives,u])}),this.data.attachments&&this.data.attachments.length&&this.data.attachments.forEach((l,u)=>{l.filename||(l.filename=(l.path||l.href||"").split("/").pop().split("?").shift()||"attachment-"+(u+1),l.filename.indexOf(".")<0&&(l.filename+="."+Hr.detectExtension(l.contentType))),l.contentType||(l.contentType=Hr.detectMimeType(l.filename||l.path||l.href||"bin")),t.push([this.data.attachments,u])});let i=new LV;["from","to","cc","bcc","sender","replyTo"].forEach(l=>{let u;this.message?u=[].concat(i._parseAddresses(this.message.getHeader(l==="replyTo"?"reply-to":l))||[]):this.data[l]&&(u=[].concat(i._parseAddresses(this.data[l])||[])),u&&u.length?this.data[l]=u:l in this.data&&(this.data[l]=null)}),["from","sender"].forEach(l=>{this.data[l]&&(this.data[l]=this.data[l].shift())});let o=0,a=()=>{if(o>=t.length)return e(null,this.data);let l=t[o++];if(!l[0]||!l[0][l[1]])return a();$_.resolveContent(...l,(u,h)=>{if(u)return e(u);let p={content:h};l[0][l[1]]&&typeof l[0][l[1]]=="object"&&!Buffer.isBuffer(l[0][l[1]])&&Object.keys(l[0][l[1]]).forEach(f=>{!(f in p)&&!["content","path","href","raw"].includes(f)&&(p[f]=l[0][l[1]][f])}),l[0][l[1]]=p,a()})};setImmediate(()=>a())}normalize(e){let t=this.data.envelope||this.message.getEnvelope(),i=this.message.messageId();this.resolveAll((r,s)=>r?e(r):(s.envelope=t,s.messageId=i,["html","text","watchHtml","amp"].forEach(o=>{s[o]&&s[o].content&&(typeof s[o].content=="string"?s[o]=s[o].content:Buffer.isBuffer(s[o].content)&&(s[o]=s[o].content.toString()))}),s.icalEvent&&Buffer.isBuffer(s.icalEvent.content)&&(s.icalEvent.content=s.icalEvent.content.toString("base64"),s.icalEvent.encoding="base64"),s.alternatives&&s.alternatives.length&&s.alternatives.forEach(o=>{o&&o.content&&Buffer.isBuffer(o.content)&&(o.content=o.content.toString("base64"),o.encoding="base64")}),s.attachments&&s.attachments.length&&s.attachments.forEach(o=>{o&&o.content&&Buffer.isBuffer(o.content)&&(o.content=o.content.toString("base64"),o.encoding="base64")}),s.normalizedHeaders={},Object.keys(s.headers||{}).forEach(o=>{let a=[].concat(s.headers[o]||[]).shift();a=a&&a.value||a,a&&(["references","in-reply-to","message-id","content-id"].includes(o)&&(a=this.message._encodeHeaderValue(o,a)),s.normalizedHeaders[o]=a)}),s.list&&typeof s.list=="object"&&this._getListHeaders(s.list).forEach(a=>{s.normalizedHeaders[a.key]=a.value.map(l=>l&&l.value||l).join(", ")}),s.references&&(s.normalizedHeaders.references=this.message._encodeHeaderValue("references",s.references)),s.inReplyTo&&(s.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",s.inReplyTo)),e(null,s)))}setMailerHeader(){!this.message||!this.data.xMailer||this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(!(!this.message||!this.data.priority))switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)"),this.message.setHeader("X-MSMail-Priority","High"),this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)"),this.message.setHeader("X-MSMail-Priority","Low"),this.message.setHeader("Importance","Low");break}}setListHeaders(){!this.message||!this.data.list||typeof this.data.list!="object"||this.data.list&&typeof this.data.list=="object"&&this._getListHeaders(this.data.list).forEach(e=>{e.value.forEach(t=>{this.message.addHeader(e.key,t)})})}_getListHeaders(e){return Object.keys(e).map(t=>({key:"list-"+t.toLowerCase().trim(),value:[].concat(e[t]||[]).map(i=>({prepared:!0,foldLines:!0,value:[].concat(i||[]).map(r=>{if(typeof r=="string"&&(r={url:r}),r&&r.url){if(t.toLowerCase().trim()==="id"){let o=r.comment||"";return Hr.isPlainText(o)?o='"'+o+'"':o=Hr.encodeWord(o),(r.comment?o+" ":"")+this._formatListUrl(r.url).replace(/^<[^:]+\/{,2}/,"")}let s=r.comment||"";return Hr.isPlainText(s)||(s=Hr.encodeWord(s)),this._formatListUrl(r.url)+(r.comment?" ("+s+")":"")}return""}).filter(r=>r).join(", ")}))}))}_formatListUrl(e){return e=e.replace(/[\s<]+|[\s>]+/g,""),/^(https?|mailto|ftp):/.test(e)?"<"+e+">":/^[^@]+@[^@]+$/.test(e)?"<mailto:"+e+">":"<http://"+e+">"}};var jV=FV;const BV=Y,q_=Dt,UV=wI,zV=dV,H_=VV,$V=OV,qV=Y,HV=Y,cd=xn,GV=jV,KV=Y,QV=Y,WV=Y;class XV extends BV{constructor(e,t,i){super(),this.options=t||{},this._defaults=i||{},this._defaultPlugins={compile:[(...r)=>this._convertDataImages(...r)],stream:[]},this._userPlugins={compile:[],stream:[]},this.meta=new Map,this.dkim=this.options.dkim?new H_(this.options.dkim):!1,this.transporter=e,this.transporter.mailer=this,this.logger=q_.getLogger(this.options,{component:this.options.component||"mail"}),this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString()),typeof this.transporter.on=="function"&&(this.transporter.on("log",r=>{this.logger.debug({tnx:"transport"},"%s: %s",r.type,r.message)}),this.transporter.on("error",r=>{this.logger.error({err:r,tnx:"transport"},"Transport Error: %s",r.message),this.emit("error",r)}),this.transporter.on("idle",(...r)=>{this.emit("idle",...r)})),["close","isIdle","verify"].forEach(r=>{this[r]=(...s)=>typeof this.transporter[r]=="function"?(r==="verify"&&typeof this.getSocket=="function"&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1),this.transporter[r](...s)):(this.logger.warn({tnx:"transport",methodName:r},"Non existing method %s called for transport",r),!1)}),this.options.proxy&&typeof this.options.proxy=="string"&&this.setupProxy(this.options.proxy)}use(e,t){return e=(e||"").toString(),this._userPlugins.hasOwnProperty(e)?this._userPlugins[e].push(t):this._userPlugins[e]=[t],this}sendMail(e,t=null){let i;t||(i=new Promise((s,o)=>{t=q_.callbackPromise(s,o)})),typeof this.getSocket=="function"&&(this.transporter.getSocket=this.getSocket,this.getSocket=!1);let r=new GV(this,e);return this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version),this._processPlugins("compile",r,s=>{if(s)return this.logger.error({err:s,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",s.message),t(s);r.message=new zV(r.data).compile(),r.setMailerHeader(),r.setPriorityHeaders(),r.setListHeaders(),this._processPlugins("stream",r,o=>{if(o)return this.logger.error({err:o,tnx:"plugin",action:"stream"},"PluginStream Error: %s",o.message),t(o);(r.data.dkim||this.dkim)&&r.message.processFunc(a=>{let l=r.data.dkim?new H_(r.data.dkim):this.dkim;return this.logger.debug({tnx:"DKIM",messageId:r.message.messageId(),dkimDomains:l.keys.map(u=>u.keySelector+"."+u.domainName).join(", ")},"Signing outgoing message with %s keys",l.keys.length),l.sign(a,r.data._dkim)}),this.transporter.send(r,(...a)=>{a[0]&&this.logger.error({err:a[0],tnx:"transport",action:"send"},"Send Error: %s",a[0].message),t(...a)})})}),i}getVersionString(){return qV.format("%s (%s; +%s; %s/%s)",cd.name,cd.version,cd.homepage,this.transporter.name,this.transporter.version)}_processPlugins(e,t,i){if(e=(e||"").toString(),!this._userPlugins.hasOwnProperty(e))return i();let r=this._userPlugins[e]||[],s=this._defaultPlugins[e]||[];if(r.length&&this.logger.debug({tnx:"transaction",pluginCount:r.length,step:e},"Using %s plugins for %s",r.length,e),r.length+s.length===0)return i();let o=0,a="default",l=()=>{let u=a==="default"?s:r;if(o>=u.length)if(a==="default"&&r.length)a="user",o=0,u=r;else return i();let h=u[o++];h(t,p=>{if(p)return i(p);l()})};l()}setupProxy(e){let t=HV.parse(e);this.getSocket=(i,r)=>{let s=t.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+s))return this.meta.get("proxy_handler_"+s)(t,i,r);switch(s){case"http":case"https":$V(t.href,i.port,i.host,(o,a)=>o?r(o):r(null,{connection:a}));return;case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module"))return r(new Error("Socks module not loaded"));let o=a=>{let l=!!this.meta.get("proxy_socks_module").SocksClient,u=l?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module"),h=Number(t.protocol.replace(/\D/g,""))||5,p={proxy:{ipaddress:a,port:Number(t.port),type:h},[l?"destination":"target"]:{host:i.host,port:i.port},command:"connect"};if(t.auth){let f=decodeURIComponent(t.auth.split(":").shift()),v=decodeURIComponent(t.auth.split(":").pop());l?(p.proxy.userId=f,p.proxy.password=v):h===4?p.userid=f:p.authentication={username:f,password:v}}u.createConnection(p,(f,v)=>f?r(f):r(null,{connection:v.socket||v}))};return KV.isIP(t.hostname)?o(t.hostname):QV.resolve(t.hostname,(a,l)=>{if(a)return r(a);o(Array.isArray(l)?l[0]:l)})}}r(new Error("Unknown proxy configuration"))}}_convertDataImages(e,t){if(!this.options.attachDataUrls&&!e.data.attachDataUrls||!e.data.html)return t();e.resolveContent(e.data,"html",(i,r)=>{if(i)return t(i);let s=0;r=(r||"").toString().replace(/(<img\b[^<>]{0,1024} src\s{0,20}=[\s"']{0,20})(data:([^;]+);[^"'>\s]+)/gi,(o,a,l,u)=>{let h=WV.randomBytes(10).toString("hex")+"@localhost";return e.data.attachments||(e.data.attachments=[]),Array.isArray(e.data.attachments)||(e.data.attachments=[].concat(e.data.attachments||[])),e.data.attachments.push({path:l,cid:h,filename:"image-"+ ++s+"."+UV.detectExtension(u)}),a+"cid:"+h}),e.data.html=r,t()})}set(e,t){return this.meta.set(e,t)}get(e){return this.meta.get(e)}}var YV=XV;const JV=Y,ZV=JV.Transform;let eM=class extends ZV{constructor(e){super(e),this.options=e||{},this._curLine="",this.inByteCount=0,this.outByteCount=0,this.lastByte=!1}_transform(e,t,i){let r=[],s=0,o,a,l=0,u;if(!e||!e.length)return i();for(typeof e=="string"&&(e=Buffer.from(e)),this.inByteCount+=e.length,o=0,a=e.length;o<a;o++)e[o]===46?(o&&e[o-1]===10||!o&&(!this.lastByte||this.lastByte===10))&&(u=e.slice(l,o+1),r.push(u),r.push(Buffer.from(".")),s+=u.length+1,l=o+1):e[o]===10&&(o&&e[o-1]!==13||!o&&this.lastByte!==13)&&(o>l?(u=e.slice(l,o),r.push(u),s+=u.length+2):s+=2,r.push(Buffer.from(`\r
`)),l=o+1);s?(l<e.length&&(u=e.slice(l),r.push(u),s+=u.length),this.outByteCount+=s,this.push(Buffer.concat(r,s))):(this.outByteCount+=e.length,this.push(e)),this.lastByte=e[e.length-1],i()}_flush(e){let t;this.lastByte===10?t=Buffer.from(`.\r
`):this.lastByte===13?t=Buffer.from(`
.\r
`):t=Buffer.from(`\r
.\r
`),this.outByteCount+=t.length,this.push(t),e()}};var tM=eM;const nM=xn,iM=Y.EventEmitter,G_=Y,K_=Y,rM=Y,Q_=Y,sM=tM,oM=Y.PassThrough,Cn=Dt,aM=2*60*1e3,W_=10*60*1e3,lM=30*1e3,cM=30*1e3;let uM=class extends iM{constructor(e){super(e),this.id=Q_.randomBytes(8).toString("base64").replace(/\W/g,""),this.stage="init",this.options=e||{},this.secureConnection=!!this.options.secure,this.alreadySecured=!!this.options.secured,this.port=Number(this.options.port)||(this.secureConnection?465:587),this.host=this.options.host||"localhost",this.servername=this.options.servername?this.options.servername:G_.isIP(this.host)?!1:this.host,this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||!1,typeof this.options.secure>"u"&&this.port===465&&(this.secureConnection=!0),this.name=this.options.name||this._getHostname(),this.logger=Cn.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id}),this.customAuth=new Map,Object.keys(this.options.customAuth||{}).forEach(t=>{let i=(t||"").toString().trim().toUpperCase();i&&this.customAuth.set(i,this.options.customAuth[t])}),this.version=nM.version,this.authenticated=!1,this.destroyed=!1,this.secure=!!this.secureConnection,this._remainder="",this._responseQueue=[],this.lastServerResponse=!1,this._socket=!1,this._supportedAuth=[],this.allowsAuth=!1,this._envelope=!1,this._supportedExtensions=[],this._maxAllowedSize=0,this._responseActions=[],this._recipientQueue=[],this._greetingTimeout=!1,this._connectionTimeout=!1,this._destroyed=!1,this._closing=!1,this._onSocketData=t=>this._onData(t),this._onSocketError=t=>this._onError(t,"ESOCKET",!1,"CONN"),this._onSocketClose=()=>this._onClose(),this._onSocketEnd=()=>this._onEnd(),this._onSocketTimeout=()=>this._onTimeout()}connect(e){if(typeof e=="function"){this.once("connect",()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished"),e()});const r=this._isDestroyedMessage("connect");if(r)return e(this._formatError(r,"ECONNECTION",!1,"CONN"))}let t={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces,timeout:this.options.dnsTimeout||cM};this.options.localAddress&&(t.localAddress=this.options.localAddress);let i=()=>{this._connectionTimeout=setTimeout(()=>{this._onError("Connection timeout","ETIMEDOUT",!1,"CONN")},this.options.connectionTimeout||aM),this._socket.on("error",this._onSocketError)};if(this.options.connection){this._socket=this.options.connection,this.secureConnection&&!this.alreadySecured?setImmediate(()=>this._upgradeConnection(r=>{if(r){this._onError(new Error("Error initiating TLS - "+(r.message||r)),"ETLS",!1,"CONN");return}this._onConnect()})):setImmediate(()=>this._onConnect());return}else return this.options.socket?(this._socket=this.options.socket,Cn.resolveHostname(t,(r,s)=>{if(r)return setImmediate(()=>this._onError(r,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:t.host,resolved:s.host,cached:!!s.cached},"Resolved %s as %s [cache %s]",t.host,s.host,s.cached?"hit":"miss"),Object.keys(s).forEach(o=>{o.charAt(0)!=="_"&&s[o]&&(t[o]=s[o])});try{this._socket.connect(this.port,this.host,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),i()}catch(o){return setImmediate(()=>this._onError(o,"ECONNECTION",!1,"CONN"))}})):this.secureConnection?(this.options.tls&&Object.keys(this.options.tls).forEach(r=>{t[r]=this.options.tls[r]}),this.servername&&!t.servername&&(t.servername=this.servername),Cn.resolveHostname(t,(r,s)=>{if(r)return setImmediate(()=>this._onError(r,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:t.host,resolved:s.host,cached:!!s.cached},"Resolved %s as %s [cache %s]",t.host,s.host,s.cached?"hit":"miss"),Object.keys(s).forEach(o=>{o.charAt(0)!=="_"&&s[o]&&(t[o]=s[o])});try{this._socket=K_.connect(t,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),i()}catch(o){return setImmediate(()=>this._onError(o,"ECONNECTION",!1,"CONN"))}})):Cn.resolveHostname(t,(r,s)=>{if(r)return setImmediate(()=>this._onError(r,"EDNS",!1,"CONN"));this.logger.debug({tnx:"dns",source:t.host,resolved:s.host,cached:!!s.cached},"Resolved %s as %s [cache %s]",t.host,s.host,s.cached?"hit":"miss"),Object.keys(s).forEach(o=>{o.charAt(0)!=="_"&&s[o]&&(t[o]=s[o])});try{this._socket=G_.connect(t,()=>{this._socket.setKeepAlive(!0),this._onConnect()}),i()}catch(o){return setImmediate(()=>this._onError(o,"ECONNECTION",!1,"CONN"))}})}quit(){this._sendCommand("QUIT"),this._responseActions.push(this.close)}close(){if(clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),this._responseActions=[],this._closing)return;this._closing=!0;let e="end";this.stage==="init"&&(e="destroy"),this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',e);let t=this._socket&&this._socket.socket||this._socket;if(t&&!t.destroyed)try{this._socket[e]()}catch{}this._destroy()}login(e,t){const i=this._isDestroyedMessage("login");if(i)return t(this._formatError(i,"ECONNECTION",!1,"API"));if(this._auth=e||{},this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||!1,!this._authMethod&&this._auth.oauth2&&!this._auth.credentials?this._authMethod="XOAUTH2":(!this._authMethod||this._authMethod==="XOAUTH2"&&!this._auth.oauth2)&&(this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()),this._authMethod!=="XOAUTH2"&&(!this._auth.credentials||!this._auth.credentials.user||!this._auth.credentials.pass))if(this._auth.user&&this._auth.pass||this.customAuth.has(this._authMethod))this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options};else return t(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",!1,"API"));if(this.customAuth.has(this._authMethod)){let r=this.customAuth.get(this._authMethod),s,o=!1,a=()=>{o||(o=!0,this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0))},l=h=>{o||(o=!0,t(this._formatError(h,"EAUTH",s,"AUTH "+this._authMethod)))},u=r({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||!1,sendCommand:(h,p)=>{let f;return p||(f=new Promise((v,I)=>{p=Cn.callbackPromise(v,I)})),this._responseActions.push(v=>{s=v;let I=v.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/),b={command:h,response:v};I?(b.status=Number(I[1])||0,I[2]&&(b.code=I[2]),b.text=v.substr(I[0].length)):(b.text=v,b.status=0),p(null,b)}),setImmediate(()=>this._sendCommand(h)),f},resolve:a,reject:l});u&&typeof u.catch=="function"&&u.then(a).catch(l);return}switch(this._authMethod){case"XOAUTH2":this._handleXOauth2Token(!1,t);return;case"LOGIN":this._responseActions.push(r=>{this._actionAUTH_LOGIN_USER(r,t)}),this._sendCommand("AUTH LOGIN");return;case"PLAIN":this._responseActions.push(r=>{this._actionAUTHComplete(r,t)}),this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0/* secret */","utf-8").toString("base64"));return;case"CRAM-MD5":this._responseActions.push(r=>{this._actionAUTH_CRAM_MD5(r,t)}),this._sendCommand("AUTH CRAM-MD5");return}return t(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",!1,"API"))}send(e,t,i){if(!t)return i(this._formatError("Empty message","EMESSAGE",!1,"API"));const r=this._isDestroyedMessage("send message");if(r)return i(this._formatError(r,"ECONNECTION",!1,"API"));if(this._maxAllowedSize&&e.size>this._maxAllowedSize)return setImmediate(()=>{i(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",!1,"MAIL FROM"))});let s=!1,o=function(){s||(s=!0,i(...arguments))};typeof t.on=="function"&&t.on("error",l=>o(this._formatError(l,"ESTREAM",!1,"API")));let a=Date.now();this._setEnvelope(e,(l,u)=>{if(l)return o(l);let h=Date.now(),p=this._createSendStream((f,v)=>f?o(f):(u.envelopeTime=h-a,u.messageTime=Date.now()-h,u.messageSize=p.outByteCount,u.response=v,o(null,u)));typeof t.pipe=="function"?t.pipe(p):(p.write(t),p.end())})}reset(e){this._sendCommand("RSET"),this._responseActions.push(t=>t.charAt(0)!=="2"?e(this._formatError("Could not reset session state. response="+t,"EPROTOCOL",t,"RSET")):(this._envelope=!1,e(null,!0)))}_onConnect(){if(clearTimeout(this._connectionTimeout),this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort),this._destroyed){this.close();return}this.stage="connected",this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout),this._socket.removeListener("close",this._onSocketClose),this._socket.removeListener("end",this._onSocketEnd),this._socket.on("data",this._onSocketData),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||W_),this._socket.on("timeout",this._onSocketTimeout),this._greetingTimeout=setTimeout(()=>{this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting&&this._onError("Greeting never received","ETIMEDOUT",!1,"CONN")},this.options.greetingTimeout||lM),this._responseActions.push(this._actionGreeting),this._socket.resume()}_onData(e){if(this._destroyed||!e||!e.length)return;let t=(e||"").toString("binary"),i=(this._remainder+t).split(/\r?\n/),r;this._remainder=i.pop();for(let s=0,o=i.length;s<o;s++){if(this._responseQueue.length&&(r=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(r.split(`
`).pop()))){this._responseQueue[this._responseQueue.length-1]+=`
`+i[s];continue}this._responseQueue.push(i[s])}this._responseQueue.length&&(r=this._responseQueue[this._responseQueue.length-1],/^\d+-/.test(r.split(`
`).pop()))||this._processResponse()}_onError(e,t,i,r){clearTimeout(this._connectionTimeout),clearTimeout(this._greetingTimeout),!this._destroyed&&(e=this._formatError(e,t,i,r),this.logger.error(i,e.message),this.emit("error",e),this.close())}_formatError(e,t,i,r){let s;/Error\]$/i.test(Object.prototype.toString.call(e))?s=e:s=new Error(e),t&&t!=="Error"&&(s.code=t),i&&(s.response=i,s.message+=": "+i);let o=typeof i=="string"&&Number((i.match(/^\d+/)||[])[0])||!1;return o&&(s.responseCode=o),r&&(s.command=r),s}_onClose(){let e=!1;if(this._remainder&&this._remainder.trim()&&((this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},this._remainder.replace(/\r?\n$/,"")),this.lastServerResponse=e=this._remainder.trim()),this.logger.info({tnx:"network"},"Connection closed"),this.upgrading&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ETLS",e,"CONN");if(![this._actionGreeting,this.close].includes(this._responseActions[0])&&!this._destroyed)return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",e,"CONN");if(/^[45]\d{2}\b/.test(e))return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",e,"CONN");this._destroy()}_onEnd(){this._socket&&!this._socket.destroyed&&this._socket.destroy()}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",!1,"CONN")}_destroy(){this._destroyed||(this._destroyed=!0,this.emit("end"))}_upgradeConnection(e){this._socket.removeListener("data",this._onSocketData),this._socket.removeListener("timeout",this._onSocketTimeout);let t=this._socket,i={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach(r=>{i[r]=this.options.tls[r]}),this.servername&&!i.servername&&(i.servername=this.servername),this.upgrading=!0;try{this._socket=K_.connect(i,()=>(this.secure=!0,this.upgrading=!1,this._socket.on("data",this._onSocketData),t.removeListener("close",this._onSocketClose),t.removeListener("end",this._onSocketEnd),e(null,!0)))}catch(r){return e(r)}this._socket.on("error",this._onSocketError),this._socket.once("close",this._onSocketClose),this._socket.once("end",this._onSocketEnd),this._socket.setTimeout(this.options.socketTimeout||W_),this._socket.on("timeout",this._onSocketTimeout),t.resume()}_processResponse(){if(!this._responseQueue.length)return!1;let e=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(e.split(`
`).pop()))return;(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"server"},e.replace(/\r?\n$/,"")),e.trim()||setImmediate(()=>this._processResponse());let t=this._responseActions.shift();if(typeof t=="function")t.call(this,e),setImmediate(()=>this._processResponse());else return this._onError(new Error("Unexpected Response"),"EPROTOCOL",e,"CONN")}_sendCommand(e,t){if(!this._destroyed){if(this._socket.destroyed)return this.close();(this.options.debug||this.options.transactionLog)&&this.logger.debug({tnx:"client"},(t||e||"").toString().replace(/\r?\n$/,"")),this._socket.write(Buffer.from(e+`\r
`,"utf-8"))}}_setEnvelope(e,t){let i=[],r=!1;if(this._envelope=e||{},this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim(),this._envelope.to=[].concat(this._envelope.to||[]).map(s=>(s&&s.address||s||"").toString().trim()),!this._envelope.to.length)return t(this._formatError("No recipients defined","EENVELOPE",!1,"API"));if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from))return t(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.from)&&(r=!0);for(let s=0,o=this._envelope.to.length;s<o;s++){if(!this._envelope.to[s]||/[\r\n<>]/.test(this._envelope.to[s]))return t(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[s]),"EENVELOPE",!1,"API"));/[\x80-\uFFFF]/.test(this._envelope.to[s])&&(r=!0)}if(this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[])),this._envelope.rejected=[],this._envelope.rejectedErrors=[],this._envelope.accepted=[],this._envelope.dsn)try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(s){return t(this._formatError("Invalid DSN "+s.message,"EENVELOPE",!1,"API"))}this._responseActions.push(s=>{this._actionMAIL(s,t)}),r&&this._supportedExtensions.includes("SMTPUTF8")&&(i.push("SMTPUTF8"),this._usingSmtpUtf8=!0),this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")&&(i.push("BODY=8BITMIME"),this._using8BitMime=!0),this._envelope.size&&this._supportedExtensions.includes("SIZE")&&i.push("SIZE="+this._envelope.size),this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.ret&&i.push("RET="+Cn.encodeXText(this._envelope.dsn.ret)),this._envelope.dsn.envid&&i.push("ENVID="+Cn.encodeXText(this._envelope.dsn.envid))),this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(i.length?" "+i.join(" "):""))}_setDsnEnvelope(e){let t=(e.ret||e.return||"").toString().toUpperCase()||null;if(t)switch(t){case"HDRS":case"HEADERS":t="HDRS";break;case"FULL":case"BODY":t="FULL";break}if(t&&!["FULL","HDRS"].includes(t))throw new Error("ret: "+JSON.stringify(t));let i=(e.envid||e.id||"").toString()||null,r=e.notify||null;if(r){typeof r=="string"&&(r=r.split(",")),r=r.map(l=>l.trim().toUpperCase());let o=["NEVER","SUCCESS","FAILURE","DELAY"];if(r.filter(l=>!o.includes(l)).length||r.length>1&&r.includes("NEVER"))throw new Error("notify: "+JSON.stringify(r.join(",")));r=r.join(",")}let s=(e.recipient||e.orcpt||"").toString()||null;return s&&s.indexOf(";")<0&&(s="rfc822;"+s),{ret:t,envid:i,notify:r,orcpt:s}}_getDsnRcptToArgs(){let e=[];return this._envelope.dsn&&this._supportedExtensions.includes("DSN")&&(this._envelope.dsn.notify&&e.push("NOTIFY="+Cn.encodeXText(this._envelope.dsn.notify)),this._envelope.dsn.orcpt&&e.push("ORCPT="+Cn.encodeXText(this._envelope.dsn.orcpt))),e.length?" "+e.join(" "):""}_createSendStream(e){let t=new sM,i;return this.options.lmtp?this._envelope.accepted.forEach((r,s)=>{let o=s===this._envelope.accepted.length-1;this._responseActions.push(a=>{this._actionLMTPStream(r,o,a,e)})}):this._responseActions.push(r=>{this._actionSMTPStream(r,e)}),t.pipe(this._socket,{end:!1}),this.options.debug&&(i=new oM,i.on("readable",()=>{let r;for(;r=i.read();)this.logger.debug({tnx:"message"},r.toString("binary").replace(/\r?\n$/,""))}),t.pipe(i)),t.once("end",()=>{this.logger.info({tnx:"message",inByteCount:t.inByteCount,outByteCount:t.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",t.outByteCount,t.inByteCount)}),t}_actionGreeting(e){if(clearTimeout(this._greetingTimeout),e.substr(0,3)!=="220"){this._onError(new Error("Invalid greeting. response="+e),"EPROTOCOL",e,"CONN");return}this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name))}_actionLHLO(e){if(e.charAt(0)!=="2"){this._onError(new Error("Invalid LHLO. response="+e),"EPROTOCOL",e,"LHLO");return}this._actionEHLO(e)}_actionEHLO(e){let t;if(e.substr(0,3)==="421"){this._onError(new Error("Server terminates connection. response="+e),"ECONNECTION",e,"EHLO");return}if(e.charAt(0)!=="2"){if(this.options.requireTLS){this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+e),"ECONNECTION",e,"EHLO");return}this._responseActions.push(this._actionHELO),this._sendCommand("HELO "+this.name);return}if(this._ehloLines=e.split(/\r?\n/).map(i=>i.replace(/^\d+[ -]/,"").trim()).filter(i=>i).slice(1),!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(e)||this.options.requireTLS)){this._sendCommand("STARTTLS"),this._responseActions.push(this._actionSTARTTLS);return}/[ -]SMTPUTF8\b/im.test(e)&&this._supportedExtensions.push("SMTPUTF8"),/[ -]DSN\b/im.test(e)&&this._supportedExtensions.push("DSN"),/[ -]8BITMIME\b/im.test(e)&&this._supportedExtensions.push("8BITMIME"),/[ -]PIPELINING\b/im.test(e)&&this._supportedExtensions.push("PIPELINING"),/[ -]AUTH\b/i.test(e)&&(this.allowsAuth=!0),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(e)&&this._supportedAuth.push("PLAIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(e)&&this._supportedAuth.push("LOGIN"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(e)&&this._supportedAuth.push("CRAM-MD5"),/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(e)&&this._supportedAuth.push("XOAUTH2"),(t=e.match(/[ -]SIZE(?:[ \t]+(\d+))?/im))&&(this._supportedExtensions.push("SIZE"),this._maxAllowedSize=Number(t[1])||0),this.emit("connect")}_actionHELO(e){if(e.charAt(0)!=="2"){this._onError(new Error("Invalid HELO. response="+e),"EPROTOCOL",e,"HELO");return}this.allowsAuth=!0,this.emit("connect")}_actionSTARTTLS(e){if(e.charAt(0)!=="2"){if(this.options.opportunisticTLS)return this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted"),this.emit("connect");this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",e,"STARTTLS");return}this._upgradeConnection((t,i)=>{if(t){this._onError(new Error("Error initiating TLS - "+(t.message||t)),"ETLS",!1,"STARTTLS");return}this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS"),i?this.options.lmtp?(this._responseActions.push(this._actionLHLO),this._sendCommand("LHLO "+this.name)):(this._responseActions.push(this._actionEHLO),this._sendCommand("EHLO "+this.name)):this.emit("connect")})}_actionAUTH_LOGIN_USER(e,t){if(!/^334[ -]/.test(e)){t(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",e,"AUTH LOGIN"));return}this._responseActions.push(i=>{this._actionAUTH_LOGIN_PASS(i,t)}),this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))}_actionAUTH_CRAM_MD5(e,t){let i=e.match(/^334\s+(.+)$/),r="";if(i)r=i[1];else return t(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",e,"AUTH CRAM-MD5"));let s=Buffer.from(r,"base64").toString("ascii"),o=Q_.createHmac("md5",this._auth.credentials.pass);o.update(s);let a=this._auth.credentials.user+" "+o.digest("hex");this._responseActions.push(l=>{this._actionAUTH_CRAM_MD5_PASS(l,t)}),this._sendCommand(Buffer.from(a).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(e,t){if(!e.match(/^235\s+/))return t(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",e,"AUTH CRAM-MD5"));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,t(null,!0)}_actionAUTH_LOGIN_PASS(e,t){if(!/^334[ -]/.test(e))return t(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",e,"AUTH LOGIN"));this._responseActions.push(i=>{this._actionAUTHComplete(i,t)}),this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(e,t,i){if(!i&&typeof t=="function"&&(i=t,t=!1),e.substr(0,3)==="334"){this._responseActions.push(r=>{t||this._authMethod!=="XOAUTH2"?this._actionAUTHComplete(r,!0,i):setImmediate(()=>this._handleXOauth2Token(!0,i))}),this._sendCommand("");return}if(e.charAt(0)!=="2")return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),i(this._formatError("Invalid login","EAUTH",e,"AUTH "+this._authMethod));this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user)),this.authenticated=!0,i(null,!0)}_actionMAIL(e,t){let i,r;if(Number(e.charAt(0))!==2)return this._usingSmtpUtf8&&/^550 /.test(e)&&/[\x80-\uFFFF]/.test(this._envelope.from)?i="Internationalized mailbox name not allowed":i="Mail command failed",t(this._formatError(i,"EENVELOPE",e,"MAIL FROM"));if(this._envelope.rcptQueue.length)if(this._recipientQueue=[],this._supportedExtensions.includes("PIPELINING"))for(;this._envelope.rcptQueue.length;)r=this._envelope.rcptQueue.shift(),this._recipientQueue.push(r),this._responseActions.push(s=>{this._actionRCPT(s,t)}),this._sendCommand("RCPT TO:<"+r+">"+this._getDsnRcptToArgs());else r=this._envelope.rcptQueue.shift(),this._recipientQueue.push(r),this._responseActions.push(s=>{this._actionRCPT(s,t)}),this._sendCommand("RCPT TO:<"+r+">"+this._getDsnRcptToArgs());else return t(this._formatError("Can't send mail - no recipients defined","EENVELOPE",!1,"API"))}_actionRCPT(e,t){let i,r,s=this._recipientQueue.shift();if(Number(e.charAt(0))!==2?(this._usingSmtpUtf8&&/^553 /.test(e)&&/[\x80-\uFFFF]/.test(s)?i="Internationalized mailbox name not allowed":i="Recipient command failed",this._envelope.rejected.push(s),r=this._formatError(i,"EENVELOPE",e,"RCPT TO"),r.recipient=s,this._envelope.rejectedErrors.push(r)):this._envelope.accepted.push(s),!this._envelope.rcptQueue.length&&!this._recipientQueue.length)if(this._envelope.rejected.length<this._envelope.to.length)this._responseActions.push(o=>{this._actionDATA(o,t)}),this._sendCommand("DATA");else return r=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",e,"RCPT TO"),r.rejected=this._envelope.rejected,r.rejectedErrors=this._envelope.rejectedErrors,t(r);else this._envelope.rcptQueue.length&&(s=this._envelope.rcptQueue.shift(),this._recipientQueue.push(s),this._responseActions.push(o=>{this._actionRCPT(o,t)}),this._sendCommand("RCPT TO:<"+s+">"+this._getDsnRcptToArgs()))}_actionDATA(e,t){if(!/^[23]/.test(e))return t(this._formatError("Data command failed","EENVELOPE",e,"DATA"));let i={accepted:this._envelope.accepted,rejected:this._envelope.rejected};this._ehloLines&&this._ehloLines.length&&(i.ehlo=this._ehloLines),this._envelope.rejectedErrors.length&&(i.rejectedErrors=this._envelope.rejectedErrors),t(null,i)}_actionSMTPStream(e,t){return Number(e.charAt(0))!==2?t(this._formatError("Message failed","EMESSAGE",e,"DATA")):t(null,e)}_actionLMTPStream(e,t,i,r){let s;if(Number(i.charAt(0))!==2){s=this._formatError("Message failed for recipient "+e,"EMESSAGE",i,"DATA"),s.recipient=e,this._envelope.rejected.push(e),this._envelope.rejectedErrors.push(s);for(let o=0,a=this._envelope.accepted.length;o<a;o++)this._envelope.accepted[o]===e&&this._envelope.accepted.splice(o,1)}if(t)return r(null,i)}_handleXOauth2Token(e,t){this._auth.oauth2.getToken(e,(i,r)=>{if(i)return this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user)),t(this._formatError(i,"EAUTH",!1,"AUTH XOAUTH2"));this._responseActions.push(s=>{this._actionAUTHComplete(s,e,t)}),this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(r),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))})}_isDestroyedMessage(e){if(this._destroyed)return"Cannot "+e+" - smtp connection is already destroyed.";if(this._socket){if(this._socket.destroyed)return"Cannot "+e+" - smtp connection socket is already destroyed.";if(!this._socket.writable)return"Cannot "+e+" - smtp connection socket is already half-closed."}}_getHostname(){let e;try{e=rM.hostname()||""}catch{e="localhost"}return(!e||e.indexOf(".")<0)&&(e="[127.0.0.1]"),e.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)&&(e="["+e+"]"),e}};var Wm=uM;const hM=Y.Stream,dM=Qu,pM=Y,fM=Dt;let mM=class extends hM{constructor(e,t){if(super(),this.options=e||{},e&&e.serviceClient){if(!e.privateKey||!e.user){setImmediate(()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!')));return}let i=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=i||5*60}if(this.logger=fM.getLogger({logger:t},{component:this.options.component||"OAuth2"}),this.provisionCallback=typeof this.options.provisionCallback=="function"?this.options.provisionCallback:!1,this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token",this.options.customHeaders=this.options.customHeaders||{},this.options.customParams=this.options.customParams||{},this.accessToken=this.options.accessToken||!1,this.options.expires&&Number(this.options.expires))this.expires=this.options.expires;else{let i=Math.max(Number(this.options.timeout)||0,0);this.expires=i&&Date.now()+i*1e3||0}}getToken(e,t){if(!e&&this.accessToken&&(!this.expires||this.expires>Date.now()))return t(null,this.accessToken);let i=(...r)=>{r[0]?this.logger.error({err:r[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user):this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user),t(...r)};this.provisionCallback?this.provisionCallback(this.options.user,!!e,(r,s,o)=>{!r&&s&&(this.accessToken=s,this.expires=o||0),i(r,s)}):this.generateToken(i)}updateToken(e,t){this.accessToken=e,t=Math.max(Number(t)||0,0),this.expires=t&&Date.now()+t*1e3||0,this.emit("token",{user:this.options.user,accessToken:e||"",expires:this.expires})}generateToken(e){let t,i;if(this.options.serviceClient){let r=Math.floor(Date.now()/1e3),s={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:r,exp:r+this.options.serviceRequestTimeout},o;try{o=this.jwtSignRS256(s)}catch{return e(new Error("Can't generate token. Check your auth options"))}t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:o},i={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:s}}else{if(!this.options.refreshToken)return e(new Error("Can't create new access token for user"));t={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"},i={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach(r=>{t[r]=this.options.customParams[r],i[r]=this.options.customParams[r]}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(i)),this.postRequest(this.options.accessUrl,t,this.options,(r,s)=>{let o;if(r)return e(r);try{o=JSON.parse(s.toString())}catch(l){return e(l)}if(!o||typeof o!="object")return this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(s||"").toString()),e(new Error("Invalid authentication response"));let a={};if(Object.keys(o).forEach(l=>{l!=="access_token"?a[l]=o[l]:a[l]=(o[l]||"").toString().substr(0,6)+"..."}),this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(a)),o.error){let l=o.error;return o.error_description&&(l+=": "+o.error_description),o.error_uri&&(l+=" ("+o.error_uri+")"),e(new Error(l))}return o.access_token?(this.updateToken(o.access_token,o.expires_in),e(null,this.accessToken)):e(new Error("No access token"))})}buildXOAuth2Token(e){let t=["user="+(this.options.user||""),"auth=Bearer "+(e||this.accessToken),"",""];return Buffer.from(t.join(""),"utf-8").toString("base64")}postRequest(e,t,i,r){let s=!1,o=[],a=0,l=dM(e,{method:"post",headers:i.customHeaders,body:t,allowErrorResponse:!0});l.on("readable",()=>{let u;for(;(u=l.read())!==null;)o.push(u),a+=u.length}),l.once("error",u=>{if(!s)return s=!0,r(u)}),l.once("end",()=>{if(!s)return s=!0,r(null,Buffer.concat(o,a))})}toBase64URL(e){return typeof e=="string"&&(e=Buffer.from(e)),e.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(e){e=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(e)].map(i=>this.toBase64URL(i)).join(".");let t=pM.createSign("RSA-SHA256").update(e).sign(this.options.privateKey);return e+"."+this.toBase64URL(t)}};var UI=mM;const gM=Wm,vM=Dt.assign,yM=UI,_M=Y;let xM=class extends _M{constructor(e){if(super(),this.pool=e,this.options=e.options,this.logger=this.pool.logger,this.options.auth)switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let t=new yM(this.options.auth,this.logger);t.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||t.provisionCallback,this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:t,method:"XOAUTH2"},t.on("token",i=>this.pool.mailer.emit("token",i)),t.on("error",i=>this.emit("error",i));break}default:if(!this.options.auth.user&&!this.options.auth.pass)break;this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||!1}}this._connection=!1,this._connected=!1,this.messages=0,this.available=!0}connect(e){this.pool.getSocket(this.options,(t,i)=>{if(t)return e(t);let r=!1,s=this.options;i&&i.connection&&(this.logger.info({tnx:"proxy",remoteAddress:i.connection.remoteAddress,remotePort:i.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",i.connection.remoteAddress,i.connection.remotePort,s.host||"",s.port||""),s=vM(!1,s),Object.keys(i).forEach(o=>{s[o]=i[o]})),this.connection=new gM(s),this.connection.once("error",o=>{if(this.emit("error",o),!r)return r=!0,e(o)}),this.connection.once("end",()=>{if(this.close(),r)return;r=!0;let o=setTimeout(()=>{if(r)return;let a=new Error("Unexpected socket close");this.connection&&this.connection._socket&&this.connection._socket.upgrading&&(a.code="ETLS"),e(a)},1e3);try{o.unref()}catch{}}),this.connection.connect(()=>{if(!r)if(this.auth&&(this.connection.allowsAuth||s.forceAuth))this.connection.login(this.auth,o=>{if(!r){if(r=!0,o)return this.connection.close(),this.emit("error",o),e(o);this._connected=!0,e(null,!0)}});else return r=!0,this._connected=!0,e(null,!0)})})}send(e,t){if(!this._connected)return this.connect(o=>o?t(o):this.send(e,t));let i=e.message.getEnvelope(),r=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r,cid:this.id},"Sending message %s using #%s to <%s>",r,this.id,s.join(", ")),e.data.dsn&&(i.dsn=e.data.dsn),this.connection.send(i,e.message.createReadStream(),(o,a)=>{if(this.messages++,o)return this.connection.close(),this.emit("error",o),t(o);a.envelope={from:i.from,to:i.to},a.messageId=r,setImmediate(()=>{let l;this.messages>=this.options.maxMessages?(l=new Error("Resource exhausted"),l.code="EMAXLIMIT",this.connection.close(),this.emit("error",l)):this.pool._checkRateLimit(()=>{this.available=!0,this.emit("available")})}),t(null,a)})}close(){this._connected=!1,this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.connection&&this.connection.close(),this.emit("close")}};var wM=xM;const EM={domains:["aliyun.com"],host:"smtp.aliyun.com",port:465,secure:!0},TM={domains:["aol.com"],host:"smtp.aol.com",port:587},IM={host:"smtpauths.bluewin.ch",domains:["bluewin.ch"],port:465},SM={host:"debugmail.io",port:25},AM={aliases:["Dynect"],host:"smtp.dynect.net",port:25},bM={aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},CM={domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:!0},kM={aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},PM={aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:!0},RM={host:"smtpout.secureserver.net",port:25},DM={host:"smtp.asia.secureserver.net",port:25},NM={host:"smtp.europe.secureserver.net",port:25},VM={aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},MM={aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},OM={host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},LM={host:"mailcluster.loopia.se",port:465},FM={port:1025,ignoreTLS:!0},jM={host:"smtp.mailgun.org",port:465,secure:!0},BM={host:"in.mailjet.com",port:587},UM={host:"mailosaur.io",port:25},zM={host:"live.smtp.mailtrap.io",port:587},$M={host:"smtp.mandrillapp.com",port:587},qM={host:"smtp.naver.com",port:587},HM={host:"send.one.com",port:465,secure:!0},GM={aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:!0},KM={host:"smtp.office365.com",port:587,secure:!1},QM={host:"smtp.ohmysmtp.com",port:587,secure:!1},WM={aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},XM={domains:["qq.com"],host:"smtp.qq.com",port:465,secure:!0},YM={aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:!0},JM={host:"smtp.sendcloud.net",port:2525},ZM={host:"smtp.sendgrid.net",port:587},eO={aliases:["Brevo"],host:"smtp-relay.brevo.com",port:587},tO={host:"smtp-pulse.com",port:465,secure:!0},nO={host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},iO={aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:!1},rO={host:"smtp.tipimail.com",port:587},sO={domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:!0},oO={domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:!0},aO={host:"smtp.zoho.com",port:465,secure:!0,authMethod:"LOGIN"},lO={126:{host:"smtp.126.com",port:465,secure:!0},163:{host:"smtp.163.com",port:465,secure:!0},"1und1":{host:"smtp.1und1.de",port:465,secure:!0,authMethod:"LOGIN"},Aliyun:EM,AOL:TM,Bluewin:IM,DebugMail:SM,DynectEmail:AM,Ethereal:bM,FastMail:CM,"Forward Email":{aliases:["FE","ForwardEmail"],domains:["forwardemail.net"],host:"smtp.forwardemail.net",port:465,secure:!0},"Feishu Mail":{aliases:["Feishu","FeishuMail"],domains:["www.feishu.cn"],host:"smtp.feishu.cn",port:465,secure:!0},GandiMail:kM,Gmail:PM,Godaddy:RM,GodaddyAsia:DM,GodaddyEurope:NM,"hot.ee":{host:"mail.hot.ee"},Hotmail:VM,iCloud:MM,Infomaniak:OM,Loopia:LM,"mail.ee":{host:"smtp.mail.ee"},"Mail.ru":{host:"smtp.mail.ru",port:465,secure:!0},"Mailcatch.app":{host:"sandbox-smtp.mailcatch.app",port:2525},Maildev:FM,Mailgun:jM,Mailjet:BM,Mailosaur:UM,Mailtrap:zM,Mandrill:$M,Naver:qM,One:HM,OpenMailBox:GM,Outlook365:KM,OhMySMTP:QM,Postmark:WM,"qiye.aliyun":{host:"smtp.mxhichina.com",port:"465",secure:!0},QQ:XM,QQex:YM,SendCloud:JM,SendGrid:ZM,SendinBlue:eO,SendPulse:tO,SES:nO,"SES-US-EAST-1":{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:!0},"SES-US-WEST-2":{host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:!0},"SES-EU-WEST-1":{host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTH-1":{host:"email-smtp.ap-south-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-1":{host:"email-smtp.ap-northeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-2":{host:"email-smtp.ap-northeast-2.amazonaws.com",port:465,secure:!0},"SES-AP-NORTHEAST-3":{host:"email-smtp.ap-northeast-3.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-1":{host:"email-smtp.ap-southeast-1.amazonaws.com",port:465,secure:!0},"SES-AP-SOUTHEAST-2":{host:"email-smtp.ap-southeast-2.amazonaws.com",port:465,secure:!0},Sparkpost:iO,Tipimail:rO,Yahoo:sO,Yandex:oO,Zoho:aO},X_=lO,pc={};Object.keys(X_).forEach(n=>{let e=X_[n];pc[fc(n)]=ud(e),[].concat(e.aliases||[]).forEach(t=>{pc[fc(t)]=ud(e)}),[].concat(e.domains||[]).forEach(t=>{pc[fc(t)]=ud(e)})});function fc(n){return n.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function ud(n){let e=["domains","aliases"],t={};return Object.keys(n).forEach(i=>{e.indexOf(i)<0&&(t[i]=n[i])}),t}var zI=function(n){return n=fc(n.split("@").pop()),pc[n]||!1};const cO=Y,Y_=wM,J_=Wm,uO=zI,Ro=Dt,hO=xn;let dO=class extends cO{constructor(e){super(),e=e||{},typeof e=="string"&&(e={url:e});let t,i=e.service;typeof e.getSocket=="function"&&(this.getSocket=e.getSocket),e.url&&(t=Ro.parseConnectionUrl(e.url),i=i||t.service),this.options=Ro.assign(!1,e,t,i&&uO(i)),this.options.maxConnections=this.options.maxConnections||5,this.options.maxMessages=this.options.maxMessages||100,this.logger=Ro.getLogger(this.options,{component:this.options.component||"smtp-pool"});let r=new J_(this.options);this.name="SMTP (pool)",this.version=hO.version+"[client:"+r.version+"]",this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:!1,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0},this._closed=!1,this._queue=[],this._connections=[],this._connectionCounter=0,this.idling=!0,setImmediate(()=>{this.idling&&this.emit("idle")})}getSocket(e,t){return setImmediate(()=>t(null,!1))}send(e,t){return this._closed?!1:(this._queue.push({mail:e,requeueAttempts:0,callback:t}),this.idling&&this._queue.length>=this.options.maxConnections&&(this.idling=!1),setImmediate(()=>this._processMessages()),!0)}close(){let e,t=this._connections.length;if(this._closed=!0,clearTimeout(this._rateLimit.timeout),!t&&!this._queue.length)return;for(let r=t-1;r>=0;r--)this._connections[r]&&this._connections[r].available&&(e=this._connections[r],e.close(),this.logger.info({tnx:"connection",cid:e.id,action:"removed"},"Connection #%s removed",e.id));if(t&&!this._connections.length&&this.logger.debug({tnx:"connection"},"All connections removed"),!this._queue.length)return;let i=()=>{if(!this._queue.length){this.logger.debug({tnx:"connection"},"Pending queue entries cleared");return}let r=this._queue.shift();if(r&&typeof r.callback=="function")try{r.callback(new Error("Connection pool was closed"))}catch(s){this.logger.error({err:s,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,s.message)}setImmediate(i)};setImmediate(i)}_processMessages(){let e,t,i;if(this._closed)return;if(!this._queue.length){this.idling||(this.idling=!0,this.emit("idle"));return}for(t=0,i=this._connections.length;t<i;t++)if(this._connections[t].available){e=this._connections[t];break}if(!e&&this._connections.length<this.options.maxConnections&&(e=this._createConnection()),!e){this.idling=!1;return}!this.idling&&this._queue.length<this.options.maxConnections&&(this.idling=!0,this.emit("idle"));let r=e.queueEntry=this._queue.shift();r.messageId=(e.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),e.available=!1,this.logger.debug({tnx:"pool",cid:e.id,messageId:r.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",r.messageId,e.id,e.messages+1),this._rateLimit.limit&&(this._rateLimit.counter++,this._rateLimit.checkpoint||(this._rateLimit.checkpoint=Date.now())),e.send(r.mail,(s,o)=>{if(r===e.queueEntry){try{r.callback(s,o)}catch(a){this.logger.error({err:a,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,a.message)}e.queueEntry=!1}})}_createConnection(){let e=new Y_(this);return e.id=++this._connectionCounter,this.logger.info({tnx:"pool",cid:e.id,action:"conection"},"Created new pool resource #%s",e.id),e.on("available",()=>{this.logger.debug({tnx:"connection",cid:e.id,action:"available"},"Connection #%s became available",e.id),this._closed?this.close():this._processMessages()}),e.once("error",t=>{if(t.code!=="EMAXLIMIT"?this.logger.error({err:t,tnx:"pool",cid:e.id},"Pool Error for #%s: %s",e.id,t.message):this.logger.debug({tnx:"pool",cid:e.id,action:"maxlimit"},"Max messages limit exchausted for #%s",e.id),e.queueEntry){try{e.queueEntry.callback(t)}catch(i){this.logger.error({err:i,tnx:"callback",cid:e.id},"Callback error for #%s: %s",e.id,i.message)}e.queueEntry=!1}this._removeConnection(e),this._continueProcessing()}),e.once("close",()=>{this.logger.info({tnx:"connection",cid:e.id,action:"closed"},"Connection #%s was closed",e.id),this._removeConnection(e),e.queueEntry?setTimeout(()=>{e.queueEntry&&(this._shouldRequeuOnConnectionClose(e.queueEntry)?this._requeueEntryOnConnectionClose(e):this._failDeliveryOnConnectionClose(e)),this._continueProcessing()},50):this._continueProcessing()}),this._connections.push(e),e}_shouldRequeuOnConnectionClose(e){return this.options.maxRequeues===void 0||this.options.maxRequeues<0?!0:e.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(e){if(e.queueEntry&&e.queueEntry.callback){try{e.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(t){this.logger.error({err:t,tnx:"callback",messageId:e.queueEntry.messageId,cid:e.id},"Callback error for #%s: %s",e.id,t.message)}e.queueEntry=!1}}_requeueEntryOnConnectionClose(e){e.queueEntry.requeueAttempts=e.queueEntry.requeueAttempts+1,this.logger.debug({tnx:"pool",cid:e.id,messageId:e.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",e.queueEntry.messageId,e.id,e.queueEntry.requeueAttempts),this._queue.unshift(e.queueEntry),e.queueEntry=!1}_continueProcessing(){this._closed?this.close():setTimeout(()=>this._processMessages(),100)}_removeConnection(e){let t=this._connections.indexOf(e);t!==-1&&this._connections.splice(t,1)}_checkRateLimit(e){if(!this._rateLimit.limit)return e();let t=Date.now();if(this._rateLimit.counter<this._rateLimit.limit)return e();if(this._rateLimit.waiting.push(e),this._rateLimit.checkpoint<=t-this._rateLimit.delta)return this._clearRateLimit();this._rateLimit.timeout||(this._rateLimit.timeout=setTimeout(()=>this._clearRateLimit(),this._rateLimit.delta-(t-this._rateLimit.checkpoint)),this._rateLimit.checkpoint=t)}_clearRateLimit(){for(clearTimeout(this._rateLimit.timeout),this._rateLimit.timeout=null,this._rateLimit.counter=0,this._rateLimit.checkpoint=!1;this._rateLimit.waiting.length;){let e=this._rateLimit.waiting.shift();setImmediate(e)}}isIdle(){return this.idling}verify(e){let t;e||(t=new Promise((r,s)=>{e=Ro.callbackPromise(r,s)}));let i=new Y_(this).auth;return this.getSocket(this.options,(r,s)=>{if(r)return e(r);let o=this.options;s&&s.connection&&(this.logger.info({tnx:"proxy",remoteAddress:s.connection.remoteAddress,remotePort:s.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",s.connection.remoteAddress,s.connection.remotePort,o.host||"",o.port||""),o=Ro.assign(!1,o),Object.keys(s).forEach(h=>{o[h]=s[h]}));let a=new J_(o),l=!1;a.once("error",h=>{if(!l)return l=!0,a.close(),e(h)}),a.once("end",()=>{if(!l)return l=!0,e(new Error("Connection closed"))});let u=()=>{if(!l)return l=!0,a.quit(),e(null,!0)};a.connect(()=>{if(!l)if(i&&(a.allowsAuth||o.forceAuth))a.login(i,h=>{if(!l){if(h)return l=!0,a.close(),e(h);u()}});else if(!i&&a.allowsAuth&&o.forceAuth){let h=new Error("Authentication info was not provided");return h.code="NoAuth",l=!0,a.close(),e(h)}else u()})}),t}};var pO=dO;const fO=Y,hd=Wm,mO=zI,Gr=Dt,gO=UI,vO=xn;let yO=class extends fO{constructor(e){super(),e=e||{},typeof e=="string"&&(e={url:e});let t,i=e.service;typeof e.getSocket=="function"&&(this.getSocket=e.getSocket),e.url&&(t=Gr.parseConnectionUrl(e.url),i=i||t.service),this.options=Gr.assign(!1,e,t,i&&mO(i)),this.logger=Gr.getLogger(this.options,{component:this.options.component||"smtp-transport"});let r=new hd(this.options);this.name="SMTP",this.version=vO.version+"[client:"+r.version+"]",this.options.auth&&(this.auth=this.getAuth({}))}getSocket(e,t){return setImmediate(()=>t(null,!1))}getAuth(e){if(!e)return this.auth;let t=!1,i={};if(this.options.auth&&typeof this.options.auth=="object"&&Object.keys(this.options.auth).forEach(r=>{t=!0,i[r]=this.options.auth[r]}),e&&typeof e=="object"&&Object.keys(e).forEach(r=>{t=!0,i[r]=e[r]}),!t)return!1;switch((i.type||"").toString().toUpperCase()){case"OAUTH2":{if(!i.service&&!i.user)return!1;let r=new gO(i,this.logger);return r.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||r.provisionCallback,r.on("token",s=>this.mailer.emit("token",s)),r.on("error",s=>this.emit("error",s)),{type:"OAUTH2",user:i.user,oauth2:r,method:"XOAUTH2"}}default:return{type:(i.type||"").toString().toUpperCase()||"LOGIN",user:i.user,credentials:{user:i.user||"",pass:i.pass,options:i.options},method:(i.method||"").trim().toUpperCase()||this.options.authMethod||!1}}}send(e,t){this.getSocket(this.options,(i,r)=>{if(i)return t(i);let s=!1,o=this.options;r&&r.connection&&(this.logger.info({tnx:"proxy",remoteAddress:r.connection.remoteAddress,remotePort:r.connection.remotePort,destHost:o.host||"",destPort:o.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",r.connection.remoteAddress,r.connection.remotePort,o.host||"",o.port||""),o=Gr.assign(!1,o),Object.keys(r).forEach(u=>{o[u]=r[u]}));let a=new hd(o);a.once("error",u=>{if(!s)return s=!0,a.close(),t(u)}),a.once("end",()=>{if(s)return;let u=setTimeout(()=>{if(s)return;s=!0;let h=new Error("Unexpected socket close");a&&a._socket&&a._socket.upgrading&&(h.code="ETLS"),t(h)},1e3);try{u.unref()}catch{}});let l=()=>{let u=e.message.getEnvelope(),h=e.message.messageId(),p=[].concat(u.to||[]);p.length>3&&p.push("...and "+p.splice(2).length+" more"),e.data.dsn&&(u.dsn=e.data.dsn),this.logger.info({tnx:"send",messageId:h},"Sending message %s to <%s>",h,p.join(", ")),a.send(u,e.message.createReadStream(),(f,v)=>{if(s=!0,a.close(),f)return this.logger.error({err:f,tnx:"send"},"Send error for %s: %s",h,f.message),t(f);v.envelope={from:u.from,to:u.to},v.messageId=h;try{return t(null,v)}catch(I){this.logger.error({err:I,tnx:"callback"},"Callback error for %s: %s",h,I.message)}})};a.connect(()=>{if(s)return;let u=this.getAuth(e.data.auth);u&&(a.allowsAuth||o.forceAuth)?a.login(u,h=>{if(u&&u!==this.auth&&u.oauth2&&u.oauth2.removeAllListeners(),!s){if(h)return s=!0,a.close(),t(h);l()}}):l()})})}verify(e){let t;return e||(t=new Promise((i,r)=>{e=Gr.callbackPromise(i,r)})),this.getSocket(this.options,(i,r)=>{if(i)return e(i);let s=this.options;r&&r.connection&&(this.logger.info({tnx:"proxy",remoteAddress:r.connection.remoteAddress,remotePort:r.connection.remotePort,destHost:s.host||"",destPort:s.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",r.connection.remoteAddress,r.connection.remotePort,s.host||"",s.port||""),s=Gr.assign(!1,s),Object.keys(r).forEach(u=>{s[u]=r[u]}));let o=new hd(s),a=!1;o.once("error",u=>{if(!a)return a=!0,o.close(),e(u)}),o.once("end",()=>{if(!a)return a=!0,e(new Error("Connection closed"))});let l=()=>{if(!a)return a=!0,o.quit(),e(null,!0)};o.connect(()=>{if(a)return;let u=this.getAuth({});if(u&&(o.allowsAuth||s.forceAuth))o.login(u,h=>{if(!a){if(h)return a=!0,o.close(),e(h);l()}});else if(!u&&o.allowsAuth&&s.forceAuth){let h=new Error("Authentication info was not provided");return h.code="NoAuth",a=!0,o.close(),e(h)}else l()})}),t}close(){this.auth&&this.auth.oauth2&&this.auth.oauth2.removeAllListeners(),this.emit("close")}};var _O=yO;const xO=Y.spawn,wO=xn,EO=Dt;let TO=class{constructor(e){e=e||{},this._spawn=xO,this.options=e||{},this.name="Sendmail",this.version=wO.version,this.path="sendmail",this.args=!1,this.winbreak=!1,this.logger=EO.getLogger(this.options,{component:this.options.component||"sendmail"}),e&&(typeof e=="string"?this.path=e:typeof e=="object"&&(e.path&&(this.path=e.path),Array.isArray(e.args)&&(this.args=e.args),this.winbreak=["win","windows","dos",`\r
`].includes((e.newline||"").toString().toLowerCase())))}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),r=e.message.messageId(),s,o,a;if([].concat(i.from||[]).concat(i.to||[]).some(h=>/^-/.test(h)))return t(new Error("Can not send mail. Invalid envelope addresses."));this.args?s=["-i"].concat(this.args).concat(i.to):s=["-i"].concat(i.from?["-f",i.from]:[]).concat(i.to);let u=h=>{if(!a&&(a=!0,typeof t=="function"))return h?t(h):t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:r,response:"Messages queued for delivery"})};try{o=this._spawn(this.path,s)}catch(h){return this.logger.error({err:h,tnx:"spawn",messageId:r},"Error occurred while spawning sendmail. %s",h.message),u(h)}if(o){o.on("error",f=>{this.logger.error({err:f,tnx:"spawn",messageId:r},"Error occurred when sending message %s. %s",r,f.message),u(f)}),o.once("exit",f=>{if(!f)return u();let v;f===127?v=new Error("Sendmail command not found, process exited with code "+f):v=new Error("Sendmail exited with code "+f),this.logger.error({err:v,tnx:"stdin",messageId:r},"Error sending message %s to sendmail. %s",r,v.message),u(v)}),o.once("close",u),o.stdin.on("error",f=>{this.logger.error({err:f,tnx:"stdin",messageId:r},"Error occurred when piping message %s to sendmail. %s",r,f.message),u(f)});let h=[].concat(i.to||[]);h.length>3&&h.push("...and "+h.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r},"Sending message %s to <%s>",r,h.join(", "));let p=e.message.createReadStream();p.once("error",f=>{this.logger.error({err:f,tnx:"stdin",messageId:r},"Error occurred when generating message %s. %s",r,f.message),o.kill("SIGINT"),u(f)}),p.pipe(o.stdin)}else return u(new Error("sendmail was not found"))}};var IO=TO;const SO=xn,AO=Dt;let bO=class{constructor(e){e=e||{},this.options=e||{},this.name="StreamTransport",this.version=SO.version,this.logger=AO.getLogger(this.options,{component:this.options.component||"stream-transport"}),this.winbreak=["win","windows","dos",`\r
`].includes((e.newline||"").toString().toLowerCase())}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),r=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r},"Sending message %s to <%s> using %s line breaks",r,s.join(", "),this.winbreak?"<CR><LF>":"<LF>"),setImmediate(()=>{let o;try{o=e.message.createReadStream()}catch(u){return this.logger.error({err:u,tnx:"send",messageId:r},"Creating send stream failed for %s. %s",r,u.message),t(u)}if(!this.options.buffer)return o.once("error",u=>{this.logger.error({err:u,tnx:"send",messageId:r},"Failed creating message for %s. %s",r,u.message)}),t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:r,message:o});let a=[],l=0;o.on("readable",()=>{let u;for(;(u=o.read())!==null;)a.push(u),l+=u.length}),o.once("error",u=>(this.logger.error({err:u,tnx:"send",messageId:r},"Failed creating message for %s. %s",r,u.message),t(u))),o.on("end",()=>t(null,{envelope:e.data.envelope||e.message.getEnvelope(),messageId:r,message:Buffer.concat(a,l)}))})}};var CO=bO;const kO=xn,PO=Dt;let RO=class{constructor(e){e=e||{},this.options=e||{},this.name="JSONTransport",this.version=kO.version,this.logger=PO.getLogger(this.options,{component:this.options.component||"json-transport"})}send(e,t){e.message.keepBcc=!0;let i=e.data.envelope||e.message.getEnvelope(),r=e.message.messageId(),s=[].concat(i.to||[]);s.length>3&&s.push("...and "+s.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:r},"Composing JSON structure of %s to <%s>",r,s.join(", ")),setImmediate(()=>{e.normalize((o,a)=>o?(this.logger.error({err:o,tnx:"send",messageId:r},"Failed building JSON structure for %s. %s",r,o.message),t(o)):(delete a.envelope,delete a.normalizedHeaders,t(null,{envelope:i,messageId:r,message:this.options.skipEncoding?a:JSON.stringify(a)})))})}};var DO=RO;const NO=Y,VO=xn,Z_=Dt,MO=MI;let OO=class extends NO{constructor(e){super(),e=e||{},this.options=e||{},this.ses=this.options.SES,this.name="SESTransport",this.version=VO.version,this.logger=Z_.getLogger(this.options,{component:this.options.component||"ses-transport"}),this.maxConnections=Number(this.options.maxConnections)||1/0,this.connections=0,this.sendingRate=Number(this.options.sendingRate)||1/0,this.sendingRateTTL=null,this.rateInterval=1e3,this.rateMessages=[],this.pending=[],this.idling=!0,setImmediate(()=>{this.idling&&this.emit("idle")})}send(e,t){if(this.connections>=this.maxConnections)return this.idling=!1,this.pending.push({mail:e,callback:t});if(!this._checkSendingRate())return this.idling=!1,this.pending.push({mail:e,callback:t});this._send(e,(...i)=>{setImmediate(()=>t(...i)),this._sent()})}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate())return;if(!this.pending.length){this.idling||(this.idling=!0,this.emit("idle"));return}let e=this.pending.shift();this._send(e.mail,(...t)=>{setImmediate(()=>e.callback(...t)),this._sent()})}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let e=Date.now(),t=!1;for(let r=this.rateMessages.length-1;r>=0;r--)this.rateMessages[r].ts>=e-this.rateInterval&&(!t||this.rateMessages[r].ts<t)&&(t=this.rateMessages[r].ts),this.rateMessages[r].ts<e-this.rateInterval&&!this.rateMessages[r].pending&&this.rateMessages.splice(r,1);if(this.rateMessages.length<this.sendingRate)return!0;let i=Math.max(t+1001,e+20);this.sendingRateTTL=setTimeout(()=>this._checkRatedQueue(),e-i);try{this.sendingRateTTL.unref()}catch{}return!1}_sent(){this.connections--,this._checkRatedQueue()}isIdle(){return this.idling}_send(e,t){let i={ts:Date.now(),pending:!0};this.connections++,this.rateMessages.push(i);let r=e.data.envelope||e.message.getEnvelope(),s=e.message.messageId(),o=[].concat(r.to||[]);o.length>3&&o.push("...and "+o.splice(2).length+" more"),this.logger.info({tnx:"send",messageId:s},"Sending message %s to <%s>",s,o.join(", "));let a=l=>{e.data._dkim||(e.data._dkim={}),e.data._dkim.skipFields&&typeof e.data._dkim.skipFields=="string"?e.data._dkim.skipFields+=":date:message-id":e.data._dkim.skipFields="date:message-id";let u=e.message.createReadStream(),h=u.pipe(new MO),p=[],f=0;h.on("readable",()=>{let v;for(;(v=h.read())!==null;)p.push(v),f+=v.length}),u.once("error",v=>h.emit("error",v)),h.once("error",v=>{l(v)}),h.once("end",()=>l(null,Buffer.concat(p,f)))};setImmediate(()=>a((l,u)=>{if(l)return this.logger.error({err:l,tnx:"send",messageId:s},"Failed creating message for %s. %s",s,l.message),i.pending=!1,t(l);let h={RawMessage:{Data:u},Source:r.from,Destinations:r.to};Object.keys(e.data.ses||{}).forEach(I=>{h[I]=e.data.ses[I]});let p=(this.ses.aws?this.ses.ses:this.ses)||{},f=this.ses.aws||{};(I=>p.config&&typeof p.config.region=="function"?p.config.region().then(b=>I(null,b)).catch(b=>I(b)):I(null,p.config&&p.config.region||"us-east-1"))((I,b)=>{(I||!b)&&(b="us-east-1");let T;typeof p.send=="function"&&f.SendRawEmailCommand?T=p.send(new f.SendRawEmailCommand(h)):T=p.sendRawEmail(h).promise(),T.then(y=>{b==="us-east-1"&&(b="email"),i.pending=!1,t(null,{envelope:{from:r.from,to:r.to},messageId:"<"+y.MessageId+(/@/.test(y.MessageId)?"":"@"+b+".amazonses.com")+">",response:y.MessageId,raw:u})}).catch(y=>{this.logger.error({err:y,tnx:"send"},"Send error for %s: %s",s,y.message),i.pending=!1,t(y)})})}))}verify(e){let t,i=(this.ses.aws?this.ses.ses:this.ses)||{},r=this.ses.aws||{};const s={RawMessage:{Data:`From: invalid@invalid\r
To: invalid@invalid\r
 Subject: Invalid\r
\r
Invalid`},Source:"invalid@invalid",Destinations:["invalid@invalid"]};e||(t=new Promise((a,l)=>{e=Z_.callbackPromise(a,l)}));const o=a=>a&&(a.code||a.Code)!=="InvalidParameterValue"?e(a):e(null,!0);return typeof i.send=="function"&&r.SendRawEmailCommand?(s.RawMessage.Data=Buffer.from(s.RawMessage.Data),i.send(new r.SendRawEmailCommand(s),o)):i.sendRawEmail(s,o),t}};var LO=OO,Xu={};const FO=YV,$I=Dt,jO=pO,BO=_O,UO=IO,zO=CO,$O=DO,qO=LO,HO=Qu,ex=xn,GO=(Xu.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,""),KO=(Xu.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,""),tx=(Xu.ETHEREAL_API_KEY||"").replace(/\s*/g,"")||null,QO=["true","yes","y","1"].includes((Xu.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());let Uo=!1;Ku.createTransport=function(n,e){let t,i,r;return(typeof n=="object"&&typeof n.send!="function"||typeof n=="string"&&/^(smtps?|direct):/i.test(n))&&((t=typeof n=="string"?n:n.url)?i=$I.parseConnectionUrl(t):i=n,i.pool?n=new jO(i):i.sendmail?n=new UO(i):i.streamTransport?n=new zO(i):i.jsonTransport?n=new $O(i):i.SES?n=new qO(i):n=new BO(i)),r=new FO(n,i,e),r};Ku.createTestAccount=function(n,e){let t;if(!e&&typeof n=="function"&&(e=n,n=!1),e||(t=new Promise((l,u)=>{e=$I.callbackPromise(l,u)})),QO&&Uo)return setImmediate(()=>e(null,Uo)),t;n=n||GO;let i=[],r=0,s={},o={requestor:ex.name,version:ex.version};tx&&(s.Authorization="Bearer "+tx);let a=HO(n+"/user",{contentType:"application/json",method:"POST",headers:s,body:Buffer.from(JSON.stringify(o))});return a.on("readable",()=>{let l;for(;(l=a.read())!==null;)i.push(l),r+=l.length}),a.once("error",l=>e(l)),a.once("end",()=>{let l=Buffer.concat(i,r),u,h;try{u=JSON.parse(l.toString())}catch(p){h=p}if(h)return e(h);if(u.status!=="success"||u.error)return e(new Error(u.error||"Request failed"));delete u.status,Uo=u,e(null,Uo)}),t};Ku.getTestMessageUrl=function(n){if(!n||!n.response)return!1;let e=new Map;return n.response.replace(/\[([^\]]+)\]$/,(t,i)=>{i.replace(/\b([A-Z0-9]+)=([^\s]+)/g,(r,s,o)=>{e.set(s,o)})}),e.has("STATUS")&&e.has("MSGID")?(Uo.web||KO)+"/message/"+e.get("MSGID"):!1};const WO=async(n,e,t)=>{try{await Ku.createTransport({host:"smtp-relay.brevo.com",port:587,secure:!1,auth:{user:"749973001@smtp-brevo.com",pass:"w8LfykvKxqUrGEn6"}}).sendMail({from:"admin@abuaslamtech.com",to:n,subject:e,text:t}),console.log("Email sent successfully")}catch(i){throw console.error("Error sending email:",i),i}},XO=["P-Site to Take-off","Take-off to Hostel","Hostel to Take-off","Hostel to P-Site"];function YO(){const[n,e]=$.useState(""),[t,i]=$.useState(""),[r,s]=$.useState(""),[o,a]=$.useState(""),[l,u]=$.useState(""),[h,p]=$.useState(""),[f,v]=$.useState(!1),I=Ff(),b=async g=>{try{const w="Car Booking Confirmation",k=`
Dear Student,

Your booking has been confirmed. Here are your booking details:

Ticket Number: ${g.ticketNumber}
Matriculation Number: ${g.matricNumber}
Boarding Slot: ${g.boardingSlot}
Destination: ${g.destination}
Car ID: ${g.carId}
Seat Number: ${g.seatNumber}
Booking Time: ${g.bookingTime.toLocaleString()}

Please keep this information for your records.

Thank you for using our service!
      `;await WO(g.email,w,k),console.log("Confirmation email sent successfully")}catch(w){console.error("Error sending confirmation email:",w)}},T=async g=>{g.preventDefault(),u("");try{const w=WN(),k=await KN(r),N={ticketNumber:w,matricNumber:n,email:t,boardingSlot:r,destination:o,carId:k.carId,seatNumber:k.seatNumber,bookingTime:new Date};await b(N),await ia.collection("bookings").doc(w).set(N),p(w),v(!0)}catch(w){console.error("Error booking car:",w),u("Failed to book car. Please try again.")}},y=()=>{I(`/dashboard/${h}`)};return f?F.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Booking Successful!"}),F.jsxs("p",{className:"mb-4",children:["Your ticket number is: ",F.jsx("strong",{children:h})]}),F.jsx("p",{className:"mb-4",children:"Please save this number as you'll need it to access your reservation details."}),F.jsxs("p",{className:"mb-4",children:["A confirmation email has been sent to ",t,"."]}),F.jsx("button",{onClick:y,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 mb-4",children:"View Reservation Details"}),F.jsx("button",{onClick:()=>I("/"),className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md transition duration-300",children:"Return to Home"})]}):F.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Book a Car"}),l&&F.jsx("p",{className:"text-red-500 mb-4",children:l}),F.jsxs("form",{onSubmit:T,className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx("label",{htmlFor:"matricNumber",className:"block font-medium mb-2",children:"Matriculation Number"}),F.jsx("input",{type:"text",id:"matricNumber",value:n,onChange:g=>e(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),F.jsxs("div",{children:[F.jsx("label",{htmlFor:"email",className:"block font-medium mb-2",children:"Email"}),F.jsx("input",{type:"email",id:"email",value:t,onChange:g=>i(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),F.jsxs("div",{children:[F.jsx("label",{htmlFor:"boardingSlot",className:"block font-medium mb-2",children:"Boarding Slot"}),F.jsxs("select",{id:"boardingSlot",value:r,onChange:g=>s(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[F.jsx("option",{value:"",children:"Select a boarding slot"}),GN.map(g=>F.jsx("option",{value:g.time,children:g.time},g.id))]})]}),F.jsxs("div",{children:[F.jsx("label",{htmlFor:"destination",className:"block font-medium mb-2",children:"Destination"}),F.jsxs("select",{id:"destination",value:o,onChange:g=>a(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[F.jsx("option",{value:"",children:"Select a destination"}),XO.map((g,w)=>F.jsx("option",{value:g,children:g},w))]})]}),F.jsx("button",{type:"submit",className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md transition duration-300",children:"Book Car"})]})]})}function JO(){var p,f;const{ticketNumber:n}=Sb(),[e,t]=$.useState(null),[i,r]=$.useState(""),[s,o]=$.useState(""),[a,l]=$.useState(0),[u,h]=$.useState({totalTrips:0,favoriteDestination:""});return $.useEffect(()=>{(async()=>{try{const I=await ia.collection("bookings").doc(n).get();if(I.exists){const b=I.data();t(b);const T=dc.find(M=>M.id===b.carId),y=await ia.collection("bookings").where("carId","==",b.carId).where("boardingSlot","==",b.boardingSlot).get();l(T.capacity-y.size);const g=await ia.collection("bookings").where("matricNumber","==",b.matricNumber).get(),w=g.size,k=g.docs.map(M=>M.data().destination),N=k.sort((M,E)=>k.filter(x=>x===M).length-k.filter(x=>x===E).length).pop();h({totalTrips:w,favoriteDestination:N})}else o("No booking found for this ticket number.")}catch(I){console.error("Error fetching booking:",I),o("Failed to fetch booking details.")}})()},[n]),$.useEffect(()=>{if(e){const v=setInterval(()=>{const I=QN(e.boardingSlot);r(I)},1e3);return()=>clearInterval(v)}},[e]),s?F.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("p",{className:"text-red-500 mb-4",children:s}),F.jsx(Uc,{to:"/",className:"text-blue-500 hover:underline",children:"Go back to homepage"})]}):e?F.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("h2",{className:"text-3xl font-bold mb-6 text-center",children:"Reservation Dashboard"}),F.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[F.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[F.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Booking Details"}),F.jsxs("p",{children:[F.jsx("strong",{children:"Ticket Number:"})," ",e.ticketNumber]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Matriculation Number:"})," ",e.matricNumber]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Boarding Slot:"})," ",e.boardingSlot]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Destination:"})," ",e.destination]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Car Number:"})," ",e.carId]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Seat Number:"})," ",e.seatNumber]})]}),F.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[F.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Departure Information"}),F.jsx("p",{children:F.jsx("strong",{children:"Time until departure:"})}),F.jsx("p",{className:"text-4xl font-bold text-blue-600",children:i}),F.jsxs("p",{className:"mt-4",children:[F.jsx("strong",{children:"Remaining seats in car:"})," ",a]})]}),F.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[F.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Car Information"}),F.jsxs("p",{children:[F.jsx("strong",{children:"Car Model:"})," ",((p=dc.find(v=>v.id===e.carId))==null?void 0:p.model)||"N/A"]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Car Capacity:"})," ",((f=dc.find(v=>v.id===e.carId))==null?void 0:f.capacity)||"N/A"]})]}),F.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[F.jsx("h3",{className:"text-xl font-semibold mb-4",children:"User Statistics"}),F.jsxs("p",{children:[F.jsx("strong",{children:"Total Trips:"})," ",u.totalTrips]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Favorite Destination:"})," ",u.favoriteDestination]})]})]}),F.jsx("div",{className:"mt-8 text-center",children:F.jsx(Uc,{to:"/",className:"text-blue-500 hover:underline",children:"Go back to homepage"})})]}):F.jsx("div",{className:"text-center",children:"Loading..."})}function ZO(){const[n,e]=$.useState(""),t=Ff(),i=r=>{r.preventDefault(),t(`/dashboard/${n}`)};return F.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[F.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Check Reservation"}),F.jsxs("form",{onSubmit:i,className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx("label",{htmlFor:"ticketNumber",className:"block font-medium mb-2",children:"Ticket Number"}),F.jsx("input",{type:"text",id:"ticketNumber",value:n,onChange:r=>e(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),F.jsx("button",{type:"submit",className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-300",children:"Check Reservation"})]})]})}function eL(){return F.jsx("header",{className:"bg-gray-800 text-white py-4",children:F.jsx("nav",{className:"container mx-auto flex justify-between items-center",children:F.jsx("div",{className:"font-bold text-xl",children:"Passenger Loading System"})})})}function tL(){return F.jsx("footer",{className:"bg-gray-800 text-white py-4",children:F.jsxs("div",{className:"container mx-auto text-center",children:[" ",new Date().getFullYear()," Federal University Dutsin-ma"]})})}function nL(){return F.jsx(Gb,{children:F.jsxs("div",{className:"flex flex-col min-h-screen",children:[F.jsx(eL,{}),F.jsx("main",{className:"flex-grow container mx-auto px-4 py-8",children:F.jsxs(jb,{children:[F.jsx(Oo,{path:"/",element:F.jsx(Xb,{})}),F.jsx(Oo,{path:"/book",element:F.jsx(YO,{})}),F.jsx(Oo,{path:"/dashboard/:ticketNumber",element:F.jsx(JO,{})}),F.jsx(Oo,{path:"/check-reservation",element:F.jsx(ZO,{})})]})}),F.jsx(tL,{})]})})}dd.createRoot(document.getElementById("root")).render(F.jsx(dx.StrictMode,{children:F.jsx(nL,{})}));
